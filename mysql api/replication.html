<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Chapter 16. Replication</title><link rel="stylesheet" href="mysql-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MySQL 6.0 Reference Manual"><link rel="up" href="index.html" title="MySQL 6.0 Reference Manual"><link rel="prev" href="mem-introduction.html" title="Chapter 15. MySQL Enterprise Monitor"><link rel="next" href="partitioning.html" title="Chapter 17. Partitioning"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 16. Replication</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mem-introduction.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="partitioning.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="replication"></a>Chapter 16. Replication</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="replication.html#replication-configuration">16.1. Replication Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="replication.html#replication-howto">16.1.1. How to Set Up Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-formats">16.1.2. Replication Formats</a></span></dt><dt><span class="section"><a href="replication.html#replication-options">16.1.3. Replication and Binary Logging Options and Variables</a></span></dt><dt><span class="section"><a href="replication.html#replication-administration">16.1.4. Common Replication Administration Tasks</a></span></dt></dl></dd><dt><span class="section"><a href="replication.html#replication-solutions">16.2. Replication Solutions</a></span></dt><dd><dl><dt><span class="section"><a href="replication.html#replication-solutions-backups">16.2.1. Using Replication for Backups</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-diffengines">16.2.2. Using Replication with Different Master and Slave Storage Engines</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-scaleout">16.2.3. Using Replication for Scale-Out</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-partitioning">16.2.4. Replicating Different Databases to Different Slaves</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-performance">16.2.5. Improving Replication Performance</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-switch">16.2.6. Switching Masters During Failover</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-multi-master-upgrade">16.2.7. Upgrading Multi-Master Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-ssl">16.2.8. Setting Up Replication Using SSL</a></span></dt><dt><span class="section"><a href="replication.html#replication-semisync">16.2.9. Semisynchronous Replication</a></span></dt></dl></dd><dt><span class="section"><a href="replication.html#replication-notes">16.3. Replication Notes and Tips</a></span></dt><dd><dl><dt><span class="section"><a href="replication.html#replication-features">16.3.1. Replication Features and Issues</a></span></dt><dt><span class="section"><a href="replication.html#replication-compatibility">16.3.2. Replication Compatibility Between MySQL Versions</a></span></dt><dt><span class="section"><a href="replication.html#replication-upgrade">16.3.3. Upgrading a Replication Setup</a></span></dt><dt><span class="section"><a href="replication.html#replication-faq">16.3.4. Replication FAQ</a></span></dt><dt><span class="section"><a href="replication.html#replication-problems">16.3.5. Troubleshooting Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-bugs">16.3.6. How to Report Replication Bugs or Problems</a></span></dt></dl></dd><dt><span class="section"><a href="replication.html#replication-implementation">16.4. Replication Implementation</a></span></dt><dd><dl><dt><span class="section"><a href="replication.html#replication-implementation-details">16.4.1. Replication Implementation Details</a></span></dt><dt><span class="section"><a href="replication.html#slave-logs">16.4.2. Replication Relay and Status Files</a></span></dt><dt><span class="section"><a href="replication.html#replication-rules">16.4.3. How Servers Evaluate Replication Rules</a></span></dt></dl></dd></dl></div><a class="indexterm" name="id3535363"></a><a class="indexterm" name="id3535372"></a><a class="indexterm" name="id3535385"></a><a class="indexterm" name="id3535397"></a><p>
    Replication enables data from one MySQL database server (called the
    master) to be replicated to one or more MySQL database servers
    (slaves). Replication is asynchronous by default - your replication
    slaves do not need to be connected permanently to receive updates
    from the master, which means that updates can occur over
    long-distance connections and even temporary solutions such as a
    dial-up service. Depending on the configuration, you can replicate
    all databases, selected databases, or even selected tables within a
    database.
  </p><p>
    The target uses for replication in MySQL include:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        Scale-out solutions - spreading the load among multiple slaves
        to improve performance. In this environment, all writes and
        updates must take place on the master server. Reads, however,
        may take place on one or more slaves. This model can improve the
        performance of writes (since the master is dedicated to
        updates), while dramatically increasing read speed across an
        increasing number of slaves.
      </p></li><li><p>
        Data security - because data is replicated to the slave, and the
        slave can pause the replication process, it is possible to run
        backup services on the slave without corrupting the
        corresponding master data.
      </p></li><li><p>
        Analytics - live data can be created on the master, while the
        analysis of the information can take place on the slave without
        affecting the performance of the master.
      </p></li><li><p>
        Long-distance data distribution - if a branch office would like
        to work with a copy of your main data, you can use replication
        to create a local copy of the data for their use without
        requiring permanent access to the master.
      </p></li></ul></div><p>
    Replication in MySQL features support for one-way, asynchronous
    replication, in which one server acts as the master, while one or
    more other servers act as slaves. This is in contrast to the
    <span class="emphasis"><em>synchronous</em></span> replication which is a
    characteristic of MySQL Cluster (see
    <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster.html" target="_top">MySQL Cluster NDB 6.X/7.X</a>). As of version 6.0.8,
    MySQL supports an interface to semisynchronous replication in
    addition to the built-in asynchronous replication. With
    semisynchronous replication, a commit performed on the master side
    blocks before returning to the session that performed the
    transaction until at least one slave acknowleges that it has
    received and logged the events for the transaction.
  </p><p>
    There are a number of solutions available for setting up replication
    between two servers, but the best method to use depends on the
    presence of data and the engine types you are using. For more
    information on the available options, see
    <a href="replication.html#replication-howto" title="16.1.1. How to Set Up Replication">Section 16.1.1, “How to Set Up Replication”</a>.
  </p><p>
    There are two core types of replication format, Statement Based
    Replication (SBR), which replicates entire SQL statements, and Row
    Based Replication (RBR), which replicates only the changed rows. You
    may also use a third variety, Mixed Based Replication (MBR), which
    is the default mode. For more information on the different
    replication formats, see <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
  </p><p>
    Replication is controlled through a number of different options and
    variables. These control the core operation of the replication,
    timeouts and the databases and filters that can be applied on
    databases and tables. For more information on the available options,
    see <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.
  </p><p>
    You can use replication to solve a number of different problems,
    including problems with performance, supporting the backup of
    different databases and for use as part of a larger solution to
    alleviate system failures. For information on how to address these
    issues, see <a href="replication.html#replication-solutions" title="16.2. Replication Solutions">Section 16.2, “Replication Solutions”</a>.
  </p><p>
    For notes and tips on how different data types and statements are
    treated during replication, including details of replication
    features, version compatibility, upgrades, and problems and their
    resolution, including an FAQ, see
    <a href="replication.html#replication-notes" title="16.3. Replication Notes and Tips">Section 16.3, “Replication Notes and Tips”</a>.
  </p><p>
    Detailed information on the implementation of replication, how
    replication works, the process and contents of the binary log,
    background threads and the rules used to decide how statements are
    recorded and replication, see
    <a href="replication.html#replication-implementation" title="16.4. Replication Implementation">Section 16.4, “Replication Implementation”</a>.
  </p><p class="mnmas"><b>MySQL Enterprise</b>
      The MySQL Enterprise Monitor provides numerous advisors that
      provide immediate feedback about replication-related problems. For
      more information, see
      <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="replication-configuration"></a>16.1. Replication Configuration</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-howto">16.1.1. How to Set Up Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-formats">16.1.2. Replication Formats</a></span></dt><dt><span class="section"><a href="replication.html#replication-options">16.1.3. Replication and Binary Logging Options and Variables</a></span></dt><dt><span class="section"><a href="replication.html#replication-administration">16.1.4. Common Replication Administration Tasks</a></span></dt></dl></div><p>
    Replication between servers in MySQL works through the use of the
    binary logging mechanism. The MySQL instance operating as the master
    (the source of the database changes) writes updates and changes as
    “<span class="quote">events</span>” to the binary log. The information in the
    binary log is stored in different logging formats according to the
    database changes being recorded. Slaves are configured to read the
    binary log from the master and to execute the events in the binary
    log on the slave's local database.
  </p><p>
    The master is “<span class="quote">dumb</span>” in this scenario. Once binary
    logging has been enabled, all statements are recorded in the binary
    log. Each slave will receive a copy of the entire contents of the
    binary log. It is the responsibility of the slave to decide which
    statements in the binary log should be executed; you cannot
    configure the master to log only certain events. If you do not
    specify otherwise, all events in the master binary log are executed
    on the slave. If required, you can configure the slave to process
    only events that apply to particular databases or tables.
  </p><p>
    Each slave keeps a record of the binary log file and position within
    the log file that it has read and processed from the master. This
    means that multiple slaves can be connected to the master and
    executing different parts of the same binary log. Because the slaves
    control this process, individual slaves can be connected and
    disconnected from the server without affecting the master's
    operation. Also, because each slave remembers the position within
    the binary log, it is possible for slaves to be disconnected,
    reconnect and then “<span class="quote">catch up</span>” by continuing from the
    recorded position.
  </p><p>
    Both the master and each slave must be configured with a unique ID
    (using the <code class="literal">server-id</code> option). In addition, the
    slave must be configured with information about the master host
    name, log file name and position within that file. These details can
    be controlled from within a MySQL session using the
    <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement. The
    details are stored within the <code class="filename">master.info</code> file.
  </p><p>
    In this section the setup and configuration required for a
    replication environment is described, including step-by-step
    instructions for creating a new replication environment. The major
    components of this section are:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        For a guide to setting up two or more servers for replication
        see <a href="replication.html#replication-howto" title="16.1.1. How to Set Up Replication">Section 16.1.1, “How to Set Up Replication”</a>. This section deals with
        the setup of the systems and provides methods for copying data
        between the master and slaves.
      </p></li><li><p>
        Events in the binary log are recorded using a number of formats.
        These are referred to as statement-based replication (SBR) or
        row-based replication (RBR). A third type, mixed-format
        replication (MIXED), uses SBR or RBR replication automatically
        to take advantage of the benefits of both SBR and RBR formats
        when appropriate. The different formats are discussed in
        <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
      </p></li><li><p>
        Detailed information on the different configuration options and
        variables that apply to replication is provided in
        <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.
      </p></li><li><p>
        Once started, the replication process should require little
        administration or monitoring. However, for advice on common
        tasks that you may want to execute, see
        <a href="replication.html#replication-administration" title="16.1.4. Common Replication Administration Tasks">Section 16.1.4, “Common Replication Administration Tasks”</a>.
      </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-howto"></a>16.1.1. How to Set Up Replication</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-howto-repuser">16.1.1.1. Creating a User for Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-masterbaseconfig">16.1.1.2. Setting the Replication Master Configuration</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-slavebaseconfig">16.1.1.3. Setting the Replication Slave Configuration</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-masterstatus">16.1.1.4. Obtaining the Master Replication Information</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-mysqldump">16.1.1.5. Creating a Data Snapshot Using <span><strong class="command">mysqldump</strong></span></a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-rawdata">16.1.1.6. Creating a Data Snapshot Using Raw Data Files</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-newservers">16.1.1.7. Setting Up Replication with New Master and Slaves</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-existingdata">16.1.1.8. Setting Up Replication with Existing Data</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-additionalslaves">16.1.1.9. Introducing Additional Slaves to an Existing Replication Environment</a></span></dt><dt><span class="section"><a href="replication.html#replication-howto-slaveinit">16.1.1.10. Setting the Master Configuration on the Slave</a></span></dt></dl></div><p>
      This section describes how to set up complete replication of a
      MySQL server. There are a number of different methods for setting
      up replication, and the exact method that you use will depend on
      how you are setting up replication, and whether you already have
      data within your master database.
    </p><p>
      There are some generic tasks which may be required for all
      replication setups:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          You may want to create a separate user that will be used by
          your slaves to authenticate with the master to read the binary
          log for replication. The step is optional. See
          <a href="replication.html#replication-howto-repuser" title="16.1.1.1. Creating a User for Replication">Section 16.1.1.1, “Creating a User for Replication”</a>.
        </p></li><li><p>
          You must configure the master to support the binary log and
          configure a unique ID. See
          <a href="replication.html#replication-howto-masterbaseconfig" title="16.1.1.2. Setting the Replication Master Configuration">Section 16.1.1.2, “Setting the Replication Master Configuration”</a>.
        </p></li><li><p>
          You must configure a unique ID for each slave that you want to
          connect to the master. See
          <a href="replication.html#replication-howto-slavebaseconfig" title="16.1.1.3. Setting the Replication Slave Configuration">Section 16.1.1.3, “Setting the Replication Slave Configuration”</a>.
        </p></li><li><p>
          Before starting a data snapshot or the replication process,
          you should record the position of the binary log on the
          master. You will need this information when configuring the
          slave so that the slave knows where within the binary log to
          start executing events. See
          <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>.
        </p></li><li><p>
          If you already have data on your master and you want to
          synchronize your slave with this base data, then you will need
          to create a data snapshot of your database. You can create a
          snapshot using <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> (see
          <a href="replication.html#replication-howto-mysqldump" title="16.1.1.5. Creating a Data Snapshot Using mysqldump">Section 16.1.1.5, “Creating a Data Snapshot Using <span><strong class="command">mysqldump</strong></span>”</a>) or by copying
          the data files directly (see
          <a href="replication.html#replication-howto-rawdata" title="16.1.1.6. Creating a Data Snapshot Using Raw Data Files">Section 16.1.1.6, “Creating a Data Snapshot Using Raw Data Files”</a>).
        </p></li><li><p>
          You will need to configure the slave with the master settings,
          such as the host name, login credentials and binary log name
          and positions. See
          <a href="replication.html#replication-howto-slaveinit" title="16.1.1.10. Setting the Master Configuration on the Slave">Section 16.1.1.10, “Setting the Master Configuration on the Slave”</a>.
        </p></li></ul></div><p>
      Once you have configured the basic options, you will need to
      follow the instructions for your replication setup. A number of
      alternatives are provided:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          If you are establishing a new MySQL master and one or more
          slaves, then you need only set up the configuration, as you
          have no data to exchange. For guidance on setting up
          replication in this situation, see
          <a href="replication.html#replication-howto-newservers" title="16.1.1.7. Setting Up Replication with New Master and Slaves">Section 16.1.1.7, “Setting Up Replication with New Master and Slaves”</a>.
        </p></li><li><p>
          If you are already running a MySQL server, and therefore
          already have data that will need to be transferred to your
          slaves before replication starts, have not previously
          configured the binary log and are able to shut down your MySQL
          server for a short period during the process, see
          <a href="replication.html#replication-howto-existingdata" title="16.1.1.8. Setting Up Replication with Existing Data">Section 16.1.1.8, “Setting Up Replication with Existing Data”</a>.
        </p></li><li><p>
          If you are setting up additional slaves to an existing
          replication environment then you can set up the slaves without
          affecting the master. See
          <a href="replication.html#replication-howto-additionalslaves" title="16.1.1.9. Introducing Additional Slaves to an Existing Replication Environment">Section 16.1.1.9, “Introducing Additional Slaves to an Existing Replication Environment”</a>.
        </p></li></ul></div><p>
      If you want to administer a MySQL replication setup, we suggest
      that you read this entire chapter through and try all statements
      mentioned in <a href="sql-syntax.html#replication-master-sql" title="12.6.1. SQL Statements for Controlling Master Servers">Section 12.6.1, “SQL Statements for Controlling Master Servers”</a>, and
      <a href="sql-syntax.html#replication-slave-sql" title="12.6.2. SQL Statements for Controlling Slave Servers">Section 12.6.2, “SQL Statements for Controlling Slave Servers”</a>. You should also
      familiarize yourself with the replication startup options
      described in <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Note that certain steps within the setup process require the
        <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege. If you do not
        have this privilege then enabling replication may not be
        possible.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-repuser"></a>16.1.1.1. Creating a User for Replication</h4></div></div></div><p>
        Each slave must connect to the master using a standard MySQL
        user name and password, so there must be a user account on the
        master that the slave can use to connect. Any account can be
        used for this operation, providing it has been granted the
        <a href="server-administration.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a> privilege.
      </p><p>
        You do not need to create a specific user for replication.
        However, you should be aware that the user name and password
        will be stored in plain text within the
        <code class="literal">master.info</code> file. Therefore, you may want to
        create a user that only has privileges for the replication
        process.
      </p><p>
        To create a user or grant an existing user the privileges
        required for replication, use the
        <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a> statement. If you create a
        user solely for the purposes of replication then that user needs
        only the <a href="server-administration.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a>
        privilege. For example, to create a user,
        <code class="literal">repl</code>, that can connect for replication from
        any host within the <code class="literal">mydomain.com</code> domain,
        issue this statement on the master:
      </p><pre class="programlisting">mysql&gt; GRANT REPLICATION SLAVE ON *.*
    -&gt; TO 'repl'@'%.mydomain.com' IDENTIFIED BY 'slavepass';</pre><p>
        See <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax">Section 12.5.1.3, “<code class="literal">GRANT</code> Syntax”</a>, for more information on the
        <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a> statement.
      </p><p>
        You may wish to create a different user for each slave, or use
        the same user for each slave that needs to connect. As long as
        each user that you want to use for the replication process has
        the <a href="server-administration.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a> privilege
        you can create as many users as you require.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-masterbaseconfig"></a>16.1.1.2. Setting the Replication Master Configuration</h4></div></div></div><p>
        For replication to work you <span class="emphasis"><em>must</em></span> enable
        binary logging on the master. If binary logging is not enabled,
        replication will not be possible as it is the binary log that is
        used to exchange data between the master and slaves.
      </p><p>
        Each server within a replication group must be configured with a
        unique <code class="literal">server-id</code> value. The server ID is used
        to identify individual servers within the group, and must be
        positive integer between 1 and
        (2<sup>32</sup>)–1. How you organize and
        select the numbers is entirely up to you.
      </p><p>
        To configure the binary log and server ID options, you will need
        to shut down your MySQL server and edit the configuration of the
        <code class="filename">my.cnf</code> or <code class="filename">my.ini</code> file.
      </p><p>
        You will need to add the following options to the configuration
        file within the <code class="literal">[mysqld]</code> section. If these
        options already exist, but are commented out, uncomment the
        options and alter them according to your needs. For example, to
        enable binary logging, using a log file name prefix of
        <code class="literal">mysql-bin</code>, and setting a server ID of 1:
      </p><pre class="programlisting">[mysqld]
log-bin=mysql-bin
server-id=1
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For the greatest possible durability and consistency in a
          replication setup using <code class="literal">InnoDB</code> with
          transactions, you should use
          <code class="literal">innodb_flush_log_at_trx_commit=1</code> and
          <code class="literal">sync_binlog=1</code> in the master
          <code class="filename">my.cnf</code> file.
        </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Ensure that the <code class="literal">skip-networking</code> option has
          not been enabled on your replication master. If networking has
          been disabled, then your slave will not able to communicate
          with the master and replication will fail.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-slavebaseconfig"></a>16.1.1.3. Setting the Replication Slave Configuration</h4></div></div></div><p>
        The only option you must configure on the slave is to set the
        unique server ID. If this option is not already set, or the
        current value conflicts with the value that you have chosen for
        the master server, then you should shut down your slave server,
        and edit the configuration to specify the server ID. For
        example:
      </p><pre class="programlisting">[mysqld]
server-id=2
</pre><p>
        If you are setting up multiple slaves, each one must have a
        unique <a href="replication.html#option_mysqld_server-id"><code class="option">server-id</code></a> value that
        differs from that of the master and from each of the other
        slaves. Think of <code class="literal">server-id</code> values as
        something similar to IP addresses: These IDs uniquely identify
        each server instance in the community of replication partners.
      </p><p>
        If you do not specify a <a href="replication.html#option_mysqld_server-id"><code class="option">server-id</code></a>
        value, it defaults to 0.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If you omit <a href="replication.html#option_mysqld_server-id"><code class="option">server-id</code></a> (or set
          it explicitly to 0), a master refuses connections from all
          slaves, and a slave refuses to connect to a master. Thus,
          omitting <a href="replication.html#option_mysqld_server-id"><code class="option">server-id</code></a> is good only
          for backup with a binary log.
        </p></div><p>
        You do not have to enable binary logging on the slave for
        replication to be enabled. However, if you enable binary logging
        on the slave then you can use the binary log for data backups
        and crash recovery on the slave, and also use the slave as part
        of a more complex replication topology (for example, where the
        slave acts as a master to other slaves).

      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-masterstatus"></a>16.1.1.4. Obtaining the Master Replication Information</h4></div></div></div><p>
        To configure replication on the slave you must determine the
        master's current point within the master binary log. You will
        need this information so that when the slave starts the
        replication process, it is able to start processing events from
        the binary log at the correct point.
      </p><p>
        If you have existing data on your master that you want to
        synchronize on your slaves before starting the replication
        process, then you must stop processing statements on the master,
        obtain the current position, and then dump the data, before
        allowing the master to continue executing statements. If you do
        not stop the execution of statements, the data dump and the
        master status information that you use will not match and you
        will end up with inconsistent or corrupted databases on the
        slaves.
      </p><p>
        To get the master status information, follow these steps:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Start the command-line client and flush all tables and block
            write statements by executing the
            <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> statement:
          </p><pre class="programlisting">mysql&gt; FLUSH TABLES WITH READ LOCK;</pre><p>
            For <code class="literal">InnoDB</code> tables, note that
            <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> also blocks
            <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">COMMIT</code></a> operations.
          </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
              Leave the client from which you issued the
              <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH
              TABLES</code></a> statement running so that the read lock
              remains in effect. If you exit the client, the lock is
              released.
            </p></div></li><li><p>
            Use the <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a>
            statement to determine the current binary log file name and
            offset on the master:
          </p><pre class="programlisting">mysql &gt; <strong class="userinput"><code>SHOW MASTER STATUS;</code></strong>
+---------------+----------+--------------+------------------+
| File          | Position | Binlog_Do_DB | Binlog_Ignore_DB |
+---------------+----------+--------------+------------------+
| mysql-bin.003 | 73       | test         | manual,mysql     |
+---------------+----------+--------------+------------------+
</pre><p>
            The <code class="literal">File</code> column shows the name of the log
            file and <code class="literal">Position</code> shows the offset within
            the file. In this example, the binary log file is
            <code class="literal">mysql-bin.003</code> and the offset is 73.
            Record these values. You need them later when you are
            setting up the slave. They represent the replication
            coordinates at which the slave should begin processing new
            updates from the master.
          </p><p>
            If the master has been running previously without binary
            logging enabled, the log name and position values displayed
            by <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a> or
            <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump --master-data</strong></span></a> will be empty. In
            that case, the values that you need to use later when
            specifying the slave's log file and position are the empty
            string (<code class="literal">''</code>) and <code class="literal">4</code>.
          </p></li></ol></div><p>
        You now have the information you need to enable the slave to
        start reading from the binary log in the correct place to start
        replication.
      </p><p>
        If you have existing data that needs be to synchronized with the
        slave before you start replication, leave the client running so
        that the lock remains in place and then proceed to
        <a href="replication.html#replication-howto-mysqldump" title="16.1.1.5. Creating a Data Snapshot Using mysqldump">Section 16.1.1.5, “Creating a Data Snapshot Using <span><strong class="command">mysqldump</strong></span>”</a>, or
        <a href="replication.html#replication-howto-rawdata" title="16.1.1.6. Creating a Data Snapshot Using Raw Data Files">Section 16.1.1.6, “Creating a Data Snapshot Using Raw Data Files”</a>.
      </p><p>
        If you are setting up a brand new master and slave replication
        group, then you can exit the client and release the locks.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-mysqldump"></a>16.1.1.5. Creating a Data Snapshot Using <span><strong class="command">mysqldump</strong></span></h4></div></div></div><p>
        One way to create a snapshot of the data in an existing master
        database is to use the <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> tool. Once
        the data dump has been completed, you then import this data into
        the slave before starting the replication process.
      </p><p>
        To obtain a snapshot of the data using
        <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            If you haven't already locked the tables on the server to
            prevent statements that update data from executing:
          </p><p>
            Start the command-line client and flush all tables and block
            write statements by executing the
            <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> statement:
          </p><pre class="programlisting">mysql&gt; FLUSH TABLES WITH READ LOCK;</pre><p>
            Remember to use <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER
            STATUS</code></a> and record the binary log details for use
            when starting up the slave. The point in time of your
            snapshot and the binary log position must match. See
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>.
          </p></li><li><p>
            In another session, use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to
            create a dump either of all the databases you want to
            replicate, or of selected individual databases. For example:
          </p><pre class="programlisting">shell&gt; mysqldump --all-databases --lock-all-tables &gt;dbdump.db</pre></li><li><p>
            An alternative to using a bare dump, is to use the
            <code class="literal">--master-data</code> option, which automatically
            appends the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement required on the slave to start the replication
            process.
          </p><pre class="programlisting">shell&gt; mysqldump --all-databases --master-data &gt;dbdump.db</pre></li><li><p>
            In the client where you acquired the read lock, release the
            lock:
          </p><pre class="programlisting">mysql&gt; UNLOCK TABLES;
</pre></li></ul></div><p>
        When choosing databases to include in the dump, remember that
        you will need to filter out databases on each slave that you do
        not want to include in the replication process.
      </p><p>
        You will need either to copy the dump file to the slave, or to
        use the file from the master when connecting remotely to the
        slave to import the data.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-rawdata"></a>16.1.1.6. Creating a Data Snapshot Using Raw Data Files</h4></div></div></div><p>
        If your database is particularly large, copying the raw data
        files may be more efficient than using
        <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> and importing the file on each
        slave.
      </p><p>
        However, using this method with tables in storage engines with
        complex caching or logging algorithms may not give you a perfect
        “<span class="quote">in time</span>” snapshot as cache information and logging
        updates may not have been applied, even if you have acquired a
        global read lock. How the storage engine responds to this
        depends on its crash recovery abilities.
      </p><p>
        In addition, this method does not work reliably if the master
        and slave have different values for
        <a href="server-administration.html#sysvar_ft_stopword_file"><code class="literal">ft_stopword_file</code></a>,
        <a href="server-administration.html#sysvar_ft_min_word_len"><code class="literal">ft_min_word_len</code></a>, or
        <a href="server-administration.html#sysvar_ft_max_word_len"><code class="literal">ft_max_word_len</code></a> and you are
        copying tables having fulltext indexes.
      </p><p>
        If you are using <code class="literal">InnoDB</code> tables, you should
        use the <span><strong class="command"><code class="literal">InnoDB</code> Hot Backup</strong></span>
        tool to obtain a consistent snapshot. This tool records the log
        name and offset corresponding to the snapshot to be later used
        on the slave. <span><strong class="command">Hot Backup</strong></span> is a non-free
        (commercial) tool that is not included in the standard MySQL
        distribution. See the <span><strong class="command"><code class="literal">InnoDB</code> Hot
        Backup</strong></span> home page at
        <a href="http://www.innodb.com/hot-backup" target="_top">http://www.innodb.com/hot-backup</a> for detailed
        information.
      </p><p>
        Otherwise, you can obtain a reliable binary snapshot of
        <code class="literal">InnoDB</code> tables only after shutting down the
        MySQL Server.
      </p><p>
        To create a raw data snapshot of <code class="literal">MyISAM</code>
        tables you can use standard copy tools such as
        <span><strong class="command">cp</strong></span> or <span><strong class="command">copy</strong></span>, a remote copy
        tool such as <span><strong class="command">scp</strong></span> or <span><strong class="command">rsync</strong></span>,
        an archiving tool such as <span><strong class="command">zip</strong></span> or
        <span><strong class="command">tar</strong></span>, or a file system snapshot tool such as
        <span><strong class="command">dump</strong></span>, providing that your MySQL data files
        exist on a single file system. If you are replicating only
        certain databases then make sure you copy only those files that
        related to those tables. (For <code class="literal">InnoDB</code>, all
        tables in all databases are stored in a single file unless you
        have the <code class="option">innodb_file_per_table</code> option enabled.)
      </p><p>
        You may want to specifically exclude the following files from
        your archive:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Files relating to the <code class="literal">mysql</code> database.
          </p></li><li><p>
            The <code class="filename">master.info</code> file.
          </p></li><li><p>
            The master's binary log files.
          </p></li><li><p>
            Any relay log files.
          </p></li></ul></div><p>
        To get the most consistent results with a raw data snapshot you
        should shut down the server during the process, as below:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Acquire a read lock and get the master's status. See
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>.
          </p></li><li><p>
            In a separate session, shut down the MySQL server:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqladmin shutdown</code></strong>
</pre></li><li><p>
            Make a copy of the MySQL data files. Examples are shown
            below for common ways to do this - you need to choose only
            one of them:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>tar cf <em class="replaceable"><code>/tmp/db.tar</code></em> <em class="replaceable"><code>./data</code></em></code></strong>
shell&gt; <strong class="userinput"><code>zip -r <em class="replaceable"><code>/tmp/db.zip</code></em> <em class="replaceable"><code>./data</code></em></code></strong>
shell&gt; <strong class="userinput"><code>rsync --recursive <em class="replaceable"><code>./data</code></em> <em class="replaceable"><code>/tmp/dbdata</code></em></code></strong>
</pre></li><li><p>
            Start up the MySQL instance on the master.
          </p></li></ol></div><p>
        If you are not using <code class="literal">InnoDB</code> tables, you can
        get a snapshot of the system from a master without shutting down
        the server as described in the following steps:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Acquire a read lock and get the master's status. See
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>.
          </p></li><li><p>
            Take a copy of the MySQL data files. Examples are shown
            below for common solutions - you need to choose only one of
            these solutions:
          </p><pre class="programlisting">shell&gt; tar cf <em class="replaceable"><code>/tmp/db.tar</code></em> <em class="replaceable"><code>./data</code></em>
shell&gt; zip -r <em class="replaceable"><code>/tmp/db.zip</code></em> <em class="replaceable"><code>./data</code></em>
shell&gt; rsync --recursive <em class="replaceable"><code>./data</code></em> <em class="replaceable"><code>/tmp/dbdata</code></em>
</pre></li><li><p>
            In the client where you acquired the read lock, release the
            lock:
          </p><pre class="programlisting">mysql&gt; UNLOCK TABLES;
</pre></li></ol></div><p>
        Once you have created the archive or copy of the database, you
        will need to copy the files to each slave before starting the
        slave replication process.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-newservers"></a>16.1.1.7. Setting Up Replication with New Master and Slaves</h4></div></div></div><p>
        Setting up replication with a new master and slaves (that is,
        with no existing data) is the easiest and most straightforward
        method for setting up replication.
      </p><p>
        You can also use this method if you are setting up new servers
        but have an existing dump of the databases from a different
        server that you want to load into your replication
        configuration. By loading the data into a new master, the data
        will be automatically replicated to the slaves.
      </p><p>
        To set up replication between a new master and slave:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Configure the MySQL master with the necessary configuration
            properties. See
            <a href="replication.html#replication-howto-masterbaseconfig" title="16.1.1.2. Setting the Replication Master Configuration">Section 16.1.1.2, “Setting the Replication Master Configuration”</a>.
          </p></li><li><p>
            Start up the MySQL master.
          </p></li><li><p>
            Set up a user. See
            <a href="replication.html#replication-howto-repuser" title="16.1.1.1. Creating a User for Replication">Section 16.1.1.1, “Creating a User for Replication”</a>.
          </p></li><li><p>
            Obtain the master status information. See
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>.
          </p></li><li><p>
            On the master, release the read lock:
          </p><pre class="programlisting">mysql&gt; UNLOCK TABLES;</pre></li><li><p>
            On the slave, edit the MySQL configuration. See
            <a href="replication.html#replication-howto-slavebaseconfig" title="16.1.1.3. Setting the Replication Slave Configuration">Section 16.1.1.3, “Setting the Replication Slave Configuration”</a>.
          </p></li><li><p>
            Start up the MySQL slave.
          </p></li><li><p>
            Execute the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement to set the master replication server
            configuration.
          </p></li></ol></div><p>
        Perform the slave setup steps on each slave.
      </p><p>
        Because there is no data to load or exchange on a new server
        configuration you do not need to copy or import any information.
      </p><p>
        If you are setting up a new replication environment using the
        data from a different existing database server, you will now
        need to run the dump file generated from that server on the new
        master. The database updates will automatically be propagated to
        the slaves:
      </p><pre class="programlisting">shell&gt; mysql -h master &lt; fulldb.dump</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-existingdata"></a>16.1.1.8. Setting Up Replication with Existing Data</h4></div></div></div><p>
        When setting up replication with existing data, you will need to
        decide how best to get the data from the master to the slave
        before starting the replication service.
      </p><p>
        The basic process for setting up replication with existing data
        is as follows:
      </p><div class="orderedlist"><ol type="1"><li><p>
            If you have not already configured the
            <code class="option">server-id</code> and binary logging, you will need
            to shut down your master to configure these options. See
            <a href="replication.html#replication-howto-masterbaseconfig" title="16.1.1.2. Setting the Replication Master Configuration">Section 16.1.1.2, “Setting the Replication Master Configuration”</a>.
          </p><p>
            If you have to shut down your master server, this is a good
            opportunity to take a snapshot of its databases. You should
            obtain the master status (see
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>) before
            taking down the master, updating the configuration and
            taking a snapshot. For information on how to create a
            snapshot using raw data files, see
            <a href="replication.html#replication-howto-rawdata" title="16.1.1.6. Creating a Data Snapshot Using Raw Data Files">Section 16.1.1.6, “Creating a Data Snapshot Using Raw Data Files”</a>.
          </p></li><li><p>
            If your server is already correctly configured, obtain the
            master status (see
            <a href="replication.html#replication-howto-masterstatus" title="16.1.1.4. Obtaining the Master Replication Information">Section 16.1.1.4, “Obtaining the Master Replication Information”</a>) and then
            use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to take a snapshot (see
            <a href="replication.html#replication-howto-mysqldump" title="16.1.1.5. Creating a Data Snapshot Using mysqldump">Section 16.1.1.5, “Creating a Data Snapshot Using <span><strong class="command">mysqldump</strong></span>”</a>) or take a raw
            snapshot of the live server using the guide in
            <a href="replication.html#replication-howto-rawdata" title="16.1.1.6. Creating a Data Snapshot Using Raw Data Files">Section 16.1.1.6, “Creating a Data Snapshot Using Raw Data Files”</a>.
          </p></li><li><p>
            With the MySQL master running, create a user to be used by
            the slave when connecting to the master during replication.
            See <a href="replication.html#replication-howto-repuser" title="16.1.1.1. Creating a User for Replication">Section 16.1.1.1, “Creating a User for Replication”</a>.
          </p></li><li><p>
            Update the configuration of the slave. See
            <a href="replication.html#replication-howto-slavebaseconfig" title="16.1.1.3. Setting the Replication Slave Configuration">Section 16.1.1.3, “Setting the Replication Slave Configuration”</a>.
          </p></li><li><p>
            The next step depends on how you created the snapshot of
            data on the master.
          </p><p>
            If you used <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>:
          </p><div class="orderedlist"><ol type="a"><li><p>
                Start the slave, skipping replication by using the
                <code class="literal">--skip-slave</code> option.
              </p></li><li><p>
                Import the dump file:
              </p><pre class="programlisting">shell&gt; mysql &lt; fulldb.dump</pre></li></ol></div><p>
            If you created a snapshot using the raw data files:
          </p><div class="orderedlist"><ol type="a"><li><p>
                Extract the data files into your slave data directory.
                For example:
              </p><pre class="programlisting">shell&gt; tar xvf dbdump.tar</pre><p>
                You may need to set permissions and ownership on the
                files to match the configuration of your slave.
              </p></li><li><p>
                Start the slave, skipping replication by using the
                <code class="literal">--skip-slave</code> option.
              </p></li></ol></div></li><li><p>
            Configure the slave with the master status information. This
            will tell the slave the binary log file and position within
            the file where replication needs to start, and configure the
            login credentials and host name of the master. For more
            information on the statement required, see
            <a href="replication.html#replication-howto-slaveinit" title="16.1.1.10. Setting the Master Configuration on the Slave">Section 16.1.1.10, “Setting the Master Configuration on the Slave”</a>.
          </p></li><li><p>
            Start the slave threads:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre></li></ol></div><p>
        After you have performed this procedure, the slave should
        connect to the master and catch up on any updates that have
        occurred since the snapshot was taken.
      </p><p>
        If you have forgotten to set the <code class="literal">server-id</code>
        option for the master, slaves cannot connect to it.
      </p><p>
        If you have forgotten to set the <code class="literal">server-id</code>
        option for the slave, you get the following error in the slave's
        error log:
      </p><pre class="programlisting">Warning: You should set server-id to a non-0 value if master_host
is set; we will force server id to 2, but this MySQL server will
not act as a slave.
</pre><p>
        You also find error messages in the slave's error log if it is
        not able to replicate for any other reason.
      </p><p>
        Once a slave is replicating, you can find in its data directory
        one file named <code class="filename">master.info</code> and another
        named <code class="filename">relay-log.info</code>. The slave uses these
        two files to keep track of how much of the master's binary log
        it has processed. Do <span class="emphasis"><em>not</em></span> remove or edit
        these files unless you know exactly what you are doing and fully
        understand the implications. Even in that case, it is preferred
        that you use the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
        statement to change replication parameters. The slave will use
        the values specified in the statement to update the status files
        automatically.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The content of <code class="filename">master.info</code> overrides some
          of the server options specified on the command line or in
          <code class="filename">my.cnf</code>. See
          <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>, for more details.
        </p></div><p>
        Once you have a snapshot of the master, you can use it to set up
        other slaves by following the slave portion of the procedure
        just described. You do not need to take another snapshot of the
        master; you can use the same one for each slave.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-additionalslaves"></a>16.1.1.9. Introducing Additional Slaves to an Existing Replication Environment</h4></div></div></div><p>
        If you want to add another slave to the existing replication
        configuration then you can do so without stopping the master.
        Instead, you duplicate the settings on the slaves by making a
        copy of one of the slaves.
      </p><p>
        To duplicate the slave:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Shut down the existing slave:
          </p><pre class="programlisting">shell&gt; mysqladmin shutdown</pre></li><li><p>
            Copy the data directory from the existing slave to the new
            slave. You can do this by creating an archive using
            <span><strong class="command">tar</strong></span> or <code class="literal">WinZip</code>, or by
            performing a direct copy using a tool such as
            <span><strong class="command">cp</strong></span> or <span><strong class="command">rsync</strong></span>. Ensure
            that you also copy the log files and relay log files.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              A common problem that is encountered when adding new
              replication slaves is that the new slave fails with a
              series of warning and error messages like these:

</p><pre class="programlisting">071118 16:44:10 [Warning] Neither --relay-log nor --relay-log-index were used; so
replication may break when this MySQL server acts as a slave and has his hostname
changed!! Please use '--relay-log=<em class="replaceable"><code>new_slave_hostname</code></em>-relay-bin' to avoid this problem.
<span class="errortext">071118 16:44:10 [ERROR] Failed to open the relay log './<em class="replaceable"><code>old_slave_hostname</code></em>-relay-bin.003525'
(relay_log_pos 22940879)</span>
071118 16:44:10 <span class="errortext">[ERROR] Could not find target log during relay log initialization</span>
071118 16:44:10 <span class="errortext">[ERROR] Failed to initialize the master info structure</span>
</pre><p>

              This is due to the fact that, if the
              <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> option is not
              specified, the relay log files contain the host name as
              part of their file names. (This is also true of the relay
              log index file if the
              <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index</code></a> option is
              not used. See <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>, for
              more information about these options.)
            </p><p>
              To avoid this problem, use the same value for
              <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> on the new
              slave that was used on the existing slave. (If this option
              was not set explicitly on the existing slave, use
              <code class="literal"><em class="replaceable"><code>existing_slave_hostname</code></em>-relay-bin</code>.)
              If this is not feasible, then copy the existing
              slave's relay log index file to the new slave and set
              the <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index</code></a>
              option on the new slave to match what was used on the
              existing slave. (If this option was not set explicitly on
              the existing slave, use
              <code class="literal"><em class="replaceable"><code>existing_slave_hostname</code></em>-relay-bin.index</code>.)
              Alternatively — if you have already tried to start
              the new slave (after following the remaining steps in this
              section) and have encountered errors like those described
              previously — then perform the following steps:

              </p><div class="orderedlist"><ol type="a"><li><p>
                    If you have not already done so, issue a
                    <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> on the new
                    slave.
                  </p><p>
                    If you have already started the existing slave
                    again, issue a <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP
                    SLAVE</code></a> on the existing slave as well.
                  </p></li><li><p>
                    Copy the contents of the existing slave's relay
                    log index file into the new slave's relay log
                    index file, making sure to overwrite any content
                    already in the file.
                  </p></li><li><p>
                    Proceed with the remaining steps in this section.
                  </p></li></ol></div><p>
            </p></div></li><li><p>
            Copy the <code class="filename">master.info</code> and
            <code class="filename">relay-log.info</code> files from the existing
            slave to the new slave. These files hold the current log
            positions.
          </p></li><li><p>
            Start the existing slave.
          </p></li><li><p>
            On the new slave, edit the configuration and the give the
            new slave a new unique <code class="literal">server-id</code>.
          </p></li><li><p>
            Start the new slave; the <code class="filename">master.info</code>
            file options will be used to start the replication process.
          </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-howto-slaveinit"></a>16.1.1.10. Setting the Master Configuration on the Slave</h4></div></div></div><p>
        To set up the slave to communicate with the master for
        replication, you must tell the slave the necessary connection
        information. To do this, execute the following statement on the
        slave, replacing the option values with the actual values
        relevant to your system:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
    -&gt;     <strong class="userinput"><code>MASTER_HOST='<em class="replaceable"><code>master_host_name</code></em>',</code></strong>
    -&gt;     <strong class="userinput"><code>MASTER_USER='<em class="replaceable"><code>replication_user_name</code></em>',</code></strong>
    -&gt;     <strong class="userinput"><code>MASTER_PASSWORD='<em class="replaceable"><code>replication_password</code></em>',</code></strong>
    -&gt;     <strong class="userinput"><code>MASTER_LOG_FILE='<em class="replaceable"><code>recorded_log_file_name</code></em>',</code></strong>
    -&gt;     <strong class="userinput"><code>MASTER_LOG_POS=<em class="replaceable"><code>recorded_log_position</code></em>;</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Replication cannot use Unix socket files. You must be able to
          connect to the master MySQL server using TCP/IP.
        </p></div><p>
        The following table shows the maximum allowable length for the
        string-valued options.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Option</strong></span></td><td><span class="bold"><strong>Maximum Length</strong></span></td></tr><tr><td><code class="literal">MASTER_HOST</code></td><td>60</td></tr><tr><td><code class="literal">MASTER_USER</code></td><td>16</td></tr><tr><td><code class="literal">MASTER_PASSWORD</code></td><td>32</td></tr><tr><td><code class="literal">MASTER_LOG_FILE</code></td><td>255</td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-formats"></a>16.1.2. Replication Formats</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-sbr-rbr">16.1.2.1. Comparison of Statement-Based and Row-Based Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-rbr-usage">16.1.2.2. Usage of Row-based Logging and Row-Based Replication</a></span></dt></dl></div><p>
      Replication works because events written to the binary log are
      read from the master and then processed on the slave. The events
      are recorded within the binary log in different formats according
      the type of event being recorded. The different replication
      formats used correspond to the binary logging format used when the
      events were recorded in the master's binary log. The correlation
      between binary logging formats and the terms used during
      replication are:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Replication capabilities in MySQL originally were based on
          propagation of SQL statements from master to slave. This is
          called <em class="firstterm">statement-based replication</em>
          (often abbreviated as <em class="firstterm">SBR</em>), which
          corresponds to the standard statement-based binary logging
          format. In older versions of MySQL (5.1.4 and earlier), binary
          logging and replication used this format exclusively.
        </p></li><li><p>
          Row-based binary logging logs changes in individual table
          rows. When used with MySQL replication, this is known as
          <em class="firstterm">row-based replication</em> (often
          abbreviated as <em class="firstterm">RBR</em>). In row-based
          replication, the master writes messages known as
          <em class="firstterm">events</em> to the binary log that indicate
          how individual table rows are changed.
        </p></li><li><p>
          The binary logging format can be changed in real time
          according to the event being logged using
          <em class="firstterm">mixed-format logging</em>.
        </p><p>
          When the mixed format is in effect, statement-based logging is
          used by default, but automatically switches to row-based
          logging in particular cases as described below. Replication
          using the mixed format is often referred to as
          <em class="firstterm">mixed-based replication</em> or
          <em class="firstterm">mixed-format replication</em>. For more
          information, see <a href="server-administration.html#binary-log-mixed" title="5.2.4.3. Mixed Binary Logging Format">Section 5.2.4.3, “Mixed Binary Logging Format”</a>.
        </p></li></ul></div><p>
      The mixed format is the default for MySQL replication.
    </p><p>
      The binary logging format is determined in part by the storage
      engine being used and the statement being executed. For more
      information on mixed-format logging and the rules governing the
      support of different logging formats, see
      <a href="server-administration.html#binary-log-mixed" title="5.2.4.3. Mixed Binary Logging Format">Section 5.2.4.3, “Mixed Binary Logging Format”</a>.
    </p><p>
      You must have the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege
      to set the binary logging format on the global level. Starting
      with MySQL 6.0.8, you must also have the
      <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege to set the binary
      logging format for the current session. (<a href="http://bugs.mysql.com/39106" target="_top">Bug#39106</a>)
    </p><p>
      The logging format in a running MySQL server is controlled by
      setting the <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> server
      system variable. This variable can be set with session or global
      scope. The rules governing when and how the new setting takes
      effect are the same as for other MySQL server system variables
      — setting the variable for the current session lasts only
      until the end of that session, and the change is not visible to
      other sessions; setting the variable globally requires a restart
      of the server in order to take effect. For more information, see
      <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax">Section 12.5.5, “<code class="literal">SET</code> Syntax”</a>.
    </p><p>
      The statement-based and row-based replication formats have
      different issues and limitations. For a comparison of their
      relative advantages and disadvantages, see
      <a href="replication.html#replication-sbr-rbr" title="16.1.2.1. Comparison of Statement-Based and Row-Based Replication">Section 16.1.2.1, “Comparison of Statement-Based and Row-Based Replication”</a>.
    </p><p>
      With statement-based replication, you may encounter issues with
      replicating stored routines or triggers. You can avoid these
      issues by using row-based replication instead. For more
      information, see <a href="stored-programs-views.html#stored-programs-logging" title="18.6. Binary Logging of Stored Programs">Section 18.6, “Binary Logging of Stored Programs”</a>.
    </p><p>
      If you build MySQL from source, row-based replication is available
      by default unless you invoke <span><strong class="command">configure</strong></span> with the
      <code class="option">--without-row-based-replication</code> option.
    </p><p>
      For MySQL 5.1.20 and later (and MySQL 5.0.46 for backward
      compatibility), the following session variables are written to the
      binary log and honored by the replication slave when parsing the
      binary log:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <a href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_unique_checks"><code class="literal">unique_checks</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_collation_database"><code class="literal">collation_database</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_collation_server"><code class="literal">collation_server</code></a>
        </p></li><li><p>
          <a href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null</code></a>
        </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Even though session variables relating to character sets and
        collations are written to the binary log, replication between
        different character sets is not supported.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-sbr-rbr"></a>16.1.2.1. Comparison of Statement-Based and Row-Based Replication</h4></div></div></div><a class="indexterm" name="id3538586"></a><a class="indexterm" name="id3538599"></a><p>
        Each binary logging format has advantages and disadvantages. For
        most users, the mixed replication format should provide the best
        combination of data integrity and performance. If, however, you
        want to take advantage of the features specific to the
        statement-based or row-based replication format when performing
        certain tasks, then you can use the information in this section,
        which provides a summary of their relative advantages and
        disadvantages, to determine which is best for your needs.
      </p><p>
        <span class="bold"><strong>Advantages of statement-based
        replication:</strong></span>
      </p><a class="indexterm" name="id3538634"></a><div class="itemizedlist"><ul type="disc"><li><p>
            Proven technology that has existed in MySQL since 3.23.
          </p></li><li><p>
            Less data written to log files. When updates or deletes
            affect many rows, this results in <span class="emphasis"><em>much</em></span>
            less storage space required for log files. This also means
            that taking and restoring from backups can be accomplished
            more quickly.
          </p></li><li><p>
            Log files contain all statements that made any changes, so
            they can be used to audit the database.
          </p></li><li><p>
            Tables replicated using statement-based replication are not
            required to have explicit primary keys.
          </p></li></ul></div><p>
        <span class="bold"><strong>Disadvantages of statement-based
        replication:</strong></span>
      </p><a class="indexterm" name="id3538700"></a><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id3538717"></a><a class="indexterm" name="id3538730"></a><p><b>Statements which are unsafe for SBR. </b>
              Not all statements which modify data (such as
              <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a>
              <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a>,
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
              <code class="literal">REPLACE</code> statements) can be
              replicated using statement-based replication. Any
              non-deterministic behavior is difficult to replicate when
              using statement-based replication. Examples of such DML
              (Data Modification Language) statements include the
              following:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                A statement that depends on a UDF or stored program that
                is non-deterministic, since the value returned by such a
                UDF or stored program or depends on factors other than
                the parameters supplied to it. (Row-based replication,
                however, simply replicates the value returned by the UDF
                or stored program, so its effect on table rows and data
                is the same on both the master and slave.) See
                <a href="replication.html#replication-features-invoked" title="16.3.1.7. Replication of Invoked Features">Section 16.3.1.7, “Replication of Invoked Features”</a>, for more
                information.
              </p></li><li><p>
                <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> and
                <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements that
                use a <code class="literal">LIMIT</code> clause without an
                <code class="literal">ORDER BY</code> are also non-deterministic.
                See <a href="replication.html#replication-features-limit" title="16.3.1.11. Replication and LIMIT">Section 16.3.1.11, “Replication and <code class="literal">LIMIT</code>”</a>.
              </p></li><li><p>
                Statements using any of the following functions cannot
                be replicated properly using statement-based
                replication:
              </p><div class="itemizedlist"><ul type="square"><li><p>
                    <a href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a>
                  </p></li><li><p>
                    <a href="functions.html#function_uuid"><code class="literal">UUID()</code></a>,
                    <a href="functions.html#function_uuid-short"><code class="literal">UUID_SHORT()</code></a>
                  </p></li><li><p>
                    <a href="functions.html#function_user"><code class="literal">USER()</code></a>
                  </p></li><li><p>
                    <a href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a>
                  </p></li><li><p>
                    <a href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> (unless the
                    server is started with the
                    <a href="server-administration.html#option_mysqld_sysdate-is-now"><code class="option">--sysdate-is-now</code></a>
                    option)
                  </p></li></ul></div><p>
                However, all other functions are replicated correctly
                using statement-based replication, including
                <a href="functions.html#function_rand"><code class="literal">RAND()</code></a>,
                <a href="functions.html#function_now"><code class="literal">NOW()</code></a>,
                <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
                INFILE</code></a>, and so forth.
              </p><p>
                For more information, see
                <a href="replication.html#replication-features-functions" title="16.3.1.10. Replication and System Functions">Section 16.3.1.10, “Replication and System Functions”</a>.
              </p></li></ul></div><p>
            When using statement-based replication, statements that
            cannot be replicated correctly using statement-based mode
            are logged with a warning like the one shown here:
          </p><pre class="programlisting">090213 16:58:54 [Warning] Statement is not safe to log in statement format.
</pre><p>
            A similar warning is also issued to the client in such
            cases.
          </p></li><li><p>
            <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT ...
            SELECT</code></a> requires a greater number of row-level
            locks than with row-based replication.
          </p></li><li><p>
            <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements that
            require a table scan (because no index is used in the
            <code class="literal">WHERE</code> clause) must lock a greater number
            of rows than with row-based replication.
          </p></li><li><p>
            For <code class="literal">InnoDB</code>: An
            <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statement that uses
            <code class="literal">AUTO_INCREMENT</code> blocks other
            non-conflicting <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a>
            statements.
          </p></li><li><p>
            For complex statements, the statement must be evaluated and
            executed on the slave before the rows are updated or
            inserted. With row-based replication, the slave only has to
            run the statement to apply the differences, not the full
            statement.
          </p></li><li><p>
            Stored functions execute with the same
            <a href="functions.html#function_now"><code class="literal">NOW()</code></a> value as the calling
            statement. However, this is not true of stored procedures.
          </p></li><li><p>
            Deterministic UDFs must be applied on the slaves.
          </p></li><li><p>
            If there is an error in evaluation on the slave,
            particularly when executing complex statements, then using
            statement-based replication may slowly increase the margin
            of error across the affected rows over time. See
            <a href="replication.html#replication-features-slaveerrors" title="16.3.1.20. Slave Errors during Replication">Section 16.3.1.20, “Slave Errors during Replication”</a>.
          </p></li><li><p>
            Tables must be (nearly) identical on master and slave. See
            <a href="replication.html#replication-features-differing-tables" title="16.3.1.4. Replication with Differing Tables on Master and Slave">Section 16.3.1.4, “Replication with Differing Tables on Master and Slave”</a>, for
            more information.
          </p></li></ul></div><p>
        <span class="bold"><strong>Advantages of row-based
        replication:</strong></span>
      </p><a class="indexterm" name="id3539159"></a><div class="itemizedlist"><ul type="disc"><li><p>
            All changes can be replicated. This is the safest form of
            replication.
          </p><p>
            The <code class="literal">mysql</code> database is not replicated. The
            <code class="literal">mysql</code> database is instead seen as a
            node-specific database. Row-based replication is not
            supported on tables in this database. Instead, statements
            that would normally update this information — such as
            <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a>,
            <a href="sql-syntax.html#revoke" title="12.5.1.5. REVOKE Syntax"><code class="literal">REVOKE</code></a> and the manipulation
            of triggers, stored routines (including stored procedures),
            and views — are all replicated to slaves using
            statement-based replication.
          </p><p>
            For statements like <code class="literal">CREATE ... SELECT</code>, a
            <code class="literal">CREATE</code> statement is generated from the
            table definition and replicated using the statement-based
            format, while the row insertions are replicated using the
            row-based format.
          </p></li><li><p>
            The technology is the same as in most other database
            management systems; knowledge about other systems transfers
            to MySQL.
          </p></li><li><p>
            Fewer locks are needed (and thus higher concurrency) on the
            master for the following types of statements:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <a href="sql-syntax.html#insert-select" title="12.2.5.1. INSERT ...
        SELECT Syntax"><code class="literal">INSERT
                ... SELECT</code></a>
              </p></li><li><p>
                <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statements with
                <code class="literal">AUTO_INCREMENT</code>
              </p></li><li><p>
                <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> or
                <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statements with
                <code class="literal">WHERE</code> clauses that don't use keys or
                don't change most of the examined rows.
              </p></li></ul></div></li><li><p>
            Fewer locks are required on the slave for any
            <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a>,
            <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>, or
            <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statement.
          </p></li></ul></div><p>
        <span class="bold"><strong>Disadvantages of row-based
        replication:</strong></span>
      </p><a class="indexterm" name="id3539371"></a><div class="itemizedlist"><ul type="disc"><li><p>
            RBR tends to generate more data that must be logged. This is
            because, when using row-based replication to replicate a DML
            statement (such as an <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
            or <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statement), each
            changed row must be written to the binary log. (When using
            statement-based replication, only the statement is written
            to the binary log.) This means that, if the statement
            changes many rows, row-based replication may write
            significantly more data to the binary log; this is true even
            for statements that are rolled back. This also means that
            taking and restoring from backup can require more time. In
            addition, the binary log is locked for a longer time to
            write the data, which may cause concurrency problems.
          </p></li><li><p>
            All tables replicated using row-based replication must have
            explicit primary keys.
          </p></li><li><p>
            Deterministic UDFs that generate large
            <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> values take longer to
            replicate with row-based replication than with
            statement-based replication. This is because, when using
            row-based replication, the
            <a href="data-types.html#blob" title="10.4.3. The BLOB and
        TEXT Types"><code class="literal">BLOB</code></a> column data is itself
            logged, rather than the statement generating the data.
          </p></li><li><p>
            You cannot examine the logs to see what statements were
            executed, nor can you see on the slave what statements were
            received from the master and executed.
          </p><p>
            However, beginning with MySQL 6.0.7, you can see what data
            was changed using <a href="programs.html#mysqlbinlog" title="4.6.8. mysqlbinlog — Utility for Processing Binary Log Files"><span><strong class="command">mysqlbinlog</strong></span></a> with the
            options
            <a href="programs.html#option_mysqlbinlog_base64-output"><code class="option">--base64-output=DECODE-ROWS</code></a>
            and <a href="programs.html#option_mysqlbinlog_verbose"><code class="option">--verbose</code></a>.
          </p></li><li><p>
            When performing a bulk operation that includes
            non-transactional storage engines, changes are applied as
            the statement executes. With row-based replication logging,
            this means that the binary log is written while the
            statement is running. On the master, this does not cause
            problems with concurrency, because tables are locked until
            the bulk operation terminates. On the slave server, however,
            tables are not locked while the slave applies changes,
            because the slave does not know that those changes are part
            of a bulk operation.
          </p><p>
            In such cases, if you retrieve data from a table on the
            master (for example, using <code class="literal">SELECT * FROM
            table_name</code>), the server waits for the bulk
            operation to complete before executing the
            <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a> statement, because the
            table is read-locked. On the slave, the server does not wait
            (because there is no lock). This means that, until the bulk
            operation on the slave has completed, you obtain different
            results for the same <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a>
            query on the master and on the slave.
          </p><p>
            This behavior is expected to change in a future MySQL
            release; however, until it changes, you may prefer to use
            statement-based replication when your application requires
            concurrent large bulk inserts and selects.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-rbr-usage"></a>16.1.2.2. Usage of Row-based Logging and Row-Based Replication</h4></div></div></div><p>
        Using row-based logging or replication, rather than
        statement-based logging or replication, can result in major
        changes in the replication environment and in the behavior of
        applications. This section describes a number of issues known to
        exist when using row-based logging or row-based replication, and
        discusses some best practices for taking advantage of row-based
        logging (RBL) and row-based replication (RBR).
      </p><p>
        For additional information, see
        <a href="replication.html#replication-sbr-rbr" title="16.1.2.1. Comparison of Statement-Based and Row-Based Replication">Section 16.1.2.1, “Comparison of Statement-Based and Row-Based Replication”</a>, and
        <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
      </p><div class="itemizedlist"><ul type="disc"><li><p><b>RBR and primary keys. </b>
              Currently, row-based replication may fail if any table to
              be replicated does not have an explicit primary key. This
              is a known issue which we are working to fix in a future
              MySQL release.
            </p></li><li><p><b>RBL, RBR, and temporary tables. </b>
              As noted elsewhere in this chapter (see
              <a href="replication.html#replication-features-temptables" title="16.3.1.22. Replication and Temporary Tables">Section 16.3.1.22, “Replication and Temporary Tables”</a>),
              temporary tables are not replicated when using the
              row-based format. However, you can use the mixed format;
              when mixed format is in effect, “<span class="quote">safe</span>”
              statements involving temporary tables are logged using the
              statement-based format. For more information, see
              <a href="replication.html#replication-sbr-rbr" title="16.1.2.1. Comparison of Statement-Based and Row-Based Replication">Section 16.1.2.1, “Comparison of Statement-Based and Row-Based Replication”</a>.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              There is actually no need to replicate temporary tables
              when using RBR. In addition, since temporary tables can be
              read only from the thread which created them, there is
              seldom if ever any benefit obtained from replicating them,
              even when using statement-based mode.
            </p></div></li><li><p><b>RBL and the <code class="literal">BLACKHOLE</code> storage engine. </b>
              Prior to MySQL 6.0.7,
              <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> and
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements did not
              work with RBL and <code class="literal">BLACKHOLE</code> tables (<a href="http://bugs.mysql.com/38360" target="_top">Bug#38360</a>).
            </p></li><li><p><b>RBL and synchronization of non-transactional tables. </b>
              When using row-based replication of a
              <code class="literal">MyISAM</code> or other non-transactional
              table, changed rows are written to the transaction cache.
              Often, when many rows are affected, the set of changes are
              split into several events; when the statement commits, all
              of these events are written to the binary log. When
              executing on the slave, a table lock is taken on all
              tables involved, then the rows are applied in batch mode.
              (This may or may not be effective, depending on the engine
              used for the slave's copy of the table).
            </p></li><li><p><b>Latency and binary log size. </b>
              Because RBL writes changes for each row to the binary log,
              the size of the binary log can grow quite rapidly. When
              used in a replication environment, this can significantly
              increase the time required for making the changes on the
              slave that match those on the master. You should be aware
              of the potential for this delay in your applications.
            </p></li><li><p><b>Reading the binary log. </b>
              With the
              <a href="programs.html#option_mysqlbinlog_base64-output"><code class="option">--base64-output=DECODE-ROWS</code></a>
              and <a href="programs.html#option_mysqlbinlog_verbose"><code class="option">--verbose</code></a> options,
              <a href="programs.html#mysqlbinlog" title="4.6.8. mysqlbinlog — Utility for Processing Binary Log Files"><span><strong class="command">mysqlbinlog</strong></span></a> is able to format the
              contents of the binary log in a manner that is easily
              human-readable, in case you want to read or recover from a
              replication or database failure using the contents of the
              binary log. For more information, see
              <a href="programs.html#mysqlbinlog-row-events" title="4.6.8.2. mysqlbinlog Row Event Display">Section 4.6.8.2, “<span><strong class="command">mysqlbinlog</strong></span> Row Event Display”</a>. Before MySQL
              6.0.7, this was not possible (<a href="http://bugs.mysql.com/31455" target="_top">Bug#31455</a>).
            </p></li><li><p><b>Binary log execution errors and
              <code class="literal">slave_exec_mode</code>. </b>
              If you use <code class="literal">slave_exec_mode=IDEMPOTENT</code>,
              a failure to apply changes from RBL because the original
              row cannot be found does not trigger an error, and does
              not cause replication to fail. This means that it is
              possible that updates are not applied on the slave, so
              that the master and slave are no longer synchronized.
              Latency issues and use of non-transactional tables when
              using <code class="literal">slave_exec_mode=IDEMPOTENT</code> and
              RBR can cause the master and slave to diverge even
              further. For more information about
              <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_exec_mode" target="_top"><code class="literal">slave_exec_mode</code></a>, see
              <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <code class="literal">slave_exec_mode=IDEMPOTENT</code> is generally
              useful only for circular replication or multi-master
              replication with MySQL Cluster. For other scenarios, the
              default value (<code class="literal">slave_exec_mode=STRICT</code>)
              is normally sufficient.
            </p><p>
              The <code class="literal">NDBCLUSTER</code> storage engine
              is currently not supported in MySQL 6.0. MySQL Cluster
              users wishing to upgrade from MySQL 5.0 should instead
              migrate to MySQL Cluster NDB 6.2 or 6.3; these are based
              on MySQL 5.1 but contain the latest improvements and fixes
              for <code class="literal">NDBCLUSTER</code>. For more
              information, see
              <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster.html" target="_top">MySQL Cluster NDB 6.X/7.X</a>.
            </p></div></li><li><p><b>Lack of binary log checksums. </b>
              No checksums are used for RBL. This means that network,
              disk, and other errors may not be identified when
              processing the binary log. To ensure that data is
              transmitted without network corruption, you may want to
              consider using SSL, which adds another layer of
              checksumming, for replication connections. See
              <a href="server-administration.html#secure-connections" title="5.5.7. Using SSL for Secure Connections">Section 5.5.7, “Using SSL for Secure Connections”</a>, for more information
              about setting up MySQL with SSL.
            </p></li><li><p><b>Filtering based on server ID. </b>
              A common practice is to filter out changes on some slaves
              by using a <code class="literal">WHERE</code> clause that includes
              the relation <code class="literal">@server_id &lt;&gt;
              <em class="replaceable"><code>server-id</code></em></code> clause with
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> and DELETE
              statements, a simple example of such a clause being
              <code class="literal">WHERE @server_id &lt;&gt; 1</code>. However,
              this does not work correctly with row-based logging. If
              you must use the
              <a href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a> system variable
              for statement filtering, then you must also use
              <a href="replication.html#sysvar_binlog_format"><code class="option">--binlog_format=STATEMENT</code></a>.
            </p><p>
            Beginning with MySQL 6.0.10, you can do filtering based on
            server ID by using the <code class="literal">IGNORE_SERVER_IDS</code>
            option for the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement. This option works with the
            statement-based and row-based logging formats.
          </p></li><li><p><b>Database-level replication options. </b>
              The effects of the options
              <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>,
              <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>, and
              <a href="replication.html#option_mysqld_replicate-rewrite-db"><code class="option">--replicate-rewrite-db</code></a>
              differ considerably depending on whether row-based or
              statement-based logging is in use. Because of this, we
              recommend that you avoid the database-level options and
              use the table-level options such as
              <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a> and
              <a href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>
              instead. For more information about these options and the
              impact that your choice of replication format has on how
              they operate, see <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.
            </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-options"></a>16.1.3. Replication and Binary Logging Options and Variables</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-options-table">16.1.3.1. Replication and Binary Logging Option and Variable Reference</a></span></dt><dt><span class="section"><a href="replication.html#replication-options-master">16.1.3.2. Replication Master Options and Variables</a></span></dt><dt><span class="section"><a href="replication.html#replication-options-slave">16.1.3.3. Replication Slave Options and Variables</a></span></dt><dt><span class="section"><a href="replication.html#replication-options-binary-log">16.1.3.4. Binary Log Options and Variables</a></span></dt></dl></div><p>
    The next few sections contain information about
    <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> options and server variables that are used
    in replication and for controlling the binary log. Options and
    variables for use on replication masters and replication slaves are
    covered separately, as are options and variables relating to binary
    logging. A set of quick-reference tables providing basic information
    about these options and variables is also included (in the next
    section following this one).
  </p><p><a name="option_mysqld_server-id"></a>
    <a class="indexterm" name="id3540161"></a>

    <a class="indexterm" name="id3540173"></a>

    Of particular importance is the
    <a href="replication.html#option_mysqld_server-id"><code class="option">--server-id</code></a> option.
  </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--server-id=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">server-id</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">server_id</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4294967295</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
    This option is common to both master and slave replication servers,
    and is used in replication to enable master and slave servers to
    identify themselves uniquely. For additional information, see
    <a href="replication.html#replication-options-master" title="16.1.3.2. Replication Master Options and Variables">Section 16.1.3.2, “Replication Master Options and Variables”</a>, and
    <a href="replication.html#replication-options-slave" title="16.1.3.3. Replication Slave Options and Variables">Section 16.1.3.3, “Replication Slave Options and Variables”</a>.
  </p><p>
    On the master and each slave, you <span class="emphasis"><em>must</em></span> use the
    <a href="replication.html#option_mysqld_server-id"><code class="option">--server-id</code></a> option to establish a
    unique replication ID in the range from 1 to
    2<sup>32</sup> – 1; by “<span class="quote">unique</span>”,
    we mean that each ID must be different from every other ID in use by
    any other replication master or slave. Example:
    <code class="literal">server-id=3</code>.
  </p><p>
    If you omit <a href="replication.html#option_mysqld_server-id"><code class="option">--server-id</code></a>, it assumes
    the default value 0, in which case a master refuses connections from
    all slaves, and a slave refuses to connect to a master. See
    <a href="replication.html#replication-howto-slavebaseconfig" title="16.1.1.3. Setting the Replication Slave Configuration">Section 16.1.1.3, “Setting the Replication Slave Configuration”</a>, for more
    information.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-options-table"></a>16.1.3.1. Replication and Binary Logging Option and Variable Reference</h4></div></div></div><p>
      The following tables list basic information about the MySQL
      command-line options and system variables applicable to
      replication and the binary log.
    </p><div class="table"><a name="id3540426"></a><p class="title"><b>Table 16.1. <span>mysqld</span> Replication Option/Variable Summary</b></p><table summary="mysqld Replication Option/Variable Summary" border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"></colgroup><thead><tr><th><span class="bold"><strong>Name</strong></span></th><th align="center"><span class="bold"><strong>Cmd-Line</strong></span></th><th align="center"><span class="bold"><strong>Option file</strong></span></th><th align="center"><span class="bold"><strong>System Var</strong></span></th><th align="center"><span class="bold"><strong>Status Var</strong></span></th><th align="center"><span class="bold"><strong>Var Scope</strong></span></th><th align="center"><span class="bold"><strong>Dynamic</strong></span></th></tr></thead><tbody><tr><td><a href="replication.html#option_mysqld_abort-slave-event-count">abort-slave-event-count</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_change_master</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_master_status</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_new_master</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_slave_hosts</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_slave_status</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_slave_start</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_slave_stop</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_disconnect-slave-event-count">disconnect-slave-event-count</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#sysvar_init_slave">init_slave</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#option_mysqld_log-slave-updates">log-slave-updates</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: log_slave_updates</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">master-bind</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_master-info-file">master-info-file</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_master-retry-count">master-retry-count</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_relay-log">relay-log</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_relay-log-index">relay-log-index</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: relay_log_index</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="server-administration.html#sysvar_relay_log_purge">relay_log_purge</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#sysvar_relay_log_recovery">relay_log_recovery</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#option_mysqld_replicate-do-db">replicate-do-db</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-do-table">replicate-do-table</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-ignore-db">replicate-ignore-db</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-ignore-table">replicate-ignore-table</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-rewrite-db">replicate-rewrite-db</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-same-server-id">replicate-same-server-id</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-wild-do-table">replicate-wild-do-table</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_replicate-wild-ignore-table">replicate-wild-ignore-table</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_report-host">report-host</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: report_host</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_report-password">report-password</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: report_password</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_report-port">report-port</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: report_port</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_report-user">report-user</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: report_user</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#sysvar_rpl_recovery_rank">rpl_recovery_rank</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_clients">Rpl_semi_sync_master_clients</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_master_enabled">rpl_semi_sync_master_enabled</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_net_avg_wait_time">Rpl_semi_sync_master_net_avg_wait_time</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_net_wait_time">Rpl_semi_sync_master_net_wait_time</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_net_waits">Rpl_semi_sync_master_net_waits</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_no_times">Rpl_semi_sync_master_no_times</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_no_tx">Rpl_semi_sync_master_no_tx</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_master_reply_log_file_pos">rpl_semi_sync_master_reply_log_file_pos</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_status">Rpl_semi_sync_master_status</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_timefunc_failures">Rpl_semi_sync_master_timefunc_failures</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_master_timeout">rpl_semi_sync_master_timeout</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_master_trace_level">rpl_semi_sync_master_trace_level</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_tx_avg_wait_time">Rpl_semi_sync_master_tx_avg_wait_time</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_tx_wait_time">Rpl_semi_sync_master_tx_wait_time</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_tx_waits">Rpl_semi_sync_master_tx_waits</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_wait_pos_backtraverse">Rpl_semi_sync_master_wait_pos_backtraverse</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_wait_sessions">Rpl_semi_sync_master_wait_sessions</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_master_yes_tx">Rpl_semi_sync_master_yes_tx</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_slave_enabled">rpl_semi_sync_slave_enabled</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_semi_sync_slave_status">Rpl_semi_sync_slave_status</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#sysvar_rpl_semi_sync_slave_trace_level">rpl_semi_sync_slave_trace_level</a></td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Rpl_status">Rpl_status</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_show-slave-auth-info">show-slave-auth-info</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">skip-slave-start</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#sysvar_slave_compressed_protocol">slave_compressed_protocol</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td>slave_exec_mode</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Slave_heartbeat_period">Slave_heartbeat_period</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">slave-load-tmpdir</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: slave_load_tmpdir</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_slave-net-timeout">slave-net-timeout</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: slave_net_timeout</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Slave_open_temp_tables">Slave_open_temp_tables</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Slave_received_heartbeats">Slave_received_heartbeats</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Slave_retried_transactions">Slave_retried_transactions</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Slave_running">Slave_running</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_slave-skip-errors">slave-skip-errors</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: slave_skip_errors</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td>slave_transaction_retries</td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td>sql_slave_skip_counter</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr></tbody></table></div><p>
      <a href="replication.html#replication-options-master" title="16.1.3.2. Replication Master Options and Variables">Section 16.1.3.2, “Replication Master Options and Variables”</a>, provides more
      detailed information about options and variables relating to
      replication master servers. For more information about options and
      variables relating to replication slaves
      <a href="replication.html#replication-options-slave" title="16.1.3.3. Replication Slave Options and Variables">Section 16.1.3.3, “Replication Slave Options and Variables”</a>.
    </p><div class="table"><a name="id3542507"></a><p class="title"><b>Table 16.2. <span>mysqld</span> Binary Logging Option/Variable Summary</b></p><table summary="mysqld Binary Logging Option/Variable Summary" border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"></colgroup><thead><tr><th><span class="bold"><strong>Name</strong></span></th><th align="center"><span class="bold"><strong>Cmd-Line</strong></span></th><th align="center"><span class="bold"><strong>Option file</strong></span></th><th align="center"><span class="bold"><strong>System Var</strong></span></th><th align="center"><span class="bold"><strong>Status Var</strong></span></th><th align="center"><span class="bold"><strong>Var Scope</strong></span></th><th align="center"><span class="bold"><strong>Dynamic</strong></span></th></tr></thead><tbody><tr><td><a href="server-administration.html#statvar_Binlog_cache_disk_use">Binlog_cache_disk_use</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#sysvar_binlog_cache_size">binlog_cache_size</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="server-administration.html#statvar_Binlog_cache_use">Binlog_cache_use</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="replication.html#option_mysqld_binlog-do-db">binlog-do-db</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="server-administration.html#option_mysqld_binlog-format">binlog-format</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: binlog_format</td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#option_mysqld_binlog-ignore-db">binlog-ignore-db</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#option_mysqld_binlog-row-event-max-size">binlog-row-event-max-size</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_binlog_events</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="server-administration.html#statvar_Com_xxx">Com_show_binlogs</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="replication.html#sysvar_max_binlog_cache_size">max_binlog_cache_size</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#option_mysqld_max-binlog-dump-events">max-binlog-dump-events</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="replication.html#sysvar_max_binlog_size">max_binlog_size</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">Yes</td></tr><tr><td><a href="replication.html#option_mysqld_sporadic-binlog-dump-fail">sporadic-binlog-dump-fail</a></td><td align="center">Yes</td><td align="center">Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr></tbody></table></div><p>
      <a href="replication.html#replication-options-binary-log" title="16.1.3.4. Binary Log Options and Variables">Section 16.1.3.4, “Binary Log Options and Variables”</a>, provides more
      detailed information about options and variables relating to
      binary logging. For additional general information about the
      binary log, see <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>.
    </p><p>
      For a table showing <span class="emphasis"><em>all</em></span> command-line options,
      system and status variables used with <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a>,
      see <a href="server-administration.html#mysqld-option-tables" title="5.1.1. Server Option and Variable Reference">Section 5.1.1, “Server Option and Variable Reference”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-options-master"></a>16.1.3.2. Replication Master Options and Variables</h4></div></div></div><p>
      This section describes the server options and system variables
      that you can use on replication master servers. You can specify
      the options either on the
      <a href="programs.html#command-line-options" title="4.2.3.1. Using Options on the Command Line">command line</a> or in an
      <a href="programs.html#option-files" title="4.2.3.2. Using Option Files">option file</a>. You can specify
      system variable values using
      <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET</code></a>.
    </p><p>
      On the master and each slave, you must use the
      <code class="option">server-id</code> option to establish a unique
      replication ID. For each server, you should pick a unique positive
      integer in the range from 1 to 2<sup>32</sup>
      – 1, and each ID must be different from every other ID in
      use by any other replication master or slave. Example:
      <code class="literal">server-id=3</code>.
    </p><p>
      For options used on the master for controlling binary logging, see
      <a href="replication.html#replication-options-binary-log" title="16.1.3.4. Binary Log Options and Variables">Section 16.1.3.4, “Binary Log Options and Variables”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="sysvar_auto_increment_increment"></a>
          <a class="indexterm" name="id3543088"></a>

          <a class="indexterm" name="id3543098"></a>

          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--auto_increment_increment[=#]</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">auto_increment_increment</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">auto_increment_increment</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-65535</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a> and
          <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a> are
          intended for use with master-to-master replication, and can be
          used to control the operation of
          <code class="literal">AUTO_INCREMENT</code> columns. Both variables have
          global and session values, and each can assume an integer
          value between 1 and 65,535 inclusive. Setting the value of
          either of these two variables to 0 causes its value to be set
          to 1 instead. Attempting to set the value of either of these
          two variables to an integer greater than 65,535 or less than 0
          causes its value to be set to 65,535 instead. Attempting to
          set the value of
          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a> or
          <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a> to a
          non-integer value gives rise to an error, and the actual value
          of the variable remains unchanged.
        </p><p>
          These two variables affect <code class="literal">AUTO_INCREMENT</code>
          column behavior as follows:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>
              controls the interval between successive column values.
              For example:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'auto_inc%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| auto_increment_increment | 1     |
| auto_increment_offset    | 1     |
+--------------------------+-------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE autoinc1</code></strong>
    -&gt; <strong class="userinput"><code>(col INT NOT NULL AUTO_INCREMENT PRIMARY KEY);</code></strong>
  Query OK, 0 rows affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SET @@auto_increment_increment=10;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'auto_inc%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| auto_increment_increment | 10    |
| auto_increment_offset    | 1     |
+--------------------------+-------+
2 rows in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO autoinc1 VALUES (NULL), (NULL), (NULL), (NULL);</code></strong>
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT col FROM autoinc1;</code></strong>
+-----+
| col |
+-----+
|   1 |
|  11 |
|  21 |
|  31 |
+-----+
4 rows in set (0.00 sec)
</pre><p>
              (Note how <a href="sql-syntax.html#show-variables" title="12.5.6.39. SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> is
              used here to obtain the current values for these
              variables.)
            </p></li><li><p>
              <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
              determines the starting point for the
              <code class="literal">AUTO_INCREMENT</code> column value. Consider
              the following, assuming that these statements are executed
              during the same session as the example given in the
              description for
              <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET @@auto_increment_offset=5;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'auto_inc%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| auto_increment_increment | 10    |
| auto_increment_offset    | 5     |
+--------------------------+-------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE autoinc2</code></strong>
    -&gt; <strong class="userinput"><code>(col INT NOT NULL AUTO_INCREMENT PRIMARY KEY);</code></strong>
Query OK, 0 rows affected (0.06 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO autoinc2 VALUES (NULL), (NULL), (NULL), (NULL);</code></strong>
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT col FROM autoinc2;</code></strong>
+-----+
| col |
+-----+
|   5 |
|  15 |
|  25 |
|  35 |
+-----+
4 rows in set (0.02 sec)
</pre><p>
              If the value of
              <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a> is
              greater than that of
              <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>,
              the value of
              <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a> is
              ignored.
            </p></li></ul></div><p>
          Should one or both of these variables be changed and then new
          rows inserted into a table containing an
          <code class="literal">AUTO_INCREMENT</code> column, the results may seem
          counterintuitive because the series of
          <code class="literal">AUTO_INCREMENT</code> values is calculated without
          regard to any values already present in the column, and the
          next value inserted is the least value in the series that is
          greater than the maximum existing value in the
          <code class="literal">AUTO_INCREMENT</code> column. In other words, the
          series is calculated like so:
        </p><p>
          <code class="literal">auto_increment_offset + <em class="replaceable"><code>N</code></em>
          × auto_increment_increment</code>
        </p><p>
          where <em class="replaceable"><code>N</code></em> is a positive integer value
          in the series [1, 2, 3, ...]. For example:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'auto_inc%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| auto_increment_increment | 10    |
| auto_increment_offset    | 5     |
+--------------------------+-------+
2 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT col FROM autoinc1;</code></strong>
+-----+
| col |
+-----+
|   1 |
|  11 |
|  21 |
|  31 |
+-----+
4 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO autoinc1 VALUES (NULL), (NULL), (NULL), (NULL);</code></strong>
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT col FROM autoinc1;</code></strong>
+-----+
| col |
+-----+
|   1 |
|  11 |
|  21 |
|  31 |
|  35 |
|  45 |
|  55 |
|  65 |
+-----+
8 rows in set (0.00 sec)
</pre><p>
          The values shown for
          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a> and
          <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
          generate the series 5 + <em class="replaceable"><code>N</code></em> ×
          10, that is, [5, 15, 25, 35, 45, ...]. The greatest value
          present in the <code class="literal">col</code> column prior to the
          <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> is 31, and the next
          available value in the <code class="literal">AUTO_INCREMENT</code>
          series is 35, so the inserted values for
          <code class="literal">col</code> begin at that point and the results are
          as shown for the <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a> query.
        </p><p>
          It is not possible to confine the effects of these two
          variables to a single table, and thus they do not take the
          place of the sequences offered by some other database
          management systems; these variables control the behavior of
          all <code class="literal">AUTO_INCREMENT</code> columns in
          <span class="emphasis"><em>all</em></span> tables on the MySQL server. If the
          global value of either variable is set, its effects persist
          until the global value is changed or overridden by setting the
          session value, or until <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> is
          restarted. If the local value is set, the new value affects
          <code class="literal">AUTO_INCREMENT</code> columns for all tables into
          which new rows are inserted by the current user for the
          duration of the session, unless the values are changed during
          that session.
        </p><p>
          The default value of
          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a> is
          1. See <a href="replication.html#replication-features-auto-increment" title="16.3.1.1. Replication and AUTO_INCREMENT">Section 16.3.1.1, “Replication and <code class="literal">AUTO_INCREMENT</code>”</a>.
        </p></li><li><p><a name="sysvar_auto_increment_offset"></a>
          <a class="indexterm" name="id3543787"></a>

          <a class="indexterm" name="id3543797"></a>

          <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--auto_increment_offset[=#]</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">auto_increment_offset</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_auto_increment_offset"><code class="literal">auto_increment_offset</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">auto_increment_offset</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">1-65535</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This variable has a default value of 1. For particulars, see
          the description for
          <a href="replication.html#sysvar_auto_increment_increment"><code class="literal">auto_increment_increment</code></a>.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-options-slave"></a>16.1.3.3. Replication Slave Options and Variables</h4></div></div></div><p>
      This section describes the server options and system variables
      that you can use on slave replication servers. You can specify the
      options either on the <a href="programs.html#command-line-options" title="4.2.3.1. Using Options on the Command Line">command
      line</a> or in an <a href="programs.html#option-files" title="4.2.3.2. Using Option Files">option
      file</a>. Many of the options can be reset while the server is
      running by using the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
      TO</code></a> statement. You can specify system variable values
      using <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET</code></a>.
    </p><p><b>Server ID. </b>
        On the master and each slave, you must use the
        <code class="option">server-id</code> option to establish a unique
        replication ID. For each server, you should pick a unique
        positive integer in the range from 1 to
        2<sup>32</sup> – 1, and each ID must be
        different from every other ID. Example:
        <code class="option">server-id=3</code>.
      </p><p>
      The <code class="filename">master.info</code> file format in MySQL
      6.0 includes values corresponding to the SSL options.
      In addition, the file format includes as its first line the number
      of lines in the file. (See <a href="replication.html#slave-logs" title="16.4.2. Replication Relay and Status Files">Section 16.4.2, “Replication Relay and Status Files”</a>.) If you
      upgrade an older server (before MySQL 4.1.1) to a newer version,
      the new server upgrades the <code class="filename">master.info</code> file
      to the new format automatically when it starts. However, if you
      downgrade a newer server to an older version, you should remove
      the first line manually before starting the older server for the
      first time.
    </p><p>
      If no <code class="filename">master.info</code> file exists when the slave
      server starts, it uses the values for those options that are
      specified in option files or on the command line. This occurs when
      you start the server as a replication slave for the very first
      time, or when you have run <a href="sql-syntax.html#reset-slave" title="12.6.2.3. RESET SLAVE Syntax"><code class="literal">RESET
      SLAVE</code></a> and then have shut down and restarted the slave.
    </p><p>
      If the <code class="filename">master.info</code> file exists when the slave
      server starts, the server uses its contents and ignores any
      options that correspond to the values listed in the file. Thus, if
      you start the slave server with different values of the startup
      options that correspond to values in the
      <code class="filename">master.info</code> file, the different values have
      no effect, because the server continues to use the
      <code class="filename">master.info</code> file. To use different values,
      you must either restart after removing the
      <code class="filename">master.info</code> file or (preferably) use the
      <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement to reset
      the values while the slave is running.
    </p><p>
      Suppose that you specify this option in your
      <code class="filename">my.cnf</code> file:
    </p><pre class="programlisting">[mysqld]
master-host=<em class="replaceable"><code>some_host</code></em>
</pre><p>
      The first time you start the server as a replication slave, it
      reads and uses that option from the <code class="filename">my.cnf</code>
      file. The server then records the value in the
      <code class="filename">master.info</code> file. The next time you start the
      server, it reads the master host value from the
      <code class="filename">master.info</code> file only and ignores the value
      in the option file. If you modify the <code class="filename">my.cnf</code>
      file to specify a different master host of
      <em class="replaceable"><code>some_other_host</code></em>, the change still has
      no effect. You should use <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
      TO</code></a> instead.
    </p><p>
      This example shows a more extensive use of startup options to
      configure a slave server:
    </p><pre class="programlisting">[mysqld]
server-id=2
master-host=db-master.mycompany.com
master-port=3306
master-user=pertinax
master-password=freitag
master-connect-retry=60
report-host=db-slave.mycompany.com
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Because the server gives an existing
        <code class="filename">master.info</code> file precedence over the
        startup options just described, you might prefer not to use
        startup options for these values at all, and instead to specify
        them by using the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> statement. See <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>.
      </p></div><p><a name="replication-optvars-slaves"></a><b>Startup options for replication slaves. </b>
        The following list describes startup options for controlling
        replication slaves. Many of these options can be reset while the
        server is running by using the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE
        MASTER TO</code></a> statement. Others, such as the
        <code class="option">--replicate-*</code> options, can be set only when the
        slave server starts. Replication-related system variables are
        discussed later in this section.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_log-slave-updates"></a>
          <a class="indexterm" name="id3544306"></a>

          <a class="indexterm" name="id3544318"></a>

          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a>
        </p><p>
          Normally, a slave does not log to its own binary log any
          updates that are received from a master server. This option
          tells the slave to log the updates performed by its SQL thread
          to its own binary log. For this option to have any effect, the
          slave must also be started with the
          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> option to enable
          binary logging.
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> is used
          when you want to chain replication servers. For example, you
          might want to set up replication servers using this
          arrangement:
        </p><pre class="programlisting">A -&gt; B -&gt; C
</pre><p>
          Here, <code class="literal">A</code> serves as the master for the slave
          <code class="literal">B</code>, and <code class="literal">B</code> serves as the
          master for the slave <code class="literal">C</code>. For this to work,
          <code class="literal">B</code> must be both a master
          <span class="emphasis"><em>and</em></span> a slave. You must start both
          <code class="literal">A</code> and <code class="literal">B</code> with
          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> to enable binary
          logging, and <code class="literal">B</code> with the
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> option so
          that updates received from <code class="literal">A</code> are logged by
          <code class="literal">B</code> to its binary log.
        </p></li><li><p><a name="option_mysqld_log-slow-slave-statements"></a>
          <a class="indexterm" name="id3544466"></a>

          <a class="indexterm" name="id3544478"></a>

          <a href="replication.html#option_mysqld_log-slow-slave-statements"><code class="option">--log-slow-slave-statements</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>6.0.4</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--log-slow-slave-statements</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">log-slow-slave-statements</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">off</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          When the slow query log is enabled, this option enables
          logging for queries that have taken more than
          <a href="server-administration.html#sysvar_long_query_time"><code class="literal">long_query_time</code></a> seconds to
          execute on the slave.
        </p><p>
          This option was added in MySQL 6.0.4.
        </p></li><li><p>
          <a class="indexterm" name="id3544618"></a>

          <a class="indexterm" name="id3544631"></a>

          <a href="server-administration.html#option_mysqld_log-warnings"><code class="option">--log-warnings[=<em class="replaceable"><code>level</code></em>]</code></a>
        </p><p>
          This option causes a server to print more messages to the
          error log about what it is doing. With respect to replication,
          the server generates warnings that it succeeded in
          reconnecting after a network/connection failure, and informs
          you as to how each slave thread started. This option is
          enabled by default; to disable it, use
          <a href="server-administration.html#option_mysqld_log-warnings"><code class="option">--skip-log-warnings</code></a>.
          Aborted connections are not logged to the error log unless the
          value is greater than 1.
        </p><p>
          Note that the effects of this option are not limited to
          replication. It produces warnings across a spectrum of server
          activities.
        </p></li><li><p><a name="option_mysqld_master-info-file"></a>
          <a class="indexterm" name="id3544689"></a>

          <a class="indexterm" name="id3544701"></a>

          <a href="replication.html#option_mysqld_master-info-file"><code class="option">--master-info-file=<em class="replaceable"><code>file_name</code></em></code></a>
        </p><p>
          The name to use for the file in which the slave records
          information about the master. The default name is
          <code class="filename">master.info</code> in the data directory.
        </p></li><li><p><a name="option_mysqld_master-retry-count"></a>
          <a class="indexterm" name="id3544745"></a>

          <a class="indexterm" name="id3544757"></a>

          <a href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count=<em class="replaceable"><code>count</code></em></code></a>
        </p><p>
          The number of times that the slave tries to connect to the
          master before giving up. Reconnects are attempted at intervals
          set by <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#option_mysqld_master-connect-retry" target="_top"><code class="option">--master-connect-retry</code></a>
          and reconnects are triggered when data reads by the slave time
          out according to the
          <a href="replication.html#option_mysqld_slave-net-timeout"><code class="option">--slave-net-timeout</code></a> option. The
          default value is 86400.
        </p><p>
          You can also set the retry count by using the
          <code class="literal">MASTER_CONNECT_RETRY</code> option for the
          <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement.
        </p></li><li><p><a name="option_mysqld_max-relay-log-size"></a>
          <a class="indexterm" name="id3544833"></a>

          <a class="indexterm" name="id3544845"></a>

          <a href="replication.html#option_mysqld_max-relay-log-size"><code class="option">--max-relay-log-size=<em class="replaceable"><code>size</code></em></code></a>
        </p><p>
          The size at which the server rotates relay log files
          automatically. For more information, see
          <a href="replication.html#slave-logs" title="16.4.2. Replication Relay and Status Files">Section 16.4.2, “Replication Relay and Status Files”</a>. The default size is 1GB.
        </p></li><li><p><a name="option_mysqld_read-only"></a>
          <a class="indexterm" name="id3544887"></a>

          <a class="indexterm" name="id3544900"></a>

          <a href="replication.html#option_mysqld_read-only"><code class="option">--read-only</code></a>
        </p><p>
          Cause the slave to allow no updates except from slave threads
          or from users having the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a>
          privilege. On a slave server, this can be useful to ensure
          that the slave accepts updates only from its master server and
          not from clients. This variable does not apply to
          <code class="literal">TEMPORARY</code> tables.
        </p></li><li><p><a name="option_mysqld_relay-log"></a>
          <a class="indexterm" name="id3544950"></a>

          <a class="indexterm" name="id3544963"></a>

          <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log=<em class="replaceable"><code>file_name</code></em></code></a>
        </p><p>
          The basename for the relay log. The default basename is
          <code class="filename"><em class="replaceable"><code>host_name</code></em>-relay-bin</code>.
          The server creates relay log files in sequence by adding a
          numeric suffix to the basename.
        </p><p>
          Due to the manner in which MySQL parses server options, if you
          specify this option, you must supply a value; <span class="emphasis"><em>the
          default basename is used only if the option is not actually
          specified</em></span>. If you use the
          <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> option without
          specifying a value, unexpected behavior is likely to result;
          this behavior depends on the other options used, the order in
          which they are specified, and whether they are specified on
          the command line or in an option file. For more information
          about how MySQL handles server options, see
          <a href="programs.html#program-options" title="4.2.3. Specifying Program Options">Section 4.2.3, “Specifying Program Options”</a>.
        </p><p>
          If you specify this option, the value specified is also used
          as the basename for the relay log index file. You can override
          this behavior by specifying a different relay log index file
          basename using the
          <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index</code></a> option.
        </p><p>
          You may find the <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a>
          option useful in performing the following tasks:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              Creating relay logs whose names are independent of host
              names.
            </p></li><li><p>
              If you need to put the relay logs in some area other than
              the data directory, because your relay logs tend to be
              very large and you do not want to decrease
              <a href="server-administration.html#sysvar_max_relay_log_size"><code class="literal">max_relay_log_size</code></a>.
            </p></li><li><p>
              To increase speed by using load-balancing between disks.
            </p></li></ul></div></li><li><p><a name="option_mysqld_relay-log-index"></a>
          <a class="indexterm" name="id3545103"></a>

          <a class="indexterm" name="id3545115"></a>

          <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index=<em class="replaceable"><code>file_name</code></em></code></a>
        </p><p>
          The name to use for the relay log index file. The default name
          is
          <code class="filename"><em class="replaceable"><code>host_name</code></em>-relay-bin.index</code>
          in the data directory, where
          <em class="replaceable"><code>host_name</code></em> is the name of the slave
          server.
        </p><p>
          Due to the manner in which MySQL parses server options, if you
          specify this option, you must supply a value; <span class="emphasis"><em>the
          default basename is used only if the option is not actually
          specified</em></span>. If you use the
          <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index</code></a> option
          without specifying a value, unexpected behavior is likely to
          result; this behavior depends on the other options used, the
          order in which they are specified, and whether they are
          specified on the command line or in an option file. For more
          information about how MySQL handles server options, see
          <a href="programs.html#program-options" title="4.2.3. Specifying Program Options">Section 4.2.3, “Specifying Program Options”</a>.
        </p><p>
          If you specify this option, the value specified is also used
          as the basename for the relay logs. You can override this
          behavior by specifying a different relay log file basename
          using the <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> option.
        </p></li><li><p><a name="option_mysqld_relay-log-info-file"></a>
          <a class="indexterm" name="id3545209"></a>

          <a class="indexterm" name="id3545222"></a>

          <a href="replication.html#option_mysqld_relay-log-info-file"><code class="option">--relay-log-info-file=<em class="replaceable"><code>file_name</code></em></code></a>
        </p><p>
          The name to use for the file in which the slave records
          information about the relay logs. The default name is
          <code class="filename">relay-log.info</code> in the data directory.
        </p></li><li><p><a name="option_mysqld_relay-log-purge"></a>
          <a class="indexterm" name="id3545266"></a>

          <a class="indexterm" name="id3545278"></a>

          <a href="replication.html#option_mysqld_relay-log-purge"><code class="option">--relay-log-purge={0|1}</code></a>
        </p><p>
          Disable or enable automatic purging of relay logs as soon as
          they are no longer needed. The default value is 1 (enabled).
          This is a global variable that can be changed dynamically with
          <code class="literal">SET GLOBAL relay_log_purge =
          <em class="replaceable"><code>N</code></em></code>.
        </p></li><li><p><a name="option_mysqld_relay-log-recovery"></a>
          <a class="indexterm" name="id3545323"></a>

          <a class="indexterm" name="id3545336"></a>

          <a href="replication.html#option_mysqld_relay-log-recovery"><code class="option">--relay-log-recovery={0|1}</code></a>
        </p><p>
          Enables automatic relay log recovery immediately following
          server startup, which means that the replication slave
          discards all unprocessed relay logs and retrieves them from
          the replication master. This should be used following a crash
          on the replication slave to insure that no possibly corrupted
          relay logs are processed. The default value is 0 (disabled).
        </p></li><li><p><a name="option_mysqld_relay-log-space-limit"></a>
          <a class="indexterm" name="id3545376"></a>

          <a class="indexterm" name="id3545389"></a>

          <a href="replication.html#option_mysqld_relay-log-space-limit"><code class="option">--relay-log-space-limit=<em class="replaceable"><code>size</code></em></code></a>
        </p><p>
          This option places an upper limit on the total size in bytes
          of all relay logs on the slave. A value of 0 means “<span class="quote">no
          limit.</span>” This is useful for a slave server host that has
          limited disk space. When the limit is reached, the I/O thread
          stops reading binary log events from the master server until
          the SQL thread has caught up and deleted some unused relay
          logs. Note that this limit is not absolute: There are cases
          where the SQL thread needs more events before it can delete
          relay logs. In that case, the I/O thread exceeds the limit
          until it becomes possible for the SQL thread to delete some
          relay logs, because not doing so would cause a deadlock. You
          should not set
          <a href="replication.html#option_mysqld_relay-log-space-limit"><code class="option">--relay-log-space-limit</code></a> to less
          than twice the value of
          <a href="replication.html#option_mysqld_max-relay-log-size"><code class="option">--max-relay-log-size</code></a> (or
          <a href="replication.html#sysvar_max_binlog_size"><code class="option">--max-binlog-size</code></a> if
          <a href="replication.html#option_mysqld_max-relay-log-size"><code class="option">--max-relay-log-size</code></a> is 0). In
          that case, there is a chance that the I/O thread waits for
          free space because
          <a href="replication.html#option_mysqld_relay-log-space-limit"><code class="option">--relay-log-space-limit</code></a> is
          exceeded, but the SQL thread has no relay log to purge and is
          unable to satisfy the I/O thread. This forces the I/O thread
          to ignore
          <a href="replication.html#option_mysqld_relay-log-space-limit"><code class="option">--relay-log-space-limit</code></a>
          temporarily.
        </p></li><li><p><a name="option_mysqld_replicate-do-db"></a>
          <a class="indexterm" name="id3545493"></a>

          <a class="indexterm" name="id3545505"></a>

          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=<em class="replaceable"><code>db_name</code></em></code></a>
        </p><p>
          The effects of this option depend on whether statement-based
          or row-based replication is in use.
        </p><p><b>Statement-based replication. </b>
            Tell the slave to restrict replication to statements where
            the default database (that is, the one selected by
            <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a>) is
            <em class="replaceable"><code>db_name</code></em>. To specify more than one
            database, use this option multiple times, once for each
            database; however, doing so does <span class="emphasis"><em>not</em></span>
            replicate cross-database statements such as <code class="literal">UPDATE
            <em class="replaceable"><code>some_db.some_table</code></em> SET
            foo='bar'</code> while a different database (or no
            database) is selected.
          </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
            To specify multiple databases you <span class="emphasis"><em>must</em></span>
            use multiple instances of this option. Because database
            names can contain commas, if you supply a comma separated
            list then the list will be treated as the name of a single
            database.
          </p></div><p>
          An example of what does not work as you might expect when
          using statement-based replication: If the slave is started
          with <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=sales</code></a>
          and you issue the following statements on the master, the
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement is
          <span class="emphasis"><em>not</em></span> replicated:

</p><pre class="programlisting">USE prices;
UPDATE sales.january SET amount=amount+1000;
</pre><p>

          The main reason for this “<span class="quote">check just the default
          database</span>” behavior is that it is difficult from the
          statement alone to know whether it should be replicated (for
          example, if you are using multiple-table
          <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statements or
          multiple-table <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
          statements that act across multiple databases). It is also
          faster to check only the default database rather than all
          databases if there is no need.
        </p><p><b>Row-based replication. </b>
            Tells the slave to restrict replication to database
            <em class="replaceable"><code>db_name</code></em>. Only tables belonging to
            <em class="replaceable"><code>db_name</code></em> are changed; the current
            database has no effect on this. For example, suppose that
            the slave is started with
            <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=sales</code></a> and
            row-based replication is in effect, and then the following
            statements are run on the master:

</p><pre class="programlisting">USE prices;
UPDATE sales.february SET amount=amount+100;
</pre><p>

            The <code class="literal">february</code> table in the
            <code class="literal">sales</code> database on the slave is changed in
            accordance with the <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
            statement; this occurs whether or not the
            <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a> statement was issued.
            However, issuing the following statements on the master has
            no effect on the slave when using row-based replication and
            <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=sales</code></a>:

</p><pre class="programlisting">USE prices;
UPDATE prices.march SET amount=amount-25;
</pre><p>

            Even if the statement <code class="literal">USE prices</code> were
            changed to <code class="literal">USE sales</code>, the
            <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement's
            effects would still not be replicated.
          </p><p>
          Another important difference in how
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> is handled in
          statement-based replication as opposed to row-based
          replication occurs with regard to statements that refer to
          multiple databases. Suppose the slave is started with
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=db1</code></a>, and the
          following statements are executed on the master:

</p><pre class="programlisting">USE db1;
UPDATE db1.table1 SET col1 = 10, db2.table2 SET col2 = 20;
</pre><p>

          If you are using statement-based replication, then both tables
          are updated on the slave. However, when using row-based
          replication, only <code class="literal">table1</code> is affected on the
          slave; since <code class="literal">table2</code> is in a different
          database, <code class="literal">table2</code> on the slave is not
          changed by the <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>. Now
          suppose that, instead of the <code class="literal">USE db1</code>
          statement, a <code class="literal">USE db4</code> statement had been
          used:

</p><pre class="programlisting">USE db4;
UPDATE db1.table1 SET col1 = 10, db2.table2 SET col2 = 20;
</pre><p>

          In this case, the <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
          statement would have no effect on the slave when using
          statement-based replication. However, if you are using
          row-based replication, the
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> would change
          <code class="literal">table1</code> on the slave, but not
          <code class="literal">table2</code> — in other words, only tables
          in the database named by
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> are changed,
          and the choice of current database has no effect on this
          behavior.
        </p><p>
          If you need cross-database updates to work, use
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=<em class="replaceable"><code>db_name</code></em>.%</code></a>
          instead. See <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            This option effects replication in the same manner that
            <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a> affects binary
            logging, and the affects of the replication format on how
            <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> affects
            replication behavior are the same as those of the logging
            format on the behavior of
            <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a>.
          </p></div></li><li><p><a name="option_mysqld_replicate-ignore-db"></a>
          <a class="indexterm" name="id3545940"></a>

          <a class="indexterm" name="id3545952"></a>

          <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db=<em class="replaceable"><code>db_name</code></em></code></a>
        </p><p>
          As with <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>, the
          effects of this option depend on whether statement-based or
          row-based replication is in use.
        </p><p><b>Statement-based replication. </b>
            Tells the slave to not replicate any statement where the
            default database (that is, the one selected by
            <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a>) is
            <em class="replaceable"><code>db_name</code></em>.
          </p><p><b>Row-based replication. </b>
            Tells the slave not to update any tables in the database
            <em class="replaceable"><code>db_name</code></em>. The current database has
            no effect.
          </p><p>
          When using statement-based replication, the following example
          does not work as you might expect. Suppose that the slave is
          started with
          <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db=sales</code></a> and
          you issue the following statements on the master:

</p><pre class="programlisting">USE prices;
UPDATE sales.january SET amount=amount+1000;
</pre><p>

          The <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement
          <span class="emphasis"><em>is</em></span> replicated in such a case because
          <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a> applies
          only to the default database (determined by the
          <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a> statement). Because the
          <code class="literal">sales</code> database was specified explicitly in
          the statement, the statement has not been filtered. However,
          when using row-based replication, the
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement's effects
          are <span class="emphasis"><em>not</em></span> propagated to the slave, and the
          slave's copy of the <code class="literal">sales.january</code>
          table is unchanged; in this instance,
          <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db=sales</code></a>
          causes <span class="emphasis"><em>all</em></span> changes made to tables in the
          master's copy of the <code class="literal">sales</code> database to
          be ignored by the slave.
        </p><p>
          To specify more than one database to ignore, use this option
          multiple times, once for each database. Because database names
          can contain commas, if you supply a comma separated list then
          the list will be treated as the name of a single database.
        </p><p>
          You should not use this option if you are using cross-database
          updates and you do not want these updates to be replicated.
          See <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p><p>
          If you need cross-database updates to work, use
          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table=<em class="replaceable"><code>db_name</code></em>.%</code></a>
          instead. See <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            This option effects replication in the same manner that
            <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a> affects
            binary logging, and the affects of the replication format on
            how <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
            affects replication behavior are the same as those of the
            logging format on the behavior of
            <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a>.
          </p></div></li><li><p><a name="option_mysqld_replicate-do-table"></a>
          <a class="indexterm" name="id3546207"></a>

          <a class="indexterm" name="id3546220"></a>

          <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table=<em class="replaceable"><code>db_name.tbl_name</code></em></code></a>
        </p><p>
          Tells the slave thread to restrict replication to the
          specified table. To specify more than one table, use this
          option multiple times, once for each table. This works for
          cross-database updates, in contrast to
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>. See
          <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p></li><li><p><a name="option_mysqld_replicate-ignore-table"></a>
          <a class="indexterm" name="id3546272"></a>

          <a class="indexterm" name="id3546285"></a>

          <a href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table=<em class="replaceable"><code>db_name.tbl_name</code></em></code></a>
        </p><p>
          Tells the slave thread to not replicate any statement that
          updates the specified table, even if any other tables might be
          updated by the same statement. To specify more than one table
          to ignore, use this option multiple times, once for each
          table. This works for cross-database updates, in contrast to
          <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>. See
          <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p></li><li><p><a name="option_mysqld_replicate-rewrite-db"></a>
          <a class="indexterm" name="id3546339"></a>

          <a class="indexterm" name="id3546351"></a>

          <a href="replication.html#option_mysqld_replicate-rewrite-db"><code class="option">--replicate-rewrite-db=<em class="replaceable"><code>from_name</code></em>-&gt;<em class="replaceable"><code>to_name</code></em></code></a>
        </p><p>
          Tells the slave to translate the default database (that is,
          the one selected by <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a>) to
          <em class="replaceable"><code>to_name</code></em> if it was
          <em class="replaceable"><code>from_name</code></em> on the master. Only
          statements involving tables are affected (not statements such
          as <a href="sql-syntax.html#create-database" title="12.1.8. CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>,
          <a href="sql-syntax.html#drop-database" title="12.1.17. DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>, and
          <a href="sql-syntax.html#alter-database" title="12.1.1. ALTER DATABASE Syntax"><code class="literal">ALTER DATABASE</code></a>), and only if
          <em class="replaceable"><code>from_name</code></em> is the default database
          on the master. This does not work for cross-database updates.
          To specify multiple rewrites, use this option multiple times.
          The server uses the first one with a
          <em class="replaceable"><code>from_name</code></em> value that matches. The
          database name translation is done <span class="emphasis"><em>before</em></span>
          the <code class="option">--replicate-*</code> rules are tested.
        </p><p>
          If you use this option on the command line and the
          “<span class="quote"><code class="literal">&gt;</code></span>” character is special to
          your command interpreter, quote the option value. For example:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld --replicate-rewrite-db="<em class="replaceable"><code>olddb</code></em>-&gt;<em class="replaceable"><code>newdb</code></em>"</code></strong>
</pre></li><li><p><a name="option_mysqld_replicate-same-server-id"></a>
          <a class="indexterm" name="id3546483"></a>

          <a class="indexterm" name="id3546496"></a>

          <a href="replication.html#option_mysqld_replicate-same-server-id"><code class="option">--replicate-same-server-id</code></a>
        </p><p>
          To be used on slave servers. Usually you should use the
          default setting of 0, to prevent infinite loops caused by
          circular replication. If set to 1, the slave does not skip
          events having its own server ID. Normally, this is useful only
          in rare configurations. Cannot be set to 1 if
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> is used. By
          default, the slave I/O thread does not write binary log events
          to the relay log if they have the slave's server ID (this
          optimization helps save disk usage). If you want to use
          <a href="replication.html#option_mysqld_replicate-same-server-id"><code class="option">--replicate-same-server-id</code></a>, be
          sure to start the slave with this option before you make the
          slave read its own events that you want the slave SQL thread
          to execute.
        </p></li><li><p><a name="option_mysqld_replicate-wild-do-table"></a>
          <a class="indexterm" name="id3546557"></a>

          <a class="indexterm" name="id3546569"></a>

          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=<em class="replaceable"><code>db_name.tbl_name</code></em></code></a>
        </p><p>
          Tells the slave thread to restrict replication to statements
          where any of the updated tables match the specified database
          and table name patterns. Patterns can contain the
          “<span class="quote"><code class="literal">%</code></span>” and
          “<span class="quote"><code class="literal">_</code></span>” wildcard characters, which
          have the same meaning as for the
          <a href="functions.html#operator_like"><code class="literal">LIKE</code></a> pattern-matching operator.
          To specify more than one table, use this option multiple
          times, once for each table. This works for cross-database
          updates. See <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p><p>
          Example:
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=foo%.bar%</code></a>
          replicates only updates that use a table where the database
          name starts with <code class="literal">foo</code> and the table name
          starts with <code class="literal">bar</code>.
        </p><p>
          If the table name pattern is <code class="literal">%</code>, it matches
          any table name and the option also applies to database-level
          statements (<a href="sql-syntax.html#create-database" title="12.1.8. CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>,
          <a href="sql-syntax.html#drop-database" title="12.1.17. DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>, and
          <a href="sql-syntax.html#alter-database" title="12.1.1. ALTER DATABASE Syntax"><code class="literal">ALTER DATABASE</code></a>). For example,
          if you use
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=foo%.%</code></a>,
          database-level statements are replicated if the database name
          matches the pattern <code class="literal">foo%</code>.
        </p><p>
          To include literal wildcard characters in the database or
          table name patterns, escape them with a backslash. For
          example, to replicate all tables of a database that is named
          <code class="literal">my_own%db</code>, but not replicate tables from
          the <code class="literal">my1ownAABCdb</code> database, you should
          escape the “<span class="quote"><code class="literal">_</code></span>” and
          “<span class="quote"><code class="literal">%</code></span>” characters like this:
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=my\_own\%db</code></a>.
          If you're using the option on the command line, you might need
          to double the backslashes or quote the option value, depending
          on your command interpreter. For example, with the
          <span><strong class="command">bash</strong></span> shell, you would need to type
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table=my\\_own\\%db</code></a>.
        </p></li><li><p><a name="option_mysqld_replicate-wild-ignore-table"></a>
          <a class="indexterm" name="id3546774"></a>

          <a class="indexterm" name="id3546787"></a>

          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table=<em class="replaceable"><code>db_name.tbl_name</code></em></code></a>
        </p><p>
          Tells the slave thread not to replicate a statement where any
          table matches the given wildcard pattern. To specify more than
          one table to ignore, use this option multiple times, once for
          each table. This works for cross-database updates. See
          <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
        </p><p>
          Example:
          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table=foo%.bar%</code></a>
          does not replicate updates that use a table where the database
          name starts with <code class="literal">foo</code> and the table name
          starts with <code class="literal">bar</code>.
        </p><p>
          For information about how matching works, see the description
          of the
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>
          option. The rules for including literal wildcard characters in
          the option value are the same as for
          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
          as well.
        </p></li><li><p><a name="option_mysqld_report-host"></a>
          <a class="indexterm" name="id3546881"></a>

          <a class="indexterm" name="id3546894"></a>

          <a href="replication.html#option_mysqld_report-host"><code class="option">--report-host=<em class="replaceable"><code>host_name</code></em></code></a>
        </p><p>
          The host name or IP number of the slave to be reported to the
          master during slave registration. This value appears in the
          output of <a href="sql-syntax.html#show-slave-hosts" title="12.5.6.33. SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a> on
          the master server. Leave the value unset if you do not want
          the slave to register itself with the master. Note that it is
          not sufficient for the master to simply read the IP number of
          the slave from the TCP/IP socket after the slave connects. Due
          to NAT and other routing issues, that IP may not be valid for
          connecting to the slave from the master or other hosts.
        </p></li><li><p><a name="option_mysqld_report-password"></a>
          <a class="indexterm" name="id3546945"></a>

          <a class="indexterm" name="id3546958"></a>

          <a href="replication.html#option_mysqld_report-password"><code class="option">--report-password=<em class="replaceable"><code>password</code></em></code></a>
        </p><p>
          The account password of the slave to be reported to the master
          during slave registration. This value appears in the output of
          <a href="sql-syntax.html#show-slave-hosts" title="12.5.6.33. SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a> on the master
          server if the
          <a href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a> option
          is given.
        </p></li><li><p><a name="option_mysqld_report-port"></a>
          <a class="indexterm" name="id3547012"></a>

          <a class="indexterm" name="id3547024"></a>

          <a href="replication.html#option_mysqld_report-port"><code class="option">--report-port=<em class="replaceable"><code>slave_port_num</code></em></code></a>
        </p><p>
          The TCP/IP port number for connecting to the slave, to be
          reported to the master during slave registration. Set this
          only if the slave is listening on a non-default port or if you
          have a special tunnel from the master or other clients to the
          slave. If you are not sure, do not use this option.
        </p></li><li><p><a name="option_mysqld_report-user"></a>
          <a class="indexterm" name="id3547064"></a>

          <a class="indexterm" name="id3547077"></a>

          <a href="replication.html#option_mysqld_report-user"><code class="option">--report-user=<em class="replaceable"><code>user_name</code></em></code></a>
        </p><p>
          The account user name of the slave to be reported to the
          master during slave registration. This value appears in the
          output of <a href="sql-syntax.html#show-slave-hosts" title="12.5.6.33. SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a> on
          the master server if the
          <a href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a> option
          is given.
        </p></li><li><p><a name="option_mysqld_show-slave-auth-info"></a>
          <a class="indexterm" name="id3547130"></a>

          <a class="indexterm" name="id3547143"></a>

          <a href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a>
        </p><p>
          Display slave user names and passwords in the output of
          <a href="sql-syntax.html#show-slave-hosts" title="12.5.6.33. SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a> on the master
          server for slaves started with the
          <a href="replication.html#option_mysqld_report-user"><code class="option">--report-user</code></a> and
          <a href="replication.html#option_mysqld_report-password"><code class="option">--report-password</code></a> options.
        </p></li><li><p><a name="option_mysqld_skip-slave-start"></a>
          <a class="indexterm" name="id3547201"></a>

          <a class="indexterm" name="id3547213"></a>

          <a href="replication.html#option_mysqld_skip-slave-start"><code class="option">--skip-slave-start</code></a>
        </p><p>
          Tells the slave server not to start the slave threads when the
          server starts. To start the threads later, use a
          <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement.
        </p></li><li><p><a name="option_mysqld_slave_compressed_protocol"></a>
          <a class="indexterm" name="id3547256"></a>

          <a class="indexterm" name="id3547268"></a>

          <a href="replication.html#sysvar_slave_compressed_protocol"><code class="option">--slave_compressed_protocol={0|1}</code></a>
        </p><p>
          If this option is set to 1, use compression for the
          slave/master protocol if both the slave and the master support
          it. The default is 0 (no compression).
        </p></li><li><p><a name="option_mysqld_slave-load-tmpdir"></a>
          <a class="indexterm" name="id3547304"></a>

          <a class="indexterm" name="id3547317"></a>

          <a href="replication.html#option_mysqld_slave-load-tmpdir"><code class="option">--slave-load-tmpdir=<em class="replaceable"><code>file_name</code></em></code></a>
        </p><p>
          The name of the directory where the slave creates temporary
          files. This option is by default equal to the value of the
          <code class="literal">tmpdir</code> system variable. When the slave SQL
          thread replicates a
          <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> statement, it extracts the file to be loaded
          from the relay log into temporary files, and then loads these
          into the table. If the file loaded on the master is huge, the
          temporary files on the slave are huge, too. Therefore, it
          might be advisable to use this option to tell the slave to put
          temporary files in a directory located in some file system
          that has a lot of available space. In that case, the relay
          logs are huge as well, so you might also want to use the
          <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> option to place the
          relay logs in that file system.
        </p><p>
          The directory specified by this option should be located in a
          disk-based file system (not a memory-based file system)
          because the temporary files used to replicate
          <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> must survive machine restarts. The directory
          also should not be one that is cleared by the operating system
          during the system startup process.
        </p></li><li><p><a name="option_mysqld_slave-net-timeout"></a>
          <a class="indexterm" name="id3547403"></a>

          <a class="indexterm" name="id3547416"></a>

          <a href="replication.html#option_mysqld_slave-net-timeout"><code class="option">--slave-net-timeout=<em class="replaceable"><code>seconds</code></em></code></a>
        </p><p>
          The number of seconds to wait for more data from the master
          before the slave considers the connection broken, aborts the
          read, and tries to reconnect. The first retry occurs
          immediately after the timeout. The interval between retries is
          controlled by the <code class="literal">MASTER_CONNECT_RETRY</code>
          option for the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
          statement, and the number of reconnection attempts is limited
          by the <a href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a>
          option. The default is 3600 seconds (one hour).
        </p></li><li><p><a name="option_mysqld_slave-skip-errors"></a>
          <a class="indexterm" name="id3547480"></a>

          <a class="indexterm" name="id3547493"></a>

          <a href="replication.html#option_mysqld_slave-skip-errors"><code class="option">--slave-skip-errors=[<em class="replaceable"><code>err_code1</code></em>,<em class="replaceable"><code>err_code2</code></em>,...|all]</code></a>
        </p><p>
          Normally, replication stops when an error occurs on the slave.
          This gives you the opportunity to resolve the inconsistency in
          the data manually. This option tells the slave SQL thread to
          continue replication when a statement returns any of the
          errors listed in the option value.
        </p><p>
          Do not use this option unless you fully understand why you are
          getting errors. If there are no bugs in your replication setup
          and client programs, and no bugs in MySQL itself, an error
          that stops replication should never occur. Indiscriminate use
          of this option results in slaves becoming hopelessly out of
          synchrony with the master, with you having no idea why this
          has occurred.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Prior to MySQL 6.0.12, this option had no effect with
            row-based logging. (<a href="http://bugs.mysql.com/39393" target="_top">Bug#39393</a>)
          </p></div><p>
          For error codes, you should use the numbers provided by the
          error message in your slave error log and in the output of
          <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
          <a href="error-handling.html" title="Appendix B. Errors, Error Codes, and Common Problems">Appendix B, <i>Errors, Error Codes, and Common Problems</i></a>, lists server error codes.
        </p><p>
          You can also (but should not) use the very non-recommended
          value of <code class="literal">all</code> to cause the slave to ignore
          all error messages and keeps going regardless of what happens.
          Needless to say, if you use <code class="literal">all</code>, there are
          no guarantees regarding the integrity of your data. Please do
          not complain (or file bug reports) in this case if the slave's
          data is not anywhere close to what it is on the master.
          <span class="emphasis"><em>You have been warned</em></span>.
        </p><p>
          Examples:
        </p><pre class="programlisting">--slave-skip-errors=1062,1053
--slave-skip-errors=all
</pre></li><li><p><a name="option_mysqld_sql_slave_skip_counter"></a>
          <a class="indexterm" name="id3547619"></a>

          <a class="indexterm" name="id3547629"></a>

          <code class="literal">sql_slave_skip_counter</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">sql_slave_skip_counter</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The number of events from the master that a slave server
          should skip.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            If skipping the number of events specified by setting this
            variable would cause the slave to begin in the middle of an
            event group, the slave continues to skip until it finds the
            beginning of the next event group and begins from that
            point. See
            <a href="sql-syntax.html#set-global-sql-slave-skip-counter" title="12.6.2.4. SET GLOBAL SQL_SLAVE_SKIP_COUNTER Syntax">Section 12.6.2.4, “<code class="literal">SET GLOBAL SQL_SLAVE_SKIP_COUNTER</code> Syntax”</a>, for
            more information.
          </p></div></li><li><p><a name="option_mysqld_abort-slave-event-count"></a>
          

          <a class="indexterm" name="id3547765"></a>

          <a class="indexterm" name="id3547778"></a>

          <a href="replication.html#option_mysqld_abort-slave-event-count"><code class="option">--abort-slave-event-count</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--abort-slave-event-count=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">abort-slave-event-count</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Min Value</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          When this option is set to some positive integer
          <em class="replaceable"><code>value</code></em> other than 0 (the default) it
          affects replication behavior as follows: After the slave SQL
          thread has started, <em class="replaceable"><code>value</code></em> log
          events are allowed to be executed; after that, the slave SQL
          thread does not receive any more events, just as if the
          network connection from the master were cut. The slave thread
          continues to run, and the output from
          <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> displays
          <code class="literal">Yes</code> in both the
          <code class="literal">Slave_IO_Running</code> and the
          <code class="literal">Slave_SQL_Running</code> columns, but no further
          events are read from the relay log.
        </p><p>
          This option is used internally by the MySQL test suite for
          replication testing and debugging. It is not intended for use
          in a production setting.
        </p></li><li><p><a name="option_mysqld_disconnect-slave-event-count"></a>
          <a class="indexterm" name="id3547957"></a>

          <a class="indexterm" name="id3547970"></a>

          <a href="replication.html#option_mysqld_disconnect-slave-event-count"><code class="option">--disconnect-slave-event-count</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--disconnect-slave-event-count=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">disconnect-slave-event-count</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This option is used internally by the MySQL test suite for
          replication testing and debugging.
        </p></li></ul></div><p><a name="replication-optvars-slaves-obsolete"></a><b>Obsolete options. </b>
        <span class="emphasis"><em>The following options are removed in MySQL 6.0. If you
        attempt to start <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> with any of these
        options in MySQL 6.0, the server aborts with an
        <span class="errortext">unknown variable</span> error</em></span>. To set
        the replication parameters formerly associated with these
        options, you must use the <code class="literal">CHANGE MASTER TO
        ...</code> statement (see
        <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>).
      </p><p>
      The options affected are shown in this list:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="option">--master-host</code>
          </p></li><li><p>
            <code class="option">--master-user</code>
          </p></li><li><p>
            <code class="option">--master-password</code>
          </p></li><li><p>
            <code class="option">--master-port</code>
          </p></li><li><p>
            <code class="option">--master-connect-retry</code>
          </p></li><li><p>
            <code class="option">--master-ssl</code>
          </p></li><li><p>
            <code class="option">--master-ssl-ca</code>
          </p></li><li><p>
            <code class="option">--master-ssl-capath</code>
          </p></li><li><p>
            <code class="option">--master-ssl-cert</code>
          </p></li><li><p>
            <code class="option">--master-ssl-cipher</code>
          </p></li><li><p>
            <code class="option">--master-ssl-key</code>
          </p></li></ul></div><p>
    </p><p><a name="replication-sysvars-slaves"></a><b>System variables used on replication slaves. </b>
        The following system variables are used for controlling
        replication slave servers. Those that can be set are specified
        using <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET</code></a>.
        Server options used with replication slaves are listed earlier
        in this section.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="sysvar_init_slave"></a>
          <a class="indexterm" name="id3548277"></a>

          <a class="indexterm" name="id3548287"></a>

          <a href="replication.html#sysvar_init_slave"><code class="literal">init_slave</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--init-slave=name</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">init_slave</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_init_slave"><code class="literal">init_slave</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">init_slave</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">string</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This variable is similar to
          <a href="server-administration.html#sysvar_init_connect"><code class="literal">init_connect</code></a>, but is a string
          to be executed by a slave server each time the SQL thread
          starts. The format of the string is the same as for the
          <a href="server-administration.html#sysvar_init_connect"><code class="literal">init_connect</code></a> variable.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            The SQL thread sends an acknowledgement to the client before
            <a href="replication.html#sysvar_init_slave"><code class="literal">init_slave</code></a> is executed.
            Therefore, it is not guaranteed that
            <a href="replication.html#sysvar_init_slave"><code class="literal">init_slave</code></a> has been
            executed when <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a>
            returns. See <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax">Section 12.6.2.5, “<code class="literal">START SLAVE</code> Syntax”</a>, for more
            information.
          </p></div></li><li><p><a name="sysvar_rpl_recovery_rank"></a>
          <a href="replication.html#sysvar_rpl_recovery_rank"><code class="literal">rpl_recovery_rank</code></a>
        </p><p>
          This variable is unused.
        </p></li><li><p><a name="sysvar_relay_log_recovery"></a>
          <a class="indexterm" name="id3548515"></a>

          <a class="indexterm" name="id3548528"></a>

          <code class="literal">relay_log_recovery</code>
        </p><p>
          Enables automatic relay log recovery immediately following
          server startup, which means that the replication slave
          discards all unprocessed relay logs and retrieves them from
          the replication master. This should be used following a crash
          on the replication slave to insure that no possibly corrupted
          relay logs are processed. The default value is 0 (disabled).
          This global variable can be changed dynamically, or by
          starting the slave with the
          <code class="option">--relay-log-recovery</code> option.
        </p></li><li><p><a name="sysvar_sync_master_info"></a>
          <a class="indexterm" name="id3548568"></a>

          <a class="indexterm" name="id3548578"></a>

          <a href="replication.html#sysvar_sync_master_info"><code class="literal">sync_master_info</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>6.0.11</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--sync-master-info=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">sync-master-info</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">sync_master_info</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set (&gt;= 6.0.11)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If the value of this variable is greater than 0, a replication
          slave synchronizes its <code class="filename">master.info</code> file
          to disk (using <code class="literal">fdatasync()</code>) after every
          <a href="replication.html#sysvar_sync_master_info"><code class="literal">sync_master_info</code></a>
          transactions. The default value of
          <a href="replication.html#sysvar_sync_relay_log_info"><code class="literal">sync_relay_log_info</code></a> is 0
          (recommended in most situations), which does not force any
          synchronization to disk by the MySQL server — in this
          case, the server relies on the operating system to flush the
          <code class="filename">master.info</code> file's contents from
          time to time as for any other file.
        </p><p>
          This variable was introduced in MySQL 6.0.11.
        </p></li><li><p><a name="sysvar_sync_relay_log"></a>
          <a class="indexterm" name="id3548816"></a>

          <a class="indexterm" name="id3548825"></a>

          <a href="replication.html#sysvar_sync_relay_log"><code class="literal">sync_relay_log</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>6.0.10</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--sync-relay-log=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">sync-relay-log</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">sync_relay_log</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set (&gt;= 6.0.10)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If the value of this variable is greater than 0, the MySQL
          server synchronizes its relay log to disk (using
          <code class="literal">fdatasync()</code>) after every
          <a href="replication.html#sysvar_sync_relay_log"><code class="literal">sync_relay_log</code></a> writes to the
          relay log. There is one write to the relay log per statement
          if autocommit is enabled, and one write per transaction
          otherwise. The default value of
          <a href="replication.html#sysvar_sync_relay_log"><code class="literal">sync_relay_log</code></a> is 0, which
          does no synchronizing to disk — in this case, the server
          relies on the operating system to flush the relay log's
          contents from time to time as for any other file. A value of 1
          is the safest choice, because in the event of a crash you lose
          at most one statement or transaction from the relay log.
          However, it is also the slowest choice (unless the disk has a
          battery-backed cache, which makes synchronization very fast).
        </p><p>
          This variable was introduced in MySQL 6.0.10.
        </p></li><li><p><a name="sysvar_sync_relay_log_info"></a>
          <a class="indexterm" name="id3549057"></a>

          <a class="indexterm" name="id3549066"></a>

          <a href="replication.html#sysvar_sync_relay_log_info"><code class="literal">sync_relay_log_info</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>6.0.11</td></tr><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--sync-relay-log-info=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">sync-relay-log-info</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">sync_relay_log_info</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set (&gt;= 6.0.11)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If the value of this variable is greater than 0, a replication
          slave synchronizes its <code class="filename">relay-log.info</code>
          file to disk (using <code class="literal">fdatasync()</code>) after
          every <a href="replication.html#sysvar_sync_relay_log_info"><code class="literal">sync_relay_log_info</code></a>
          transactions. A value of 1 is the generally the best choice.
          The default value of
          <a href="replication.html#sysvar_sync_relay_log_info"><code class="literal">sync_relay_log_info</code></a> is 0,
          which does not force any synchronization to disk by the MySQL
          server — in this case, the server relies on the
          operating system to flush the
          <code class="filename">relay-log.info</code> file's contents from
          time to time as for any other file.
        </p><p>
          This variable was introduced in MySQL 6.0.11.
        </p></li><li><p><a name="sysvar_slave_compressed_protocol"></a>
          <a class="indexterm" name="id3549304"></a>

          <a class="indexterm" name="id3549314"></a>

          <a href="replication.html#sysvar_slave_compressed_protocol"><code class="literal">slave_compressed_protocol</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--slave_compressed_protocol</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">slave_compressed_protocol</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_slave_compressed_protocol"><code class="literal">slave_compressed_protocol</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_compressed_protocol</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Whether to use compression of the slave/master protocol if
          both the slave and the master support it.
        </p></li><li><p><a name="option_mysqld_slave_exec_mode"></a>
          <a class="indexterm" name="id3549485"></a>

          <a class="indexterm" name="id3549494"></a>

          <code class="literal">slave_exec_mode</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>6.0.5</td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_exec_mode</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">enumeration</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">STRICT</code></td></tr><tr><td><span class="bold"><strong>Valid Values</strong></span></td><td><code class="literal">IDEMPOTENT</code>, <code class="literal">STRICT</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Controls whether <code class="literal">IDEMPOTENT</code> or
          <code class="literal">STRICT</code> mode is used in replication conflict
          resolution and error checking. <code class="literal">IDEMPOTENT</code>
          mode causes suppression of some errors, including
          duplicate-key and no-key-found errors. Beginning with MySQL
          6.0.5, this mode should be employed in multi-master
          replication, circular replication, and some other special
          replication scenarios. <code class="literal">STRICT</code> mode is the
          default, and is suitable for most other cases.
        </p></li><li><p><a name="sysvar_slave_load_tmpdir"></a>
          <a class="indexterm" name="id3549678"></a>

          <a class="indexterm" name="id3549688"></a>

          <a href="replication.html#sysvar_slave_load_tmpdir"><code class="literal">slave_load_tmpdir</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--slave-load-tmpdir=name</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">slave-load-tmpdir</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_slave_load_tmpdir"><code class="literal">slave_load_tmpdir</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_load_tmpdir</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">filename</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">/tmp</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The name of the directory where the slave creates temporary
          files for replicating
          <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> statements.
        </p></li><li><p><a name="option_mysqld_slave_net_timeout"></a>
          <a class="indexterm" name="id3549865"></a>

          <a class="indexterm" name="id3549874"></a>

          <code class="literal">slave_net_timeout</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--slave-net-timeout=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">slave-net-timeout</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_net_timeout" target="_top"><code class="literal">slave_net_timeout</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_net_timeout</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">3600</code></td></tr><tr><td><span class="bold"><strong>Min Value</strong></span></td><td><code class="literal">1</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The number of seconds to wait for more data from a
          master/slave connection before aborting the read. This timeout
          applies only to TCP/IP connections, not to connections made
          via Unix socket files, named pipes, or shared memory.
        </p></li><li><p><a name="sysvar_slave_skip_errors"></a>
          <a class="indexterm" name="id3550060"></a>

          <a class="indexterm" name="id3550070"></a>

          <code class="literal">slave_skip_errors</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--slave-skip-errors=name</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">slave-skip-errors</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_slave_skip_errors"><code class="literal">slave_skip_errors</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_skip_errors</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr></tbody></table></div><p>
          Normally, replication stops when an error occurs on the slave.
          This gives you the opportunity to resolve the inconsistency in
          the data manually. This variable tells the slave SQL thread to
          continue replication when a statement returns any of the
          errors listed in the variable value.
        </p></li><li><p><a name="option_mysqld_slave_transaction_retries"></a>
          <a class="indexterm" name="id3550209"></a>

          <a class="indexterm" name="id3550218"></a>

          <code class="literal">slave_transaction_retries</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--slave_transaction_retries=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">slave_transaction_retries</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_transaction_retries" target="_top"><code class="literal">slave_transaction_retries</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">slave_transaction_retries</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">10</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4294967295</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">10</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If a replication slave SQL thread fails to execute a
          transaction because of an <code class="literal">InnoDB</code>
          deadlock or because the transaction's execution time
          exceeded <code class="literal">InnoDB</code>'s
          <a href="storage-engines.html#sysvar_innodb_lock_wait_timeout"><code class="literal">innodb_lock_wait_timeout</code></a>, it
          automatically retries
          <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_transaction_retries" target="_top"><code class="literal">slave_transaction_retries</code></a>
          times before stopping with an error. The default value is 10.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-options-binary-log"></a>16.1.3.4. Binary Log Options and Variables</h4></div></div></div><p>
      You can use the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> options and system
      variables that are described in this section to affect the
      operation of the binary log as well as to control which statements
      are written to the binary log. For additional information about
      the binary log, see <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>. For additional
      information about using MySQL server options and system variables,
      see <a href="server-administration.html#server-options" title="5.1.2. Server Command Options">Section 5.1.2, “Server Command Options”</a>, and
      <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>.
    </p><p><a name="replication-optvars-binlog"></a><b>Startup options used with binary logging. </b>
        The following list describes startup options for for enabling
        and configuring the binary log. Many of these options can be
        reset while the server is running by using the
        <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement.
        Others, can be set only when the slave server starts. System
        variables used with binary logging are discussed later in this
        section.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_binlog-row-event-max-size"></a>
          <a class="indexterm" name="id3550589"></a>

          <a class="indexterm" name="id3550602"></a>

          <a href="replication.html#option_mysqld_binlog-row-event-max-size"><code class="option">--binlog-row-event-max-size=<em class="replaceable"><code>N</code></em></code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--binlog-row-event-max-size=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">binlog-row-event-max-size</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1024</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">256-4294967295</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1024</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">256-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Specify the maximum size of a row-based binary log event, in
          bytes. Rows are grouped into events smaller than this size if
          possible. The value should be a multiple of 256. The default
          is 1024. See <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
        </p></li><li><p><a name="option_mysqld_log-bin"></a>
          <a class="indexterm" name="id3550824"></a>

          <a class="indexterm" name="id3550837"></a>

          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin[=<em class="replaceable"><code>base_name</code></em>]</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--log-bin</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">log-bin</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">log_bin</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">filename</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">OFF</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Enable binary logging. The server logs all statements that
          change data to the binary log, which is used for backup and
          replication. See <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>.
        </p><p>
          The option value, if given, is the basename for the log
          sequence. The server creates binary log files in sequence by
          adding a numeric suffix to the basename. It is recommended
          that you specify a basename (see
          <a href="http://dev.mysql.com/doc/refman/5.1/en/bugs.html#open-bugs-general" target="_top">Additional Known Issues</a>, for the reason).
          Otherwise, MySQL uses
          <code class="filename"><em class="replaceable"><code>host_name</code></em>-bin</code>
          as the basename.
        </p></li><li><p><a name="option_mysqld_log-bin-index"></a>
          <a class="indexterm" name="id3551023"></a>

          <a class="indexterm" name="id3551035"></a>

          <a href="replication.html#option_mysqld_log-bin-index"><code class="option">--log-bin-index[=<em class="replaceable"><code>file_name</code></em>]</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--log-bin-index=name</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">log-bin-index</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">filename</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">OFF</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The index file for binary log file names. See
          <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>. If you omit the file name, and
          if you didn't specify one with
          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a>, MySQL uses
          <code class="filename"><em class="replaceable"><code>host_name</code></em>-bin.index</code>
          as the file name.
        </p></li><li><p><b>Statement selection options. </b>
            The options in the following list affect which statements
            are written to the binary log, and thus sent by a
            replication master server to its slaves.
          </p><div class="itemizedlist"><ul type="circle"><li><p><a name="option_mysqld_binlog-do-db"></a>
              <a class="indexterm" name="id3551197"></a>

              <a class="indexterm" name="id3551209"></a>

              <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db=<em class="replaceable"><code>db_name</code></em></code></a>
            </p><p>
              This option affects binary logging in the same manner that
              <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> affects
              replication.
            </p><p>
              The effects of this option depend on whether the
              statement-based or row-based logging format is in use, in
              the same way that the effects of
              <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> depend on
              whether statement-based or row-based replication is in
              use.
            </p><p><b>Statement-based logging. </b>
                Only those statements where the default database (that
                is, the one selected by
                <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a>) is
                <em class="replaceable"><code>db_name</code></em> are written to the
                binary log. To specify more than one database, use this
                option multiple times, once for each database; however,
                doing so does <span class="emphasis"><em>not</em></span> cause
                cross-database statements such as <code class="literal">UPDATE
                <em class="replaceable"><code>some_db.some_table</code></em> SET
                foo='bar'</code> to be logged while a different
                database (or no database) is selected.
              </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
                To specify multiple databases you
                <span class="emphasis"><em>must</em></span> use multiple instances of this
                option. Because database names can contain commas, if
                you supply a comma separated list then the list will be
                treated as the name of a single database.
              </p></div><p>
              An example of what does not work as you might expect when
              using statement-based logging: If the server is started
              with <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db=sales</code></a>
              and you issue the following statements, the
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement is
              <span class="emphasis"><em>not</em></span> logged:

</p><pre class="programlisting">USE prices;
UPDATE sales.january SET amount=amount+1000;
</pre><p>

              The main reason for this “<span class="quote">just check the default
              database</span>” behavior is that it is difficult from the
              statement alone to know whether it should be replicated
              (for example, if you are using multiple-table
              <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statements or
              multiple-table <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
              statements that act across multiple databases). It is also
              faster to check only the default database rather than all
              databases if there is no need.
            </p><p><b>Row-based logging. </b>
                Logging is restricted to database
                <em class="replaceable"><code>db_name</code></em>. Only changes to
                tables belonging to <em class="replaceable"><code>db_name</code></em>
                are logged; the current database has no effect on this.
                For example, suppose that the server is started with
                <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db=sales</code></a>
                and row-based logging is in effect, and then the
                following statements are executed:

</p><pre class="programlisting">USE prices;
UPDATE sales.february SET amount=amount+100;
</pre><p>

                The <code class="literal">february</code> table in the
                <code class="literal">sales</code> database is changed in
                accordance with the
                <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement; this
                occurs whether or not the
                <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a> statement was issued.
                However, the following statements are not logged when
                using the row-based logging format and
                <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db=sales</code></a>:

</p><pre class="programlisting">USE prices;
UPDATE prices.march SET amount=amount-25;
</pre><p>

                Even if the statement <code class="literal">USE prices</code> were
                changed to <code class="literal">USE sales</code>, the
                <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement's
                effects would still not be written to the binary log.
              </p><p>
              Another important difference in how
              <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a> is handled
              when using the statement-based logging format as opposed
              to the row-based format occurs with regard to statements
              that refer to multiple databases. Suppose the server is
              started with
              <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db=db1</code></a>, and the
              following statements are executed:

</p><pre class="programlisting">USE db1;
UPDATE db1.table1 SET col1 = 10, db2.table2 SET col2 = 20;
</pre><p>

              If you are using statement-based logging, then the updates
              to both tables are written to the binary log. However,
              when using the row-based format, only the changes to
              <code class="literal">table1</code> logged; since
              <code class="literal">table2</code> is in a different database, it
              is not changed by the
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>. Now suppose that,
              instead of the <code class="literal">USE db1</code> statement, a
              <code class="literal">USE db4</code> statement had been used:

</p><pre class="programlisting">USE db4;
UPDATE db1.table1 SET col1 = 10, db2.table2 SET col2 = 20;
</pre><p>

              In this case, the <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
              statement would not be written to the binary log when
              using statement-based logging. However, if using row-based
              logging, the <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> would
              change <code class="literal">table1</code>, but not
              <code class="literal">table2</code> — in other words, only
              tables in the database named by
              <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a> are changed,
              and the choice of current database has no effect on this
              behavior.
            </p></li><li><p><a name="option_mysqld_binlog-ignore-db"></a>
              <a class="indexterm" name="id3551610"></a>

              <a class="indexterm" name="id3551623"></a>

              <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db=<em class="replaceable"><code>db_name</code></em></code></a>
            </p><p>
              This option affects binary logging in the same manner that
              <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
              affects replication.
            </p><p>
              The effects of this option depend on whether the
              statement-based or row-based logging format is in use, in
              the same way that the effects of
              <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
              depend on whether statement-based or row-based replication
              is in use.
            </p><p><b>Statement-based logging. </b>
                Tells the server to not log any statement where the
                default database (that is, the one selected by
                <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a>) is
                <em class="replaceable"><code>db_name</code></em>.
              </p><p><b>Row-based format. </b>
                Tells the server not to log updates to any tables in the
                database <em class="replaceable"><code>db_name</code></em>. The current
                database has no effect.
              </p><p>
              When using statement-based logging, the following example
              does not work as you might expect. Suppose that the server
              is started with
              <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db=sales</code></a>
              and you issue the following statements:

</p><pre class="programlisting">USE prices;
UPDATE sales.january SET amount=amount+1000;
</pre><p>

              The <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement
              <span class="emphasis"><em>is</em></span> logged in such a case because
              <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a> applies
              only to the default database (determined by the
              <a href="sql-syntax.html#use" title="12.3.4. USE Syntax"><code class="literal">USE</code></a> statement). Because the
              <code class="literal">sales</code> database was specified explicitly
              in the statement, the statement has not been filtered.
              However, when using row-based logging, the
              <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement's
              effects are <span class="emphasis"><em>not</em></span> written to the binary
              log, which means that no changes to the
              <code class="literal">sales.january</code> table are logged; in this
              instance,
              <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db=sales</code></a>
              causes <span class="emphasis"><em>all</em></span> changes made to tables in
              the master's copy of the <code class="literal">sales</code>
              database to be ignored for purposes of binary logging.
            </p><p>
              To specify more than one database to ignore, use this
              option multiple times, once for each database. Because
              database names can contain commas, if you supply a comma
              separated list then the list will be treated as the name
              of a single database.
            </p><p>
              You should not use this option if you are using
              cross-database updates and you do not want these updates
              to be logged.
            </p></li></ul></div><p>
          Additional server options that can be used to control logging
          also affect the binary log. For more information about these,
          see <a href="server-administration.html#server-options" title="5.1.2. Server Command Options">Section 5.1.2, “Server Command Options”</a>. For more information
          about how the options in the previous list are applied, see
          <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>.
        </p><p>
          There are also options for slave servers that control which
          statements received from the master should be executed or
          ignored. For details, see
          <a href="replication.html#replication-options-slave" title="16.1.3.3. Replication Slave Options and Variables">Section 16.1.3.3, “Replication Slave Options and Variables”</a>.
        </p></li><li><p><a name="option_mysqld_log-bin-trust-function-creators"></a>
          <a class="indexterm" name="id3551872"></a>

          <a class="indexterm" name="id3551885"></a>

          <a href="replication.html#option_mysqld_log-bin-trust-function-creators"><code class="option">--log-bin-trust-function-creators[={0|1}]</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--log-bin-trust-function-creators</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">log-bin-trust-function-creators</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="server-administration.html#sysvar_log_bin_trust_function_creators"><code class="literal">log_bin_trust_function_creators</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">log_bin_trust_function_creators</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          With no argument or an argument of 1, this option sets the
          <a href="server-administration.html#sysvar_log_bin_trust_function_creators"><code class="literal">log_bin_trust_function_creators</code></a>
          system variable to 1. With an argument of 0, this option sets
          the system variable to 0.
          <a href="server-administration.html#sysvar_log_bin_trust_function_creators"><code class="literal">log_bin_trust_function_creators</code></a>
          affects how MySQL enforces restrictions on stored function and
          trigger creation. See
          <a href="stored-programs-views.html#stored-programs-logging" title="18.6. Binary Logging of Stored Programs">Section 18.6, “Binary Logging of Stored Programs”</a>.
        </p></li></ul></div><p><b>Testing and debugging options. </b>
        The following binary log options are used in replication testing
        and debugging. They are not intended for use in normal
        operations.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_max-binlog-dump-events"></a>
          <a class="indexterm" name="id3552105"></a>

          <a class="indexterm" name="id3552118"></a>

          <a href="replication.html#option_mysqld_max-binlog-dump-events"><code class="option">--max-binlog-dump-events</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--max-binlog-dump-events=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">max-binlog-dump-events</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This option is used internally by the MySQL test suite for
          replication testing and debugging.
        </p></li><li><p><a name="option_mysqld_sporadic-binlog-dump-fail"></a>
          <a class="indexterm" name="id3552237"></a>

          <a class="indexterm" name="id3552250"></a>

          <a href="replication.html#option_mysqld_sporadic-binlog-dump-fail"><code class="option">--sporadic-binlog-dump-fail</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--sporadic-binlog-dump-fail</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">sporadic-binlog-dump-fail</code></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">boolean</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">FALSE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This option is used internally by the MySQL test suite for
          replication testing and debugging.
        </p></li></ul></div><p><a name="replication-sysvars-binlog"></a><b>System variables used with the binary log. </b>
        The following system variables are used for controlling
        replication slave servers. Those that can be set are specified
        using <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET</code></a>.
        Server options used with replication slaves are listed earlier
        in this section.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="sysvar_binlog_cache_size"></a>
          <a class="indexterm" name="id3552397"></a>

          <a class="indexterm" name="id3552406"></a>

          <a href="replication.html#sysvar_binlog_cache_size"><code class="literal">binlog_cache_size</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--binlog_cache_size=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">binlog_cache_size</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_binlog_cache_size"><code class="literal">binlog_cache_size</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">binlog_cache_size</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32768</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">4096-4294967295</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32768</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">4096-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The size of the cache to hold the SQL statements for the
          binary log during a transaction. A binary log cache is
          allocated for each client if the server supports any
          transactional storage engines and if the server has the binary
          log enabled (<a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> option).
          If you often use large, multiple-statement transactions, you
          can increase this cache size to get more performance. The
          <a href="server-administration.html#statvar_Binlog_cache_use"><code class="literal">Binlog_cache_use</code></a> and
          <a href="server-administration.html#statvar_Binlog_cache_disk_use"><code class="literal">Binlog_cache_disk_use</code></a> status
          variables can be useful for tuning the size of this variable.
          See <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>.
        </p><p class="mnmas"><b>MySQL Enterprise</b>
            For recommendations on the optimum setting for
            <a href="replication.html#sysvar_binlog_cache_size"><code class="literal">binlog_cache_size</code></a> subscribe
            to the MySQL Enterprise Monitor. For more information, see
            <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
          </p></li><li><p><a name="sysvar_binlog_format"></a>
          <a class="indexterm" name="id3552732"></a>

          <a class="indexterm" name="id3552742"></a>

          <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--binlog-format</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">binlog-format</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">binlog_format</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">enumeration</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">STATEMENT</code></td></tr><tr><td><span class="bold"><strong>Valid Values</strong></span></td><td><code class="literal">ROW</code>, <code class="literal">STATEMENT</code>, <code class="literal">MIXED</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This variable sets the binary logging format, and can be any
          one of <code class="literal">STATEMENT</code>, <code class="literal">ROW</code>,
          or <code class="literal">MIXED</code>.
          <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> is set by the
          <a href="server-administration.html#option_mysqld_binlog-format"><code class="option">--binlog-format</code></a> option at
          startup, or by the
          <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> variable at
          runtime.
        </p><p>
          You must have the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a>
          privilege to set this variable, which (unlike with most system
          variables) is true as of MySQL 6.0.8 even for the session
          value. See <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
        </p><p>
          The rules governing when changing this variable takes effect
          and how long the effect lasts are the same as for other MySQL
          server system variables. See <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax">Section 12.5.5, “<code class="literal">SET</code> Syntax”</a>, for
          more information.
        </p><p>
          <code class="literal">MIXED</code> is used by default before MySQL
          6.0.8; <code class="literal">STATEMENT</code> is the default beginning
          with MySQL 6.0.8.
        </p><p>
          If <code class="literal">MIXED</code> is specified, statement-based
          replication is used except for cases where only row-based
          replication is guaranteed to lead to proper results. For
          example, this happens when statements contain user-defined
          functions (UDF) or the <a href="functions.html#function_uuid"><code class="literal">UUID()</code></a>
          function. An exception to this rule is that
          <code class="literal">MIXED</code> always uses statement-based
          replication for stored functions and triggers.
        </p><p>
          There are exceptions when you cannot switch the replication
          format at runtime:

          </p><div class="itemizedlist"><ul type="circle"><li><p>
                From within a stored function or a trigger.
              </p></li><li><p>
                If the session is currently in row-based replication
                mode and has open temporary tables.
              </p></li></ul></div><p>

          Trying to switch the format in those cases results in an
          error.
        </p><p>
          The binlog format affects the behavior of the following server
          options:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>
            </p></li><li><p>
              <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
            </p></li><li><p>
              <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a>
            </p></li><li><p>
              <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a>
            </p></li></ul></div><p>
          These effects are discussed in detail in the descriptions of
          the individual options.
        </p></li><li><p><a name="sysvar_max_binlog_cache_size"></a>
          <a class="indexterm" name="id3553149"></a>

          <a class="indexterm" name="id3553159"></a>

          <a href="replication.html#sysvar_max_binlog_cache_size"><code class="literal">max_binlog_cache_size</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--max_binlog_cache_size=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">max_binlog_cache_size</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_max_binlog_cache_size"><code class="literal">max_binlog_cache_size</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">max_binlog_cache_size</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">4294967295</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">4096-4294967295</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">18446744073709547520</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">4096-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If a multiple-statement transaction requires more than this
          many bytes of memory, the server generates a
          <span class="errortext">Multi-statement transaction required more than
          'max_binlog_cache_size' bytes of storage</span> error.
          The minimum value is 4096; the maximum and default values are
          4GB on 32-bit platforms and 16 PB (petabytes) on 64-bit
          platforms.
        </p></li><li><p><a name="sysvar_max_binlog_size"></a>
          <a class="indexterm" name="id3553432"></a>

          <a class="indexterm" name="id3553441"></a>

          <a href="replication.html#sysvar_max_binlog_size"><code class="literal">max_binlog_size</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--max_binlog_size=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">max_binlog_size</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_max_binlog_size"><code class="literal">max_binlog_size</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">max_binlog_size</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1073741824</code></td></tr><tr><td><span class="bold"><strong>Min Value</strong></span></td><td><code class="literal">4096</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If a write to the binary log causes the current log file size
          to exceed the value of this variable, the server rotates the
          binary logs (closes the current file and opens the next one).
          You cannot set this variable to more than 1GB or to less than
          4096 bytes. The default value is 1GB.
        </p><p>
          A transaction is written in one chunk to the binary log, so it
          is never split between several binary logs. Therefore, if you
          have big transactions, you might see binary logs larger than
          <a href="replication.html#sysvar_max_binlog_size"><code class="literal">max_binlog_size</code></a>.
        </p><p>
          If <a href="server-administration.html#sysvar_max_relay_log_size"><code class="literal">max_relay_log_size</code></a> is 0,
          the value of <a href="replication.html#sysvar_max_binlog_size"><code class="literal">max_binlog_size</code></a>
          applies to relay logs as well.
        </p></li><li><p><a name="sysvar_sync_binlog"></a>
          <a class="indexterm" name="id3553663"></a>

          <a class="indexterm" name="id3553672"></a>

          <a href="replication.html#sysvar_sync_binlog"><code class="literal">sync_binlog</code></a>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Command Line Format</strong></span></td><td><code class="literal">--sync-binlog=#</code></td></tr><tr><td><span class="bold"><strong>Config File Format</strong></span></td><td><code class="literal">sync-binlog</code></td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td>Yes, <a href="replication.html#sysvar_sync_binlog"><code class="literal">sync_binlog</code></a></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">sync_binlog</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-4294967295</code></td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Platform Bit Size</strong></span></td><td><code class="literal">64</code></td></tr><tr><td><span class="bold"><strong>Type</strong></span></td><td><code class="literal">numeric</code></td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td><code class="literal">0-18446744073709547520</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          If the value of this variable is greater than 0, the MySQL
          server synchronizes its binary log to disk (using
          <code class="literal">fdatasync()</code>) after every
          <a href="replication.html#sysvar_sync_binlog"><code class="literal">sync_binlog</code></a> writes to the
          binary log. There is one write to the binary log per statement
          if autocommit is enabled, and one write per transaction
          otherwise. The default value of
          <a href="replication.html#sysvar_sync_binlog"><code class="literal">sync_binlog</code></a> is 0, which does
          no synchronizing to disk — in this case, the server
          relies on the operating system to flush the binary log's
          contents from to time as for any other file. A value of 1 is
          the safest choice, because in the event of a crash you lose at
          most one statement or transaction from the binary log.
          However, it is also the slowest choice (unless the disk has a
          battery-backed cache, which makes synchronization very fast).
        </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-administration"></a>16.1.4. Common Replication Administration Tasks</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-administration-status">16.1.4.1. Checking Replication Status</a></span></dt><dt><span class="section"><a href="replication.html#replication-administration-pausing">16.1.4.2. Pausing Replication on the Slave</a></span></dt></dl></div><p>
      Once replication has been started it should execute without
      requiring much regular administration. Depending on your
      replication environment, you will want to check the replication
      status of each slave either periodically, daily, or even more
      frequently.
    </p><p class="mnmas"><b>MySQL Enterprise</b>
        For regular reports regarding the status of your slaves,
        subscribe to the MySQL Enterprise Monitor. For more information,
        see <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-administration-status"></a>16.1.4.1. Checking Replication Status</h4></div></div></div><p>
        The most common task when managing a replication process is to
        ensure that replication is taking place and that there have been
        no errors between the slave and the master.
      </p><p>
        The primary statement for this is <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW
        SLAVE STATUS</code></a> which you must execute on each slave:
      </p><pre class="programlisting">mysql&gt; SHOW SLAVE STATUS\G
*************************** 1. row ***************************
             Slave_IO_State: Waiting for master to send event
                Master_Host: master1
                Master_User: root
                Master_Port: 3306
              Connect_Retry: 60
            Master_Log_File: mysql-bin.000004
        Read_Master_Log_Pos: 931
             Relay_Log_File: slave1-relay-bin.000056
              Relay_Log_Pos: 950
      Relay_Master_Log_File: mysql-bin.000004
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
            Replicate_Do_DB: 
        Replicate_Ignore_DB: 
         Replicate_Do_Table: 
     Replicate_Ignore_Table: 
    Replicate_Wild_Do_Table: 
Replicate_Wild_Ignore_Table: 
                 Last_Errno: 0
                 Last_Error: 
               Skip_Counter: 0
        Exec_Master_Log_Pos: 931
            Relay_Log_Space: 1365
            Until_Condition: None
             Until_Log_File: 
              Until_Log_Pos: 0
         Master_SSL_Allowed: No
         Master_SSL_CA_File: 
         Master_SSL_CA_Path: 
            Master_SSL_Cert: 
          Master_SSL_Cipher: 
             Master_SSL_Key: 
      Seconds_Behind_Master: 0
1 row in set (0.01 sec)</pre><p>
        The key fields from the status report to examine are:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">Slave_IO_State</code> — indicates the
            current status of the slave. See
            <a href="optimization.html#slave-io-thread-states" title="7.5.6.5. Replication Slave I/O Thread States">Section 7.5.6.5, “Replication Slave I/O Thread States”</a>, and
            <a href="optimization.html#slave-sql-thread-states" title="7.5.6.6. Replication Slave SQL Thread States">Section 7.5.6.6, “Replication Slave SQL Thread States”</a>, for more
            information.
          </p></li><li><p>
            <code class="literal">Slave_IO_Running</code> — shows whether
            the IO thread for the reading the master's binary log is
            running.
          </p></li><li><p>
            <code class="literal">Slave_SQL_Running</code> — shows whether
            the SQL thread for the executing events in the relay log is
            running.
          </p></li><li><p>
            <code class="literal">Last_Error</code> — shows the last error
            registered when processing the relay log. Ideally this
            should be blank, indicating no errors.
          </p></li><li><p>
            <code class="literal">Seconds_Behind_Master</code> — shows the
            number of seconds that the slave SQL thread is behind
            processing the master binary log. A high number (or an
            increasing one) can indicate that the slave is unable to
            cope with the large number of statements from the master.
          </p><p>
            A value of 0 for <code class="literal">Seconds_Behind_Master</code>
            can usually be interpreted as meaning that the slave has
            caught up with the master, but there are some cases where
            this is not strictly true. For example, this can occur if
            the network connection between master and slave is broken
            but the slave I/O thread has not yet noticed this —
            that is, <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_net_timeout" target="_top"><code class="literal">slave_net_timeout</code></a>
            has not yet elapsed.
          </p><p>
            It is also possible that transient values for
            <code class="literal">Seconds_Behind_Master</code> may not reflect the
            situation accurately. When the slave SQL thread has caught
            up on I/O, <code class="literal">Seconds_Behind_Master</code> displays
            0; but when the slave I/O thread is still queuing up a new
            event, <code class="literal">Seconds_Behind_Master</code> may show a
            large value until the SQL thread finishes executing the new
            event. This is especially likely when the events have old
            timestamps; in such cases, if you execute
            <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> several
            times in a relatively short peiod, you may see this value
            change back and forth repeatedly between 0 and a relatively
            large value.
          </p></li></ul></div><p>
        On the master, you can check the status of slaves by examining
        the list of running processes. Slaves execute the
        <code class="literal">Binlog Dump</code> command:
      </p><pre class="programlisting">mysql&gt; SHOW PROCESSLIST \G;
*************************** 4. row ***************************
     Id: 10
   User: root
   Host: slave1:58371
     db: NULL
Command: Binlog Dump
   Time: 777
  State: Has sent all binlog to slave; waiting for binlog to be updated
   Info: NULL</pre><p>
        Because it is the slave that drives the core of the replication
        process, very little information is available in this report.
      </p><p>
        If you have used the <code class="literal">--report-host</code> option,
        then the <a href="sql-syntax.html#show-slave-hosts" title="12.5.6.33. SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a>
        statement will show basic information about connected slaves:
      </p><pre class="programlisting">mysql&gt; SHOW SLAVE HOSTS;
+-----------+--------+------+-------------------+-----------+
| Server_id | Host   | Port | Rpl_recovery_rank | Master_id |
+-----------+--------+------+-------------------+-----------+
|        10 | slave1 | 3306 |                 0 |         1 | 
+-----------+--------+------+-------------------+-----------+
1 row in set (0.00 sec)
</pre><p>
        The output includes the ID of the slave server, the value of the
        <code class="literal">--report-host</code> option, the connecting port,
        master ID and the priority of the slave for receiving binary log
        updates.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-administration-pausing"></a>16.1.4.2. Pausing Replication on the Slave</h4></div></div></div><p>
        You can stop and start the replication of statements on the
        slave using the <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> and
        <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statements.
      </p><p>
        To stop execution of the binary log from the master, use
        <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>:
      </p><pre class="programlisting">mysql&gt; STOP SLAVE;</pre><p>
        When execution is stopped, the slave does not read the binary
        log from the master (the <code class="literal">IO_THREAD</code>) and stops
        processing events from the relay log that have not yet been
        executed (the <code class="literal">SQL_THREAD</code>). You can pause
        either the IO or SQL threads individually by specifying the
        thread type. For example:
      </p><pre class="programlisting">mysql&gt; STOP SLAVE IO_THREAD;</pre><p>
        Stopping the SQL thread can be useful if you want to perform a
        backup or other task on a slave that only processes events from
        the master. The IO thread will continue to be read from the
        master, but not executed, which will make it easier for the
        slave to catch up when you start slave operations again.
      </p><p>
        Stopping the IO thread will allow the statements in the relay
        log to be executed up until the point where the relay log has
        ceased to receive new events. Using this option can be useful
        when you want to pause execution to allow the slave to catch up
        with events from the master, when you want to perform
        administration on the slave but also ensure you have the latest
        updates to a specific point. This method can also be used to
        pause execution on the slave while you conduct administration on
        the master while ensuring that there is not a massive backlog of
        events to be executed when replication is started again.
      </p><p>
        To start execution again, use the <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START
        SLAVE</code></a> statement:
      </p><pre class="programlisting">mysql&gt; START SLAVE;</pre><p>
        If necessary, you can start either the
        <code class="literal">IO_THREAD</code> or <code class="literal">SQL_THREAD</code>
        threads individually.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="replication-solutions"></a>16.2. Replication Solutions</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-solutions-backups">16.2.1. Using Replication for Backups</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-diffengines">16.2.2. Using Replication with Different Master and Slave Storage Engines</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-scaleout">16.2.3. Using Replication for Scale-Out</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-partitioning">16.2.4. Replicating Different Databases to Different Slaves</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-performance">16.2.5. Improving Replication Performance</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-switch">16.2.6. Switching Masters During Failover</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-multi-master-upgrade">16.2.7. Upgrading Multi-Master Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-ssl">16.2.8. Setting Up Replication Using SSL</a></span></dt><dt><span class="section"><a href="replication.html#replication-semisync">16.2.9. Semisynchronous Replication</a></span></dt></dl></div><p>
    Replication can be used in many different environments for a range
    of purposes. In this section you will find general notes and advice
    on using replication for specific solution types.
  </p><p>
    For information on using replication in a backup environment,
    including notes on the setup, backup procedure, and files to back
    up, see <a href="replication.html#replication-solutions-backups" title="16.2.1. Using Replication for Backups">Section 16.2.1, “Using Replication for Backups”</a>.
  </p><p>
    For advice and tips on using different storage engines on the master
    and slaves, see <a href="replication.html#replication-solutions-diffengines" title="16.2.2. Using Replication with Different Master and Slave Storage Engines">Section 16.2.2, “Using Replication with Different Master and Slave Storage Engines”</a>.
  </p><p>
    Using replication as a scale-out solution requires some changes in
    the logic and operation of applications that use the solution. See
    <a href="replication.html#replication-solutions-scaleout" title="16.2.3. Using Replication for Scale-Out">Section 16.2.3, “Using Replication for Scale-Out”</a>.
  </p><p>
    For performance or data distribution reasons you may want to
    replicate different databases to different replication slaves. See
    <a href="replication.html#replication-solutions-partitioning" title="16.2.4. Replicating Different Databases to Different Slaves">Section 16.2.4, “Replicating Different Databases to Different Slaves”</a>
  </p><p>
    As the number of replication slaves increases, the load on the
    master can increase (because of the need to replicate the binary log
    to each slave) and lead to a reduction in performance of the master.
    For tips on improving your replication performance, including using
    a single secondary server as an replication master, see
    <a href="replication.html#replication-solutions-performance" title="16.2.5. Improving Replication Performance">Section 16.2.5, “Improving Replication Performance”</a>.
  </p><p>
    For guidance on switching masters, or converting slaves into masters
    as part of an emergency failover solution, see
    <a href="replication.html#replication-solutions-switch" title="16.2.6. Switching Masters During Failover">Section 16.2.6, “Switching Masters During Failover”</a>.
  </p><p>
    To secure your replication communication you can encrypt the
    communication channel by using SSL to exchange data. Step-by-step
    instructions can be found in
    <a href="replication.html#replication-solutions-ssl" title="16.2.8. Setting Up Replication Using SSL">Section 16.2.8, “Setting Up Replication Using SSL”</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-backups"></a>16.2.1. Using Replication for Backups</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-solutions-backups-mysqldump">16.2.1.1. Backing Up a Slave Using <span><strong class="command">mysqldump</strong></span></a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-backups-rawdata">16.2.1.2. Backing Up Raw Data from a Slave</a></span></dt><dt><span class="section"><a href="replication.html#replication-solutions-backups-read-only">16.2.1.3. Backing Up a Master or Slave by Making It Read Only</a></span></dt></dl></div><p>
      You can use replication as a backup solution by replicating data
      from the master to a slave, and then backing up the data slave.
      Because the slave can be paused and shut down without affecting
      the running operation of the master you can produce an effective
      snapshot of 'live' data that would otherwise require a shutdown of
      the master database.
    </p><p>
      How you back up the database will depend on the size of the
      database and whether you are backing up only the data, or the data
      and the replication slave state so that you can rebuild the slave
      in the event of failure. There are therefore two choices:
    </p><p>
      If you are using replication as a solution to enable you to back
      up the data on the master, and the size of your database is not
      too large, then the <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> tool may be
      suitable. See
      <a href="replication.html#replication-solutions-backups-mysqldump" title="16.2.1.1. Backing Up a Slave Using mysqldump">Section 16.2.1.1, “Backing Up a Slave Using <span><strong class="command">mysqldump</strong></span>”</a>.
    </p><p>
      For larger databases, where <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> would be
      impractical or inefficient, you can back up the raw data files
      instead. Using the raw data files option also means that you can
      back up the binary and relay logs that will enable you to recreate
      the slave in the event of a slave failure. For more information,
      see <a href="replication.html#replication-solutions-backups-rawdata" title="16.2.1.2. Backing Up Raw Data from a Slave">Section 16.2.1.2, “Backing Up Raw Data from a Slave”</a>.
    </p><p>
      Another backup strategy, which can be used for either master or
      slave servers, is to put the server in a read-only state. The
      backup is performed against the read-only server, which then is
      changed back to its usual read/write operational status. See
      <a href="replication.html#replication-solutions-backups-read-only" title="16.2.1.3. Backing Up a Master or Slave by Making It Read Only">Section 16.2.1.3, “Backing Up a Master or Slave by Making It Read Only”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-solutions-backups-mysqldump"></a>16.2.1.1. Backing Up a Slave Using <span><strong class="command">mysqldump</strong></span></h4></div></div></div><p>
        Using <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to create a copy of the
        database enables you to capture all of the data in the database
        in a format that allows the information to be imported into
        another instance of MySQL. Because the format of the information
        is SQL statements the file can easily be distributed and applied
        to running servers in the event that you need access to the data
        in an emergency. However, if the size of your data set is very
        large then <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> may be impractical.
      </p><p>
        When using <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> you should stop the
        slave before starting the dump process to ensure that the dump
        contains a consistent set of data:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Stop the slave from processing requests. You can either stop
            the slave completely using <a href="programs.html#mysqladmin" title="4.5.2. mysqladmin — Client for Administering a MySQL Server"><span><strong class="command">mysqladmin</strong></span></a>:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqladmin stop-slave</code></strong></pre><p>
            Alternatively, you can stop processing the relay log files
            by stopping the replication SQL thread. Using this method
            will allow the binary log data to be transferred. Within
            busy replication environments this may speed up the catch-up
            process when you start the slave processing again:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql -e 'STOP SLAVE SQL_THREAD;'</code></strong></pre></li><li><p>
            Run <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to dump your databases. You
            may either select databases to be dumped, or dump all
            databases. For more information, see
            <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program">Section 4.5.4, “<span><strong class="command">mysqldump</strong></span> — A Database Backup Program”</a>. For example, to dump all
            databases:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqldump --all-databases &gt;fulldb.dump</code></strong></pre></li><li><p>
            Once the dump has completed, start slave operations again:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqladmin start-slave</code></strong></pre></li></ol></div><p>
        In the preceding example you may want to add login credentials
        (user name, password) to the commands, and bundle the process up
        into a script that you can run automatically each day.
      </p><p>
        If you use this approach, make sure you monitor the slave
        replication process to ensure that the time taken to run the
        backup in this way is not affecting the slave's ability to keep
        up with events from the master. See
        <a href="replication.html#replication-administration-status" title="16.1.4.1. Checking Replication Status">Section 16.1.4.1, “Checking Replication Status”</a>. If the
        slave is unable to keep up you may want to add another server
        and distribute the backup process. For an example of how to
        configure this scenario, see
        <a href="replication.html#replication-solutions-partitioning" title="16.2.4. Replicating Different Databases to Different Slaves">Section 16.2.4, “Replicating Different Databases to Different Slaves”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-solutions-backups-rawdata"></a>16.2.1.2. Backing Up Raw Data from a Slave</h4></div></div></div><p>
        To guarantee the integrity of the files that are copied, backing
        up the raw data files on your MySQL replication slave should
        take place while your slave server is shut down. If the MySQL
        server is still running then background tasks, particularly with
        storage engines with background processes such as InnoDB, may
        still be updating the database files. With InnoDB, these
        problems should be resolved during crash recovery, but since the
        slave server can be shut down during the backup process without
        affecting the execution of the master it makes sense to take
        advantage of this facility.
      </p><p>
        To shut down the server and back up the files:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Shut down the slave MySQL server:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqladmin shutdown</code></strong></pre></li><li><p>
            Copy the data files. You can use any suitable copying or
            archive utility, including <span><strong class="command">cp</strong></span>,
            <span><strong class="command">tar</strong></span> or <span><strong class="command">WinZip</strong></span>:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>tar cf /tmp/dbbackup.tar ./data</code></strong></pre></li><li><p>
            Start up the <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> process again:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld_safe &amp;</code></strong></pre><p>
            Under Windows:
          </p><pre class="programlisting">C:\&gt; <strong class="userinput"><code>"C:\Program Files\MySQL\MySQL Server 6.0\bin\mysqld"</code></strong></pre></li></ol></div><p>
        Normally you should back up the entire data folder for the slave
        MySQL server. If you want to be able to restore the data and
        operate as a slave (for example, in the event of failure of the
        slave), then when you back up the slave's data, you should back
        up the slave status files, <code class="filename">master.info</code> and
        <code class="filename">relay-log.info</code>, along with the relay log
        files. These files are needed to resume replication after you
        restore the slave's data.
      </p><p>
        If you lose the relay logs but still have the
        <code class="filename">relay-log.info</code> file, you can check it to
        determine how far the SQL thread has executed in the master
        binary logs. Then you can use <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> with the <code class="literal">MASTER_LOG_FILE</code> and
        <code class="literal">MASTER_LOG_POS</code> options to tell the slave to
        re-read the binary logs from that point. Of course, this
        requires that the binary logs still exist on the master server.
      </p><p>
        If your slave is subject to replicating
        <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> statements, you should also back up any
        <code class="filename">SQL_LOAD-*</code> files that exist in the
        directory that the slave uses for this purpose. The slave needs
        these files to resume replication of any interrupted
        <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> operations. The directory location is specified
        using the <a href="replication.html#option_mysqld_slave-load-tmpdir"><code class="option">--slave-load-tmpdir</code></a>
        option. If this option is not specified, the directory location
        is the value of the <code class="literal">tmpdir</code> system variable.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-solutions-backups-read-only"></a>16.2.1.3. Backing Up a Master or Slave by Making It Read Only</h4></div></div></div><p>
        It is possible to back up either master or slave servers in a
        replication setup by acquiring a global read lock and
        manipulating the <a href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a>
        system variable to change the read-only state of the server to
        be backed up:
      </p><div class="orderedlist"><ol type="1"><li><p>
            Make the server read-only, so that it processes only
            retrievals and blocks updates
          </p></li><li><p>
            Perform the backup
          </p></li><li><p>
            Change the server back to its normal read/write state
          </p></li></ol></div><p>
        The following instructions describe how to do this for a master
        server and for a slave server.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The instructions in this section place the server to be backed
          up in a state that is safe for backup methods that get the
          data from the server, such as <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>
          (see <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program">Section 4.5.4, “<span><strong class="command">mysqldump</strong></span> — A Database Backup Program”</a>). You should not attempt to
          use these instructions to make a binary backup by copying
          files directly because the server may still have modified data
          cached in memory and not flushed to disk.
        </p></div><p>
        For both scenarios discussed here, suppose that you have the
        following replication setup:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            A master server M1
          </p></li><li><p>
            A slave server S1 that has M1 as its master
          </p></li><li><p>
            A client C1 connected to M1
          </p></li><li><p>
            A client C2 connected to S1
          </p></li></ul></div><p>
        <span class="bold"><strong>Scenario 1: Backup with a Read-Only
        Master</strong></span>
      </p><p>
        Put the master M1 in a read-only state by executing these
        statements on it:
      </p><pre class="programlisting">FLUSH TABLES WITH READ LOCK;
SET GLOBAL read_only = ON;
</pre><p>
        While M1 is in a read-only state, the following properties are
        true:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Requests for updates sent by C1 to M1 will fail because the
            server is in read-only mode
          </p></li><li><p>
            Requests for retrievals sent by C1 to M1 will succeed
          </p></li><li><p>
            Making a backup on M1 is safe
          </p></li><li><p>
            Making a backup on S1 is not safe: this server is still
            running, and might be processing the binary log or update
            requests coming from client C2 (S1 might not be in a
            read-only state)
          </p></li></ul></div><p>
        While M1 is read only, perform the backup. For example, you can
        use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a>.
      </p><p>
        After the backup on M1 has been done, restore M1 to its normal
        operational state by executing these statements:
      </p><pre class="programlisting">SET GLOBAL read_only = OFF;
UNLOCK TABLES;
</pre><p>
        Although performing the backup on M1 is safe (as far as the
        backup is concerned), it is not optimal because clients of M1
        are blocked from executing updates.
      </p><p>
        This strategy also applies to backing up a single server in a
        non-replication setting.
      </p><p>
        <span class="bold"><strong>Scenario 2: Backup with a Read-Only
        Slave</strong></span>
      </p><p>
        Put the slave S1 in a read-only state by executing these
        statements on it:
      </p><pre class="programlisting">FLUSH TABLES WITH READ LOCK;
SET GLOBAL read_only = ON;
</pre><p>
        While S1 is in a read-only state, the following properties are
        true:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            The master M1 will continue to operate
          </p></li><li><p>
            Making a backup on the master is not safe
          </p></li><li><p>
            The slave S1 is stopped
          </p></li><li><p>
            Making a backup on the slave S1 is safe
          </p></li></ul></div><p>
        These properties provide the basis for a popular backup
        scenario: Having one slave busy performing a backup for a while
        is not a problem because it does not affect the entire network,
        and the system is still running during the backup. (For example,
        clients can still perform updates on the master server.)
      </p><p>
        While S1 is read only, perform the backup.
      </p><p>
        After the backup on S1 has been done, restore S1 to its normal
        operational state by executing these statements:
      </p><pre class="programlisting">SET GLOBAL read_only = OFF;
UNLOCK TABLES;
</pre><p>
        After the slave is restored to normal operation, it again
        synchronizes to the master by catching up with any outstanding
        updates in the binary log from the master.
      </p><p>
        In either scenario, the statements to acquire the global read
        lock and manipulate the
        <a href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> variable are
        performed on the server to be backed up and do not propagate to
        any slaves of that server.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-diffengines"></a>16.2.2. Using Replication with Different Master and Slave Storage Engines</h3></div></div></div><p>
      The replication process does not care if the source table on the
      master and the replicated table on the slave use different engine
      types. In fact, the system variable
      <a href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a> is not replicated.
    </p><p>
      This provides a number of advantages in the replication process in
      that you can take advantage of different engine types for
      different replication scenarios. For example, in a typical
      scaleout scenario (see
      <a href="replication.html#replication-solutions-scaleout" title="16.2.3. Using Replication for Scale-Out">Section 16.2.3, “Using Replication for Scale-Out”</a>), you want to use
      <code class="literal">InnoDB</code> tables on the master to take advantage
      of the transactional functionality, but use
      <code class="literal">MyISAM</code> on the slaves where transaction support
      is not required because the data is only read. When using
      replication in a data logging environment you may want to use the
      <code class="literal">Archive</code> storage engine on the slave.
    </p><p>
      Setting up different engines on the master and slave depends on
      how you set up the initial replication process:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          If you used <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to create the
          database snapshot on your master then you could edit the dump
          text to change the engine type used on each table.
        </p><p>
          Another alternative for <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> is to
          disable engine types that you do not want to use on the slave
          before using the dump to build the data on the slave. For
          example, you can add the
          <a href="server-administration.html#option_mysqld_skip-innodb"><code class="option">--skip-innodb</code></a> option on your
          slave to disable the <code class="literal">InnoDB</code> engine. If a
          specific engine does not exist, MySQL will use the default
          engine type, usually <code class="literal">MyISAM</code>. If you want to
          disable further engines in this way, you may want to consider
          building a special binary to be used on the slave that only
          supports the engines you want.
        </p></li><li><p>
          If you are using raw data files for the population of the
          slave, you will be unable to change the initial table format.
          Instead, use <a href="sql-syntax.html#alter-table" title="12.1.6. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to
          change the table types after the slave has been started.
        </p></li><li><p>
          For new master/slave replication setups where there are
          currently no tables on the master, avoid specifying the engine
          type when creating new tables.
        </p></li></ul></div><p>
      If you are already running a replication solution and want to
      convert your existing tables to another engine type, follow these
      steps:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Stop the slave from running replication updates:
        </p><pre class="programlisting">mysql&gt; STOP SLAVE;</pre><p>
          This will enable you to change engine types without
          interruptions.
        </p></li><li><p>
          Execute an <code class="literal">ALTER TABLE ...
          Engine='<em class="replaceable"><code>enginetype</code></em>'</code> for
          each table where you want to change the engine type.
        </p></li><li><p>
          Start the slave replication process again:
        </p><pre class="programlisting">mysql&gt; START SLAVE;</pre></li></ol></div><p>
      Although the <a href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a>
      variable is not replicated, be aware that
      <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and
      <a href="sql-syntax.html#alter-table" title="12.1.6. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements that include
      the engine specification will be correctly replicated to the
      slave. For example, if you have a CSV table and you execute:
    </p><pre class="programlisting">mysql&gt; ALTER TABLE csvtable Engine='MyISAM';</pre><p>
      The above statement will be replicated to the slave and the engine
      type on the slave will be converted to <code class="literal">MyISAM</code>,
      even if you have previously changed the table type on the slave to
      an engine other than CSV. If you want to retain engine differences
      on the master and slave, you should be careful to use the
      <a href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a> variable on the
      master when creating a new table. For example, instead of:
    </p><pre class="programlisting">mysql&gt; CREATE TABLE tablea (columna int) Engine=MyISAM;</pre><p>
      Use this format:
    </p><pre class="programlisting">mysql&gt; SET storage_engine=MyISAM;
mysql&gt; CREATE TABLE tablea (columna int);</pre><p>
      When replicated, the
      <a href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a> variable will be
      ignored, and the <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
      statement will be executed with the slave's default engine type.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-scaleout"></a>16.2.3. Using Replication for Scale-Out</h3></div></div></div><p>
      You can use replication as a scale-out solution, i.e. where you
      want to split up the load of database queries across multiple
      database servers, within some reasonable limitations.
    </p><p>
      Because replication works from the distribution of one master to
      one or more slaves, using replication for scaleout works best in
      an environment where you have a high number of reads and low
      number of writes/updates. Most websites fit into this category,
      where users are browsing the website, reading articles, posts, or
      viewing products. Updates only occur during session management, or
      when making a purchase or adding a comment/message to a forum.
    </p><p>
      Replication in this situation enables you to distribute the reads
      over the replication slaves, while still allowing your web servers
      to communicate with the replication master when a write is
      required. You can see a sample replication layout for this
      scenario in <a href="replication.html#figure_replication-scaleout" title="Figure 16.1. Using replication to improve the performance during scaleout">Figure 16.1, “Using replication to improve the performance during scaleout”</a>.
    </p><div class="figure"><a name="figure_replication-scaleout"></a><p class="title"><b>Figure 16.1. Using replication to improve the performance during scaleout</b></p><div class="mediaobject"><img src="images/scaleout.png" width="687" height="341" alt="Using replication to improve the performance
          during scaleout"></div></div><p>
      If the part of your code that is responsible for database access
      has been properly abstracted/modularized, converting it to run
      with a replicated setup should be very smooth and easy. Change the
      implementation of your database access to send all writes to the
      master, and to send reads to either the master or a slave. If your
      code does not have this level of abstraction, setting up a
      replicated system gives you the opportunity and motivation to
      clean it up. Start by creating a wrapper library or module that
      implements the following functions:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="literal">safe_writer_connect()</code>
        </p></li><li><p>
          <code class="literal">safe_reader_connect()</code>
        </p></li><li><p>
          <code class="literal">safe_reader_statement()</code>
        </p></li><li><p>
          <code class="literal">safe_writer_statement()</code>
        </p></li></ul></div><p>
      <code class="literal">safe_</code> in each function name means that the
      function takes care of handling all error conditions. You can use
      different names for the functions. The important thing is to have
      a unified interface for connecting for reads, connecting for
      writes, doing a read, and doing a write.
    </p><p>
      Then convert your client code to use the wrapper library. This may
      be a painful and scary process at first, but it pays off in the
      long run. All applications that use the approach just described
      are able to take advantage of a master/slave configuration, even
      one involving multiple slaves. The code is much easier to
      maintain, and adding troubleshooting options is trivial. You need
      modify only one or two functions; for example, to log how long
      each statement took, or which statement among those issued gave
      you an error.
    </p><p>
      If you have written a lot of code, you may want to automate the
      conversion task by using the <a href="programs.html#replace-utility" title="4.8.2. replace — A String-Replacement Utility"><span><strong class="command">replace</strong></span></a> utility
      that comes with standard MySQL distributions, or write your own
      conversion script. Ideally, your code uses consistent programming
      style conventions. If not, then you are probably better off
      rewriting it anyway, or at least going through and manually
      regularizing it to use a consistent style.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-partitioning"></a>16.2.4. Replicating Different Databases to Different Slaves</h3></div></div></div><p>
      There may be situations where you have a single master and want to
      replicate different databases to different slaves. For example,
      you may want to distribute different sales data to different
      departments to help spread the load during data analysis. A sample
      of this layout is shown in
      <a href="replication.html#figure_replication-multi-db" title="Figure 16.2. Using replication to replicate databases to separate replication slaves">Figure 16.2, “Using replication to replicate databases to separate replication slaves”</a>.
    </p><div class="figure"><a name="figure_replication-multi-db"></a><p class="title"><b>Figure 16.2. Using replication to replicate databases to separate replication slaves</b></p><div class="mediaobject"><img src="images/multi-db.png" width="424" height="178" alt="Using replication to replicate databases to
          separate replication slaves"></div></div><p>
      You can achieve this separation by configuring the master and
      slaves as normal, and then limiting the binary log statements that
      each slave processes by using the
      <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>
      configuration option on each slave.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        You should <span class="emphasis"><em>not</em></span> use
        <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> for this
        purpose when using statement-based replication, since
        statement-based replication causes this option's affects to
        vary according to the database that is currently selected. This
        applies to mixed-format replication as well, since this allows
        some updates to be replicated using the statement-based format.
      </p><p>
        However, it should be to use
        <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> for this
        purpose if you are using row-based replication only, since in
        this case the currently-selected database has no effect on the
        option's operation.
      </p></div><p>
      For example, to support the separation as shown in
      <a href="replication.html#figure_replication-multi-db" title="Figure 16.2. Using replication to replicate databases to separate replication slaves">Figure 16.2, “Using replication to replicate databases to separate replication slaves”</a>, you should
      configure each replication slave as follows, before executing
      <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a>:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Replication slave 1 should use
          <code class="option">--replicate-wild-do-table=databaseA.%</code>.
        </p></li><li><p>
          Replication slave 2 should use
          <code class="option">--replicate-wild-do-table=databaseB.%</code>.
        </p></li><li><p>
          Replication slave 3 should use
          <code class="option">--replicate-wild-do-table=databaseC.%</code>.
        </p></li></ul></div><p>
      If you have data that needs to be synchronized to the slaves
      before replication starts, you have a number of choices:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Synchronize all the data to each slave, and delete the
          databases, tables, or both that you do not want to keep.
        </p></li><li><p>
          Use <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program"><span><strong class="command">mysqldump</strong></span></a> to create a separate dump
          file for each database and load the appropriate dump file on
          each slave.
        </p></li><li><p>
          Use a raw data file dump and include only the specific files
          and databases that you need for each slave.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            This does not work with <code class="literal">InnoDB</code>
            databases unless you use
            <a href="storage-engines.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>.
          </p></div></li></ul></div><p>
      Each slave in this configuration receives the entire binary log
      from the master, but executes only those events from the binary
      log that apply to the databases and tables included by the
      <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a> option in
      effect on that slave.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-performance"></a>16.2.5. Improving Replication Performance</h3></div></div></div><p>
      As the number of slaves connecting to a master increases, the
      load, although minimal, also increases, as each slave uses up a
      client connection to the master. Also, as each slave must receive
      a full copy of the master binary log, the network load on the
      master may also increase and start to create a bottleneck.
    </p><p>
      If you are using a large number of slaves connected to one master,
      and that master is also busy processing requests (for example, as
      part of a scaleout solution), then you may want to improve the
      performance of the replication process.
    </p><p>
      One way to improve the performance of the replication process is
      to create a deeper replication structure that enables the master
      to replicate to only one slave, and for the remaining slaves to
      connect to this primary slave for their individual replication
      requirements. A sample of this structure is shown in
      <a href="replication.html#figure_replication-performance" title="Figure 16.3. Using an additional replication host to improve performance">Figure 16.3, “Using an additional replication host to improve performance”</a>.
    </p><div class="figure"><a name="figure_replication-performance"></a><p class="title"><b>Figure 16.3. Using an additional replication host to improve performance</b></p><div class="mediaobject"><img src="images/submaster-performance.png" width="534" height="179" alt="Using an additional replication host to
          improve performance"></div></div><p>
      For this to work, you must configure the MySQL instances as
      follows:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Master 1 is the primary master where all changes and updates
          are written to the database. Binary logging should be enabled
          on this machine.
        </p></li><li><p>
          Master 2 is the slave to the Master 1 that provides the
          replication functionality to the remainder of the slaves in
          the replication structure. Master 2 is the only machine
          allowed to connect to Master 1. Master 2 also has binary
          logging enabled, and the
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> option so
          that replication instructions from Master 1 are also written
          to Master 2's binary log so that they can then be replicated
          to the true slaves.
        </p></li><li><p>
          Slave 1, Slave 2, and Slave 3 act as slaves to Master 2, and
          replicate the information from Master 2, which is really the
          data logged on Master 1.
        </p></li></ul></div><p>
      The above solution reduces the client load and the network
      interface load on the primary master, which should improve the
      overall performance of the primary master when used as a direct
      database solution.
    </p><p>
      If your slaves are having trouble keeping up with the replication
      process on the master then there are a number of options
      available:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          If possible, you should put the relay logs and the data files
          on different physical drives. To do this, use the
          <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> option to specify
          the location of the relay log.
        </p></li><li><p>
          If the slaves are significantly slower than the master, then
          you may want to divide up the responsibility for replicating
          different databases to different slaves. See
          <a href="replication.html#replication-solutions-partitioning" title="16.2.4. Replicating Different Databases to Different Slaves">Section 16.2.4, “Replicating Different Databases to Different Slaves”</a>.
        </p></li><li><p>
          If your master makes use of transactions and you are not
          concerned about transaction support on your slaves, then use
          <code class="literal">MyISAM</code> or another non-transactional engine.
          See <a href="replication.html#replication-solutions-diffengines" title="16.2.2. Using Replication with Different Master and Slave Storage Engines">Section 16.2.2, “Using Replication with Different Master and Slave Storage Engines”</a>.
        </p></li><li><p>
          If your slaves are not acting as masters, and you have a
          potential solution in place to ensure that you can bring up a
          master in the event of failure, then you can switch off
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a>. This
          prevents 'dumb' slaves from also logging events they have
          executed into their own binary log.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-switch"></a>16.2.6. Switching Masters During Failover</h3></div></div></div><p>
      There is currently no official solution for providing failover
      between master and slaves in the event of a failure. With the
      currently available features, you would have to set up a master
      and a slave (or several slaves), and to write a script that
      monitors the master to check whether it is up. Then instruct your
      applications and the slaves to change master in case of failure.
    </p><p>
      Remember that you can tell a slave to change its master at any
      time, using the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
      statement. The slave will not check whether the databases on the
      master are compatible with the slave, it will just start executing
      events from the specified log and position on the new master. In a
      failover situation all the servers in the group are probably
      executing the same events from the same binary log, so changing
      the source of the events should not affect the database structure
      or integrity providing you are careful.
    </p><p>
      Run your slaves with the <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a>
      option and without
      <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a>. In this way,
      the slave is ready to become a master as soon as you issue
      <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>;
      <a href="sql-syntax.html#reset-master" title="12.6.1.2. RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a>, and
      <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement on the
      other slaves. For example, assume that you have the structure
      shown in <a href="replication.html#figure_replication-redundancy-before" title="Figure 16.4. Redundancy using replication, initial structure">Figure 16.4, “Redundancy using replication, initial structure”</a>.
    </p><div class="figure"><a name="figure_replication-redundancy-before"></a><p class="title"><b>Figure 16.4. Redundancy using replication, initial structure</b></p><div class="mediaobject"><img src="images/redundancy-before.png" width="504" height="353" alt="Redundancy using replication, initial
          structure"></div></div><p>
      In this diagram, the <code class="literal">MySQL Master</code> holds the
      master database, the <code class="literal">MySQL Slave</code> computers are
      replication slaves, and the <code class="literal">Web Client</code> machines
      are issuing database reads and writes. Web clients that issue only
      reads (and would normally be connected to the slaves) are not
      shown, as they do not need to switch to a new server in the event
      of failure. For a more detailed example of a read/write scaleout
      replication structure, see
      <a href="replication.html#replication-solutions-scaleout" title="16.2.3. Using Replication for Scale-Out">Section 16.2.3, “Using Replication for Scale-Out”</a>.
    </p><p>
      Each MySQL Slave (<code class="literal">Slave 1</code>, <code class="literal">Slave
      2</code>, and <code class="literal">Slave 3</code>) are slaves running
      with <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> and without
      <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a>. Because
      updates received by a slave from the master are not logged in the
      binary log unless
      <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> is specified,
      the binary log on each slave is empty initially. If for some
      reason <code class="literal">MySQL Master</code> becomes unavailable, you
      can pick one of the slaves to become the new master. For example,
      if you pick <code class="literal">Slave 1</code>, all <code class="literal">Web
      Clients</code> should be redirected to <code class="literal">Slave
      1</code>, which will log updates to its binary log.
      <code class="literal">Slave 2</code> and <code class="literal">Slave 3</code> should
      then replicate from <code class="literal">Slave 1</code>.
    </p><p>
      The reason for running the slave without
      <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> is to prevent
      slaves from receiving updates twice in case you cause one of the
      slaves to become the new master. Suppose that <code class="literal">Slave
      1</code> has <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a>
      enabled. Then it will write updates that it receives from
      <code class="literal">Master</code> to its own binary log. When
      <code class="literal">Slave 2</code> changes from <code class="literal">Master</code>
      to <code class="literal">Slave 1</code> as its master, it may receive
      updates from <code class="literal">Slave 1</code> that it has already
      received from <code class="literal">Master</code>
    </p><p>
      Make sure that all slaves have processed any statements in their
      relay log. On each slave, issue <code class="literal">STOP SLAVE
      IO_THREAD</code>, then check the output of
      <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> until you see
      <code class="literal">Has read all relay log</code>. When this is true for
      all slaves, they can be reconfigured to the new setup. On the
      slave <code class="literal">Slave 1</code> being promoted to become the
      master, issue <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> and
      <a href="sql-syntax.html#reset-master" title="12.6.1.2. RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a>.
    </p><p>
      On the other slaves <code class="literal">Slave 2</code> and <code class="literal">Slave
      3</code>, use <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> and
      <code class="literal">CHANGE MASTER TO MASTER_HOST='Slave1'</code> (where
      <code class="literal">'Slave1'</code> represents the real host name of
      <code class="literal">Slave 1</code>). To use <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE
      MASTER TO</code></a>, add all information about how to connect to
      <code class="literal">Slave 1</code> from <code class="literal">Slave 2</code> or
      <code class="literal">Slave 3</code> (<em class="replaceable"><code>user</code></em>,
      <em class="replaceable"><code>password</code></em>,
      <em class="replaceable"><code>port</code></em>). In <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE
      MASTER TO</code></a>, there is no need to specify the name of
      <code class="literal">Slave 1</code>'s binary log or binary log position to
      read from: We know it is the first binary log and position 4,
      which are the defaults for <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
      TO</code></a>. Finally, use <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START
      SLAVE</code></a> on <code class="literal">Slave 2</code> and <code class="literal">Slave
      3</code>.
    </p><p>
      Once the new replication is in place, you will then need to
      instruct each <code class="literal">Web Client</code> to direct their
      statements to <code class="literal">Slave 1</code>. From that point on, all
      updates statements sent by <code class="literal">Web Client</code> to
      <code class="literal">Slave 1</code> are written to the binary log of
      <code class="literal">Slave 1</code>, which then contains every update
      statement sent to <code class="literal">Slave 1</code> since
      <code class="literal">Master</code> died.
    </p><p>
      The resulting server structure is shown in
      <a href="replication.html#figure_replication-redundancy-after" title="Figure 16.5. Redundancy using replication, after master failure">Figure 16.5, “Redundancy using replication, after master failure”</a>.
    </p><div class="figure"><a name="figure_replication-redundancy-after"></a><p class="title"><b>Figure 16.5. Redundancy using replication, after master failure</b></p><div class="mediaobject"><img src="images/redundancy-after.png" width="538" height="432" alt="Redundancy using replication, after master
          failure"></div></div><p>
      When <code class="literal">Master</code> is up again, you must issue on it
      the same <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> as that
      issued on <code class="literal">Slave 2</code> and <code class="literal">Slave
      3</code>, so that <code class="literal">Master</code> becomes a slave of
      <code class="literal">S1</code> and picks up each <code class="literal">Web
      Client</code> writes that it missed while it was down.
    </p><p>
      To make <code class="literal">Master</code> a master again (because it is
      the most powerful machine, for example), use the preceding
      procedure as if <code class="literal">Slave 1</code> was unavailable and
      <code class="literal">Master</code> was to be the new master. During this
      procedure, do not forget to run <a href="sql-syntax.html#reset-master" title="12.6.1.2. RESET MASTER Syntax"><code class="literal">RESET
      MASTER</code></a> on <code class="literal">Master</code> before making
      <code class="literal">Slave 1</code>, <code class="literal">Slave 2</code>, and
      <code class="literal">Slave 3</code> slaves of <code class="literal">Master</code>.
      Otherwise, they may pick up old <code class="literal">Web Client</code>
      writes from before the point at which <code class="literal">Master</code>
      became unavailable.
    </p><p>
      Note that there is no synchronization between the different slaves
      to a master. Some slaves might be ahead of others. This means that
      the concept outlined in the previous example might not work. In
      practice, however, the relay logs of different slaves will most
      likely not be far behind the master, so it would work, anyway (but
      there is no guarantee).
    </p><p>
      A good way to keep your applications informed as to the location
      of the master is by having a dynamic DNS entry for the master.
      With <code class="literal">bind</code> you can use
      <code class="filename">nsupdate</code> to dynamically update your DNS.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-multi-master-upgrade"></a>16.2.7. Upgrading Multi-Master Replication</h3></div></div></div><p>
      This section discusses how to upgrade the MySQL server software on
      several machines in a multi-master replication setup from an older
      version to a newer version of the software without taking the
      entire system offline. The procedure outlined here is intended to
      be illustrative and not necessarily to be followed exactly as
      written in all possible scenarios.
    </p><p>
      There are two sorts of configurations for replication involving
      multiple masters:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Linear replication. </b>
              In this type of setup, one or more masters replicates to a
              single slave. The simplest linear replication topology is
              shown here, where a single master A replicates to a single
              slave B:

              </p><div class="mediaobject"><img src="images/rpl-multi-master-linear-1.png" width="500" height="150" alt="Simplest case: single master
                  replicates to single slave"></div><p>
            </p><p>
            Of greater interest are cases where we actually have
            multiple masters, such as


            when we have a chain of MySQL servers, some of which are
            acting as both masters and slaves. The following diagram
            depicts server A replicating to B, which in turn replicates
            to C; here, B acts as both a master and a slave:

            </p><div class="mediaobject"><img src="images/rpl-multi-master-linear-3.png" width="500" height="150" alt="Several MySQL servers replicate to one
                another in turn"></div><p>
          </p><p>
            In


            this case, the procedure for performing a software upgrade
            can be developed from the simple principle “<span class="quote">upgrade
            the slave first, then the master</span>”. In other words,


            we should


            start by upgrading the server that acts only as a slave (C),
            then upgrading its master (B), and so on, until we reach the
            server acting as a master only (A), upgrade it, and so
            complete the process. This can easily be extended to cover
            an arbitrary number of MySQL servers, as shown here:

            </p><div class="mediaobject"><img src="images/rpl-multi-master-linear-4.png" width="575" height="175" alt="Arbitrarily long chain of replication
                masters and slaves"></div><p>
          </p></li><li><p><b>Circular replication. </b>
              In a circular replication setup, <span class="emphasis"><em>each</em></span>
              MySQL server acts as both a master and a slave; thus,
              there is no “<span class="quote">last</span>” server which we can use as
              a starting point to apply “<span class="quote">upgrade the slave first,
              then the master</span>”. We therefore require a different
              approach to performing the upgrade, and it is for this
              reason that the rest of this section is devoted to a
              discussion of upgrading the MySQL server software on
              several hosts configured in a circular replication setup.
            </p></li></ul></div><p>
    </p><p><b>Basic scenario. </b>
        Assume that we have three servers, A, B, and C, running MySQL
        version 6.0, replicating in a circle, as shown in
        this diagram:

        </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-1.png" width="375" height="375" alt="Circular replication with 3 MySQL
            servers"></div><p>

        Our objective is to upgrade, in turn, all three machines from
        one MySQL version (for example, MySQL 5.1) to a newer MySQL
        version (such as MySQL 6.0) without taking the system as a whole
        out of production. We start with server C, which acts as a slave
        of server B and a master to server A.
      </p><p>
      To upgrade this server, we need to perform the following steps:

      </p><div class="orderedlist"><ol type="1"><li><p><b>Stop C. </b>
              On C, execute the statement

</p><pre class="programlisting">STOP SLAVE;
</pre><p>
            </p></li><li><p><b>Create a “<span class="quote">marker</span>” event on B. </b>
              Execute a statement on B that generates an event which is
              easily identified. For this example, we assume that there
              is no existing table named <code class="literal">marker</code> in
              the <code class="literal">test</code> database, and perform the
              following statements to create it:

</p><pre class="programlisting">USE test;
CREATE TABLE marker1 (col INT);
</pre><p>

              The table schema is completely arbitrary; in fact, the
              statement is itself completely arbitrary. The only
              requirement is that we use an SQL statement that is unique
              and easily identifiable for use as the
              “<span class="quote">marker</span>”.
            </p></li><li><p><b>Find the position of the marker in the binary log. </b>
              This can be done by executing <a href="sql-syntax.html#show-binlog-events" title="12.5.6.3. SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW
              BINLOG EVENTS</code></a> on B, then checking the
              <code class="literal">Info</code> column in the output for an event
              containing the “<span class="quote">marker</span>” statement. Note the
              values of the <code class="literal">Log_name</code> and
              <code class="literal">Pos</code> columns, which are needed for the
              next step, where we refer to these values as
              <em class="replaceable"><code>fileB</code></em> and
              <em class="replaceable"><code>posB</code></em>, respectively.
            </p></li><li><p><b>Allow C to catch up to the marker. </b>
              Execute the following statements on C:

</p><pre class="programlisting">START SLAVE UNTIL
    MASTER_LOG_FILE=<em class="replaceable"><code>fileB</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posB</code></em>;

SELECT MASTER_POS_WAIT(<em class="replaceable"><code>fileB</code></em>, <em class="replaceable"><code>posB</code></em>);
</pre><p>

              This causes C to execute any remaining events sent from B
              up to the point where the “<span class="quote">marker</span>” statement
              was issued, and then to stop. The place of the marker in
              the sequence of events flowing from B to C is illustrated
              here:

              </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-2.png" width="475" height="450" alt="“Marker” event created
                  on server B in the flow of events from B to C"></div><p>
            </p></li><li><p><b>Take server C offline. </b>
              Ensure that no further actions capable of updating the
              binary log can be taken on C:

              </p><div class="itemizedlist"><ul type="disc"><li><p>
                    Redirect any clients using C to A or B. This is best
                    handled in application code. Additionally, you may
                    wish to use the <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
                    PROCESSLIST</code></a> and
                    <a href="sql-syntax.html#kill" title="12.5.7.4. KILL Syntax"><code class="literal">KILL</code></a> statements, as
                    the MySQL <code class="literal">root</code> user or as another
                    user with the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a>
                    privilege, to terminate any remaining client
                    processes other than the one you are using to
                    perform tasks on C relating to the software upgrade.
                  </p><p>
                    You can prevent any application clients from
                    reconnecting to C by executing the following
                    statement as MySQL <code class="literal">root</code> (or
                    another user having the
                    <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege):

</p><pre class="programlisting">SET @@GLOBAL.MAX_CONNECTIONS = 1;
</pre><p>
                  </p><p>
                    Once this has been done, only a single client,
                    having the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a>
                    privilege, may connect to C. This works because
                    <code class="literal">max_connections + 1</code> clients are
                    allowed to connect to the server, with one of these
                    connections being reserved for a client having the
                    <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege.
                    Therefore, when
                    <a href="server-administration.html#sysvar_max_connections"><code class="literal">max_connections</code></a> is
                    equal to 1, and no other clients are connected, a
                    maximum of 1 client <span class="emphasis"><em>not</em></span> having
                    <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> may connect.
                    However, a client not having the
                    <code class="literal">SUPER</code> privilege cannot use the
                    extra connection. This means that, when
                    <a href="server-administration.html#sysvar_max_connections"><code class="literal">max_connections</code></a> is
                    <code class="literal">1</code> and a client having
                    <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> is already
                    connected, no
                    non-<a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> clients may
                    connect connect to the server.
                  </p></li><li><p>
                    Force all tables to be read-only by executing the
                    following statement:

</p><pre class="programlisting">SET @@GLOBAL.READ_ONLY = ON;
</pre><p>

                    As an alternative, you can use the following
                    statement, which is equivalent to the previous one:

</p><pre class="programlisting">SET @@GLOBAL.READ_ONLY = 1;
                  </pre><p>

                    This places the server into “<span class="quote">read-only</span>”
                    mode, which prevents any accidental changes to
                    tables on C.
                  </p></li><li><p>
                    Stop the MySQL Event Scheduler on server C by
                    executing the following statement:

</p><pre class="programlisting">SET @@GLOBAL.EVENT_SCHEDULER = OFF;
</pre><p>

                    This is necessary since the Event Scheduler can
                    perform actions that result in writes to the binary
                    log, which could cause the binary log on C to
                    diverge from the binary logs on the other servers in
                    unexpected ways.
                  </p></li></ul></div><p>
            </p></li><li><p><b>Find the end of the last binary log on C. </b>
              This can be accomplished by executing
              <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a> on C and
              noting the values shown in the <code class="literal">File</code> and
              <code class="literal">Position</code> columns of the output, which
              we show as <em class="replaceable"><code>fileC</code></em> and
              <em class="replaceable"><code>posC</code></em>, respectively, in the next
              step.
            </p></li><li><p><b>Stop and synchronize slave A. </b>
              Execute <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> on A.
              Then perform the following statements:

</p><pre class="programlisting">START SLAVE UNTIL
    MASTER_LOG_FILE=<em class="replaceable"><code>fileC</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posC</code></em>;

SELECT MASTER_POS_WAIT(<em class="replaceable"><code>fileC</code></em>, <em class="replaceable"><code>posC</code></em>);
</pre><p>

              This causes any remaining unprocessed events up the marker
              event on C to be executed on A, and causes A to stop once
              this has been done. The propagation of the marker from
              server C to server A is shown here:

              </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-3.png" width="475" height="475" alt="Marker event propagates from server
                  C to server A"></div><p>

              This is not the same marker as the previous one — in
              fact, the best “<span class="quote">marker</span>” to use here is the
              end of C's binary log.
            </p></li><li><p><b>Start replication from B to A. </b>
              You can cause A to replicate from B instead of from C by
              issuing the following 2 statements on server A:

</p><pre class="programlisting">CHANGE MASTER TO
    MASTER_HOST=<em class="replaceable"><code>hostB</code></em>,
    MASTER_LOG_FILE=<em class="replaceable"><code>fileB</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posB</code></em>;

START SLAVE;
</pre><p>

              In the first of these statements,
              <em class="replaceable"><code>hostB</code></em> represents the host name
              or IP address for server B;
              <em class="replaceable"><code>fileB</code></em> and
              <em class="replaceable"><code>posB</code></em> are the same as determined
              for these values earlier
            </p><p>
            C is now isolated from the other two servers, which are now
            replicating to each other, as shown here:

            </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-4.png" width="500" height="575" alt="Servers A and B in mutual replication;
                server C isolated"></div><p>
          </p></li><li><p><b>Upgrade C to C'. </b>
              Shut down C, and upgrade the MySQL software on C from
              version X to version Y:

              </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-5.png" width="450" height="575" alt="Upgrading Server C running MySQL
                  version X to C', running MySQL version Y"></div><p>

              We refer to the upgraded server C as
              <span class="emphasis"><em>C'</em></span>.
            </p><p>
            For general information about performing upgrades, see the
            <em class="citetitle">Upgrading MySQL</em> section of the
            <em class="citetitle">MySQL Manual</em> corresponding to the
            versions from which and to which you are upgrading.
          </p></li><li><p><b>Start C' in offline mode. </b>
              Start server C', insuring that all its tables are in
              read-only mode, and that no MySQL clients (with the
              exception of a single connection from a superuser account)
              can connect to it. You can do this by starting
              <a href="programs.html#mysqld" title="4.3.1. mysqld — The MySQL Server"><span><strong class="command">mysqld</strong></span></a> with the options
              <a href="server-administration.html#sysvar_read_only"><code class="option">--read_only</code></a>
              <a href="server-administration.html#sysvar_max_connections"><code class="option">--max_connections=1</code></a>. (For
              more information about these options, see
              <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>.)
            </p></li><li><p><b>Stop replicating from B to A. </b>
              Stop sending events from B to A, and ensure that A has
              executed all events sent to it from B:

              </p><div class="itemizedlist"><ul type="disc"><li><p>
                    Issue a <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> on
                    A
                  </p></li><li><p>
                    Issue a marker statement on B, such as this one:

</p><pre class="programlisting">CREATE TABLE test.marker2 (col INT);
</pre><p>

                    As with the previous marker statement, the type and
                    any other aspects of the statement are completely
                    arbitrary; the only requirement is that the
                    statement must be uniquely identifiable.
                  </p></li><li><p>
                    Use <a href="sql-syntax.html#show-binlog-events" title="12.5.6.3. SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG
                    EVENTS</code></a> on B to find the binary log file
                    and position where the marker event was recorded, as
                    described previously. We use
                    <em class="replaceable"><code>fileB'</code></em> and
                    <em class="replaceable"><code>posB'</code></em> to denote
                    these in the next item.
                  </p></li><li><p>
                    Start server A and synchronize it with B by issuing
                    the following statements on A:

</p><pre class="programlisting">START SLAVE UNTIL
    MASTER_LOG_FILE=<em class="replaceable"><code>fileB'</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posB'</code></em>;

SELECT MASTER_POS_WAIT(<em class="replaceable"><code>fileB'</code></em>, <em class="replaceable"><code>posB'</code></em>);
</pre><p>

                    Once A has executed all events up to and including
                    the second marker event, it stops, as shown here:

                    </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-6.png" width="450" height="575" alt="Second marker event propagates
                        from server B to server A"></div><p>
                  </p></li></ul></div><p>
            </p></li><li><p><b>Start replicating from B to C'. </b>
              Start sending events from B to C' and executing them
              on C' (indicated by the dotted line in the next
              diagram), ensuring that the first event not sent to A is
              the first event sent to C'. You can do this by
              issuing the following statements on C':

</p><pre class="programlisting">SET @@GLOBAL.READ_ONLY = OFF;
      
CHANGE MASTER TO
    MASTER_HOST=<em class="replaceable"><code>hostB</code></em>,
    MASTER_LOG_FILE=<em class="replaceable"><code>fileB'</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posB'</code></em>;

START SLAVE;
</pre><p>

              Replication now occurs as shown here:

              </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-7.png" width="400" height="400" alt="Server B now replicates to server
                  C'"></div><p>
            </p></li><li><p><b>Start replicating from C' to A. </b>
              This can be done as follows:

              </p><div class="itemizedlist"><ul type="disc"><li><p>
                    Locate the file and position of the second marker
                    event in the binary log on server C'. This can
                    be found by issuing <a href="sql-syntax.html#show-binlog-events" title="12.5.6.3. SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG
                    EVENTS</code></a> on C' as previously described.
                  </p><p>
                    We denote the file and position within this file as
                    <em class="replaceable"><code>fileC'</code></em> and
                    <em class="replaceable"><code>posC'</code></em>, respectively.
                  </p></li><li><p>
                    Start replication on A from this point by issuing
                    the following statements, where
                    <em class="replaceable"><code>hostC'</code></em> represents
                    the host name or IP address of server C', and
                    <em class="replaceable"><code>fileC'</code></em> and
                    <em class="replaceable"><code>posC'</code></em> are defined as
                    stated in the previous item:

</p><pre class="programlisting">CHANGE MASTER TO
    MASTER_HOST=<em class="replaceable"><code>hostC'</code></em>,
    MASTER_LOG_FILE=<em class="replaceable"><code>fileC'</code></em>, 
    MASTER_LOG_POS=<em class="replaceable"><code>posC'</code></em>;

START SLAVE;
</pre><p>
                  </p></li></ul></div><p>
            </p></li><li><p><b>Return server C to online status. </b>
              This can be done by setting
              <code class="literal">@@GLOBAL.MAX_CONNECTIONS</code> to an
              appropriate value greater than <code class="literal">1</code>,
              thereby once again permitting regular clients not having
              the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege to
              connect.
            </p></li></ol></div><p>
    </p><p>
      At this point, the original replication topology has been
      restored, and all is as before, except that server C running MySQL
      version X has been upgrade to C' running MySQL version Y, as
      shown here:

      </p><div class="mediaobject"><img src="images/rpl-circular-upgrade-8.png" width="375" height="375" alt="The circular replication topology is now
          restored, with server A replicating to server B, server B
          replicating to server C', and server C' replicating
          to server A"></div><p>

      You can now complete the software upgrade process by repeating the
      steps shown previously for servers A and B, each in turn.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-solutions-ssl"></a>16.2.8. Setting Up Replication Using SSL</h3></div></div></div><p>
      Setting up replication using an SSL connection is similar to
      setting up a server and client using SSL. You will need to obtain
      (or create) a suitable security certificate that you can use on
      the master, and a similar certificate (from the same certificate
      authority) on each slave.
    </p><p>
      To use SSL for encrypting the transfer of the binary log required
      during replication you must first set up the master to support SSL
      network connections. If the master does not support SSL
      connections (because it has not been compiled or configured for
      SSL), then replication through an SSL connection will not be
      possible.
    </p><p>
      For more information on setting up a server and client for SSL
      connectivity, see <a href="server-administration.html#secure-using-ssl" title="5.5.7.2. Using SSL Connections">Section 5.5.7.2, “Using SSL Connections”</a>.
    </p><p>
      To enable SSL on the master you will need to create or obtain
      suitable certificates and then add the following configuration
      options to the master's configuration within the
      <code class="literal">mysqld</code> section:
    </p><pre class="programlisting">ssl-ca=<em class="replaceable"><code>cacert.pem</code></em>
ssl-cert=<em class="replaceable"><code>server-cert.pem</code></em>
ssl-key=<em class="replaceable"><code>server-key.pem</code></em></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        You should use full path to specify the location of your
        certificate files.
      </p></div><p>
      The options are as follows:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="literal">ssl-ca</code> identifies the Certificate Authority
          (CA) certificate.
        </p></li><li><p>
          <code class="literal">ssl-cert</code> identifies the server public key.
          This can be sent to the client and authenticated against the
          CA certificate that it has.
        </p></li><li><p>
          <code class="literal">ssl-key</code> identifies the server private key.
        </p></li></ul></div><p>
      On the slave, you have two options available for setting the SSL
      information. You can either add the slaves certificates to the
      <code class="literal">client</code> section of the slave configuration file,
      or you can explicitly specify the SSL information using the
      <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement.
    </p><p>
      Using the former option, add the following lines to the
      <code class="literal">client</code> section of the slave configuration file:
    </p><pre class="programlisting">[client]
ssl-ca=<em class="replaceable"><code>cacert.pem</code></em>
ssl-cert=<em class="replaceable"><code>server-cert.pem</code></em>
ssl-key=<em class="replaceable"><code>server-key.pem</code></em></pre><p>
      Restart the slave server, using the
      <code class="literal">--skip-slave</code> to prevent the slave from
      connecting to the master. Use <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
      TO</code></a> to specify the master configuration, using the
      <code class="literal">master_ssl</code> option to enable SSL connectivity:
    </p><pre class="programlisting">mysql&gt; CHANGE MASTER TO \
    MASTER_HOST='master_hostname', \
    MASTER_USER='replicate', \
    MASTER_PASSWORD='password', \
    MASTER_SSL=1;</pre><p>
      To specify the SSL certificate options during the
      <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> command, append
      the SSL options:
    </p><pre class="programlisting">CHANGE MASTER TO \
      MASTER_HOST='master_hostname', \
      MASTER_USER='replicate', \
      MASTER_PASSWORD='password', \
      MASTER_SSL=1, \
      MASTER_SSL_CA = 'ca_file_name', \
      MASTER_SSL_CAPATH = 'ca_directory_name', \
      MASTER_SSL_CERT = 'cert_file_name', \
      MASTER_SSL_KEY = 'key_file_name';</pre><p>
      Once the master information has been updated, start the slave
      replication process:
    </p><pre class="programlisting">mysql&gt; START SLAVE;</pre><p>
      You can use the <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>
      to confirm that SSL connection has been completed.
    </p><p>
      For more information on the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
      TO</code></a> syntax, see <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>.
    </p><p>
      If you want to enforce SSL connections to be used during
      replication, then create a user with the
      <a href="server-administration.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a> privilege and use
      the <code class="literal">REQUIRE_SSL</code> option for that user. For
      example:
    </p><pre class="programlisting">mysql&gt; GRANT REPLICATION SLAVE ON *.*
    -&gt; TO 'repl'@'%.mydomain.com' IDENTIFIED BY 'slavepass' REQUIRE SSL;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-semisync"></a>16.2.9. Semisynchronous Replication</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-semisync-interface">16.2.9.1. Semisynchronous Replication Administrative Interface</a></span></dt><dt><span class="section"><a href="replication.html#replication-semisync-installation">16.2.9.2. Semisynchronous Replication Installation and Configuration</a></span></dt><dt><span class="section"><a href="replication.html#replication-semisync-monitoring">16.2.9.3. Semisynchronous Replication Monitoring</a></span></dt></dl></div><a class="indexterm" name="id3558846"></a><a class="indexterm" name="id3558856"></a><p>
      MySQL 6.0 supports an interface to semisynchronous
      replication in addition to the built-in asynchronous replication.
      This section discusses what semisynchronous replication is and how
      it works. The following sections cover the adminstrative interface
      to semisynchronous replication and how to install, configure, and
      monitor it.
    </p><p>
      MySQL replication by default is asynchronous. The master writes
      events to its binary log but does not know whether or when a slave
      has retrieved and processed them. With asynchronous replication,
      if the master crashes, transactions that it has committed might
      not have been transmitted to any slave. Consequently, failover
      from master to slave in this case may result in failover to a
      server that is missing transactions relative to the master.
    </p><p>
      As of MySQL 6.0.8, semisynchronous replication can be used
      instead:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          A slave indicates whether it is semisynchronous-capable when
          it connects to the master.
        </p></li><li><p>
          If semisynchronous replication is enabled on the master side
          and there is at least one semisynchronous slave, a thread that
          performs a transaction commit on the master blocks after the
          commit is done and waits until at least one semisynchronous
          slave acknowledges that it has received all events for the
          transaction, or until a timeout occurs.
        </p></li><li><p>
          The slave acknowledges receipt of a transaction's events only
          after the events have been written to its relay log and
          flushed to disk.
        </p></li><li><p>
          If a timeout occurs without any slave having acknowledged the
          transaction, the master reverts to asynchronous replication.
          When at least one semisynchronous slave catches up, the master
          returns to semisynchronous replication.
        </p></li><li><p>
          Semisynchronous replication must be enabled on both the master
          and slave sides. If semisynchronous replication is disabled on
          the master, or enabled on the master but on no slaves, the
          master uses asynchronous replication.
        </p></li></ul></div><p>
      While the master is blocking (waiting for acknowledgment from a
      slave after having performed a commit), it does not return to the
      session that performed the transaction. When the block ends, the
      master returns to the session, which then can proceed to execute
      other statements. At this point, the transaction has committed on
      the master side, and receipt of its events has been acknowledged
      by at least one slave.
    </p><p>
      Blocking also occurs after rollbacks that are written to the
      binary log, which occurs when a transaction that modifies
      non-transactional tables is rolled back. The rolled-back
      transaction is logged even though it has no effect for
      transactional tables because the modifications to the
      non-transactional tables cannot be rolled back and must be sent to
      slaves.
    </p><p>
      For statements that do not occur in transactional context (that
      is, when no transaction has been started with
      <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">START
      TRANSACTION</code></a> or <code class="literal">SET autocommit = 0</code>),
      autocommit is enabled and each statement commits implicitly. With
      semisynchronous replication, the master blocks after committing
      each such statement, just as it does for explicit transaction
      commits.
    </p><p>
      To understand what the “<span class="quote">semi</span>” in
      “<span class="quote">semisynchronous replication</span>” means, compare it with
      asynchronous and fully synchronous replication:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          With asynchronous replication, the master writes events to its
          binary log and slaves request them when they are ready. There
          is no guarantee that any event will ever reach any slave.
        </p></li><li><p>
          With fully synchronous replication, when a master commits a
          transaction, all slaves also will have committed the
          transaction before the master returns to the session that
          performed the transaction. The drawback of this is that there
          might be a lot of delay to complete a transaction.
        </p></li><li><p>
          Semisynchronous replication falls between asynchronous and
          fully synchronous replication. The master waits after commit
          only until at least one slave has received and logged the
          events. It does not wait for all slaves to acknowledge
          receipt, and it requires only receipt, not that the events
          have been fully executed and committed on the slave side.
        </p></li></ul></div><p>
      Compared to asynchronous replication, semisynchronous replication
      provides improved data integrity. When a commit returns
      successfully, it is known that the data exists in at least two
      places (on the master and at least one slave). If the master
      commits but a crash occurs while the master is waiting for
      acknowledgment from a slave, it is possible that the transaction
      may not have reached any slave.
    </p><p>
      Semisynchronous replication does have some performance impact
      because commits are slower due to the need to wait for slaves.
      This is the tradeoff for increased data integrity. The amount of
      slowdown is at least the TCP/IP roundtrip time to send the commit
      to the slave and wait for the acknowledgment of receipt by the
      slave. This means that semisynchronous replication works best for
      close servers communicating over fast networks, and worst for
      distant servers communicating over slow networks.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-semisync-interface"></a>16.2.9.1. Semisynchronous Replication Administrative Interface</h4></div></div></div><a class="indexterm" name="id3559079"></a><p>
        The administrative interface to semisynchronous replication has
        several components:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Two plugins implement semisynchronous capability. There is
            one plugin for the master side and one for the slave side.
          </p></li><li><p>
            System variables control plugin behavior:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <a href="server-administration.html#sysvar_rpl_semi_sync_master_enabled"><code class="literal">rpl_semi_sync_master_enabled</code></a>
              </p><p>
                Controls whether semisynchronous replication is enabled
                on the master. To enable or disable the plugin, set this
                variable to 1 or 0, respectively. The default is 1.
              </p></li><li><p>
                <a href="server-administration.html#sysvar_rpl_semi_sync_master_timeout"><code class="literal">rpl_semi_sync_master_timeout</code></a>
              </p><p>
                A value in seconds that controls how long the master
                waits on a commit for acknowledgment from a slave before
                timing out and reverting to asynchronous replication.
                The default value is 10 seconds.
              </p></li><li><p>
                <a href="server-administration.html#sysvar_rpl_semi_sync_slave_enabled"><code class="literal">rpl_semi_sync_slave_enabled</code></a>
              </p><p>
                Similar to
                <a href="server-administration.html#sysvar_rpl_semi_sync_master_enabled"><code class="literal">rpl_semi_sync_master_enabled</code></a>,
                but controls the slave plugin.
              </p></li></ul></div></li><li><p>
            Status variables enable semisynchronous replication
            monitoring:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <a href="server-administration.html#statvar_Rpl_semi_sync_master_clients"><code class="literal">Rpl_semi_sync_master_clients</code></a>
              </p><p>
                The number of semisynchronous slaves.
              </p></li><li><p>
                <a href="server-administration.html#statvar_Rpl_semi_sync_master_status"><code class="literal">Rpl_semi_sync_master_status</code></a>
              </p><p>
                Whether semisynchronous replication currently is
                operational on the master. The value is 1 if the plugin
                has been enabled and a commit acknowledgment has not
                occurred. It is 0 if the plugin is not enabled or the
                master has fallen back to asynchronous replication due
                to commit acknowledgment timeout.
              </p></li><li><p>
                <a href="server-administration.html#statvar_Rpl_semi_sync_master_no_tx"><code class="literal">Rpl_semi_sync_master_no_tx</code></a>
              </p><p>
                The number of commits that were not acknowledged
                successfully by a slave.
              </p></li><li><p>
                <a href="server-administration.html#statvar_Rpl_semi_sync_master_yes_tx"><code class="literal">Rpl_semi_sync_master_yes_tx</code></a>
              </p><p>
                The number of commits that were acknowledged
                successfully by a slave.
              </p></li><li><p>
                <a href="server-administration.html#statvar_Rpl_semi_sync_slave_status"><code class="literal">Rpl_semi_sync_slave_status</code></a>
              </p><p>
                Whether semisynchronous replication currently is
                operational on the slave. This is 1 if the plugin has
                been enabled and the slave I/O thread is running, 0
                otherwise.
              </p></li></ul></div></li></ul></div><p>
        The system and status variables are available only if the
        appropriate master or slave plugin has been installed with
        <a href="sql-syntax.html#install-plugin" title="12.5.4.3. INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-semisync-installation"></a>16.2.9.2. Semisynchronous Replication Installation and Configuration</h4></div></div></div><a class="indexterm" name="id3559327"></a><a class="indexterm" name="id3559340"></a><p>
        Semisynchronous replication is implemented using plugins, so the
        plugins must be installed into the server to make them
        available. After a plugin has been installed, you control it by
        means of the system variables associated with it. These system
        variables are unavailable until the associated plugin has been
        installed.
      </p><p>
        To use semisynchronous replication, the following requirements
        must be satisfied:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            MySQL 6.0.8 or higher must be installed.
          </p></li><li><p>
            The capability of installing plugins requires a MySQL server
            that supports dynamic loading. To verify this, check that
            the value of the
            <a href="server-administration.html#sysvar_have_dynamic_loading"><code class="literal">have_dynamic_loading</code></a> system
            variable is <code class="literal">YES</code>. Binary distributions
            should support dynamic loading. If you compile MySQL from
            source, do not configure the source distribution with the
            <code class="option">--with-mysqld-ldflags=-all-static</code> option.
          </p></li><li><p>
            Replication must already be working. For information on
            creating a master/slave relationship, see
            <a href="replication.html#replication-howto" title="16.1.1. How to Set Up Replication">Section 16.1.1, “How to Set Up Replication”</a>.
          </p></li></ul></div><p>
        To set up semisynchronous replication, use the following
        instructions. The <a href="sql-syntax.html#install-plugin" title="12.5.4.3. INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a>,
        <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET
        GLOBAL</code></a>, <a href="sql-syntax.html#stop-slave" title="12.6.2.6. STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>, and
        <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statements mentioned
        here require the <a href="server-administration.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        Obtain the semisynchronous replication plugins. They are not
        included with MySQL distributions. Instead, they are distributed
        as a separate component. The initial preview release may be
        obtained from
        <a href="http://downloads.mysql.com/forge/replication_preview" target="_top">http://downloads.mysql.com/forge/replication_preview</a>.
      </p><p>
        Currently, the plugins are available only for Linux. Other
        platforms are is not yet supported.
      </p><p>
        Unpack the component distribution, which contains files for the
        master side and the slave side.
      </p><p>
        Install the component files in the plugin directory of the
        appropriate server. Install the
        <code class="filename">libsemisync_master*</code> files in the plugin
        directory of the master server. Install the
        <code class="filename">libsemisync_slave*</code> files in the plugin
        directory of each slave server. The location of the plugin
        directory is available as the value of the server's
        <a href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable.
      </p><p>
        To load the plugins, use the <a href="sql-syntax.html#install-plugin" title="12.5.4.3. INSTALL PLUGIN Syntax"><code class="literal">INSTALL
        PLUGIN</code></a> statement on the master and on each slave that
        is to be semisynchronous.
      </p><p>
        On the master:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSTALL PLUGIN rpl_semi_sync_master SONAME 'libsemisync_master.so';</code></strong>
</pre><p>
        On each slave:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>INSTALL PLUGIN rpl_semi_sync_slave SONAME 'libsemisync_slave.so';</code></strong>
</pre><p>
        The preceding commands use a plugin file name suffix of
        <code class="filename">.so</code>. A different suffix might apply on your
        system. If you are not sure about the plugin file name, look for
        the plugins in the server's plugin directory.
      </p><p>
        To see which plugins are installed, use the
        <a href="sql-syntax.html#show-plugins" title="12.5.6.26. SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> statement, or query
        the <a href="information-schema.html#plugins-table" title="19.17. The INFORMATION_SCHEMA PLUGINS Table"><code class="literal">INFORMATION_SCHEMA.PLUGINS</code></a>
        table.
      </p><p>
        After a semisynchronous replication plugin has been installed,
        it is enabled by default. The plugins must be enabled both on
        the master side and the slave side to enable semisynchronous
        replication. If only one side is enabled, replication will be
        asynchronous.
      </p><p>
        To control an installed plugin, set the appropriate system
        variables. You can set these variables at runtime using
        <a href="sql-syntax.html#set-option" title="12.5.5. SET Syntax"><code class="literal">SET
        GLOBAL</code></a>, or at server startup on the command line or in
        an option file.
      </p><p>
        At runtime, these master-side system variables are available:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET GLOBAL rpl_semi_sync_master_enabled = {0|1};</code></strong>
mysql&gt; <strong class="userinput"><code>SET GLOBAL rpl_semi_sync_master_timeout = <em class="replaceable"><code>N</code></em>;</code></strong>
</pre><p>
        On the slave side, this system variable is available:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET GLOBAL rpl_semi_sync_slave_enabled = {0|1};</code></strong>
</pre><p>
        For
        <a href="server-administration.html#sysvar_rpl_semi_sync_master_enabled"><code class="literal">rpl_semi_sync_master_enabled</code></a> or
        <a href="server-administration.html#sysvar_rpl_semi_sync_slave_enabled"><code class="literal">rpl_semi_sync_slave_enabled</code></a>,
        the value should be 1 to enable semisynchronous replication or 0
        to disable it. By default, these variables are set to 1.
      </p><p>
        For
        <a href="server-administration.html#sysvar_rpl_semi_sync_master_timeout"><code class="literal">rpl_semi_sync_master_timeout</code></a>,
        the value <em class="replaceable"><code>N</code></em> is given in seconds. The
        default value is 10.
      </p><p>
        If you enable semisynchronous replication on a slave at runtime,
        you must also start the slave I/O thread (stopping it first if
        it is already running) to cause the slave to connect to the
        master and register as a semisynchronous slave:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>STOP SLAVE IO_THREAD; START SLAVE IO_THREAD;</code></strong>
</pre><p>
        If the I/O thread is already running and you do not restart it,
        the slave continues to use asynchronous replication.
      </p><p>
        At server startup, the variables that control semisynchronous
        replication can be set as command-line options or in an option
        file. A setting listed in an option file takes effect each time
        the server starts. For example, you can set the variables in
        <code class="filename">my.cnf</code> files on the master and slave sides
        as follows.
      </p><p>
        On the master:
      </p><pre class="programlisting">[mysqld]
rpl_semi_sync_master_enabled=1
rpl_semi_sync_master_timeout=10
</pre><p>
        On each slave:
      </p><pre class="programlisting">[mysqld]
rpl_semi_sync_slave_enabled=1
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-semisync-monitoring"></a>16.2.9.3. Semisynchronous Replication Monitoring</h4></div></div></div><a class="indexterm" name="id3559772"></a><p>
        The plugins for the semisynchronous replication capability
        expose several system and status variables that you can examine
        to determine its configuration and operational state.
      </p><p>
        The system variable reflect how semisynchronous replication is
        configured. To check their values, use <a href="sql-syntax.html#show-variables" title="12.5.6.39. SHOW VARIABLES Syntax"><code class="literal">SHOW
        VARIABLES</code></a>:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'rpl_semi_sync%';</code></strong>
</pre><p>
        The status variables enable you to monitor the operation of
        semisynchronous replication. To check their values, use
        <a href="sql-syntax.html#show-status" title="12.5.6.35. SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'Rpl_semi_sync%';</code></strong>
</pre><p>
        When the master switches between asynchronous or semisynchronous
        replication due to commit-blocking timeout or a slave catching
        up, it sets the value of the
        <a href="server-administration.html#statvar_Rpl_semi_sync_master_status"><code class="literal">Rpl_semi_sync_master_status</code></a>
        status variable appropriately. Automatic fallback from
        semisynchronous to asynchronous replication on the master means
        that it is possible for the
        <a href="server-administration.html#sysvar_rpl_semi_sync_master_enabled"><code class="literal">rpl_semi_sync_master_enabled</code></a>
        system variable to have a value of 1 on the master side even
        when semisynchronous replication is in fact not operational at
        the moment. You can monitor the
        <a href="server-administration.html#statvar_Rpl_semi_sync_master_status"><code class="literal">Rpl_semi_sync_master_status</code></a>
        status variable to determine whether the master currently is
        using asynchronous or semisynchronous replication.
      </p><p>
        To see how many semisynchronous slaves are connected, check
        <a href="server-administration.html#statvar_Rpl_semi_sync_master_clients"><code class="literal">Rpl_semi_sync_master_clients</code></a>.
      </p><p>
        The number of commits that have been acknowledged successfully
        or unsucessfully by slaves are indicated by the
        <a href="server-administration.html#statvar_Rpl_semi_sync_master_yes_tx"><code class="literal">Rpl_semi_sync_master_yes_tx</code></a>
        and <a href="server-administration.html#statvar_Rpl_semi_sync_master_no_tx"><code class="literal">Rpl_semi_sync_master_no_tx</code></a>
        variables.
      </p><p>
        On the slave side,
        <a href="server-administration.html#statvar_Rpl_semi_sync_slave_status"><code class="literal">Rpl_semi_sync_slave_status</code></a>
        indicates whether semisynchronous replication currently is
        operational.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="replication-notes"></a>16.3. Replication Notes and Tips</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-features">16.3.1. Replication Features and Issues</a></span></dt><dt><span class="section"><a href="replication.html#replication-compatibility">16.3.2. Replication Compatibility Between MySQL Versions</a></span></dt><dt><span class="section"><a href="replication.html#replication-upgrade">16.3.3. Upgrading a Replication Setup</a></span></dt><dt><span class="section"><a href="replication.html#replication-faq">16.3.4. Replication FAQ</a></span></dt><dt><span class="section"><a href="replication.html#replication-problems">16.3.5. Troubleshooting Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-bugs">16.3.6. How to Report Replication Bugs or Problems</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-features"></a>16.3.1. Replication Features and Issues</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-features-auto-increment">16.3.1.1. Replication and <code class="literal">AUTO_INCREMENT</code></a></span></dt><dt><span class="section"><a href="replication.html#replication-features-charset">16.3.1.2. Replication and Character Sets</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-create-select">16.3.1.3. Replication of <code class="literal">CREATE
        TABLE ... SELECT</code> Statements</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-differing-tables">16.3.1.4. Replication with Differing Tables on Master and Slave</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-directory">16.3.1.5. Replication and <code class="literal">DIRECTORY</code> Table Options</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-drop-if-exists">16.3.1.6. Replication of <code class="literal">DROP ... IF EXISTS</code> Statements</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-invoked">16.3.1.7. Replication of Invoked Features</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-floatvalues">16.3.1.8. Replication with Floating-Point Values</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-flush">16.3.1.9. Replication and <code class="literal">FLUSH</code></a></span></dt><dt><span class="section"><a href="replication.html#replication-features-functions">16.3.1.10. Replication and System Functions</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-limit">16.3.1.11. Replication and <code class="literal">LIMIT</code></a></span></dt><dt><span class="section"><a href="replication.html#replication-features-load-data">16.3.1.12. Replication and <code class="literal">LOAD DATA</code></a></span></dt><dt><span class="section"><a href="replication.html#replication-features-logging">16.3.1.13. Replication and the Slow Query Log</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-mastercrash">16.3.1.14. Replication During a Master Crash</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-mastershutdown">16.3.1.15. Replication During a Master Shutdown</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-memory">16.3.1.16. Replication with <code class="literal">MEMORY</code> Tables</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-mysqldb">16.3.1.17. Replication of the System <code class="literal">mysql</code> Database</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-optimizer">16.3.1.18. Replication and the Query Optimizer</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-reserved-words">16.3.1.19. Replication and Reserved Words</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-slaveerrors">16.3.1.20. Slave Errors during Replication</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-slaveshutdown">16.3.1.21. Replication during a Slave Shutdown</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-temptables">16.3.1.22. Replication and Temporary Tables</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-timeout">16.3.1.23. Replication Retries and Timeouts</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-timezone">16.3.1.24. Replication and Time Zones</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-transactions">16.3.1.25. Replication and Transactions</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-triggers">16.3.1.26. Replication and Triggers</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-truncate">16.3.1.27. Replication and <code class="literal">TRUNCATE</code></a></span></dt><dt><span class="section"><a href="replication.html#replication-features-variables">16.3.1.28. Replication and Variables</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-views">16.3.1.29. Replication and Views</a></span></dt></dl></div><a class="indexterm" name="id3559946"></a><a class="indexterm" name="id3559959"></a><a class="indexterm" name="id3559968"></a><a class="indexterm" name="id3559980"></a><a class="indexterm" name="id3559990"></a><a class="indexterm" name="id3559998"></a><p>
      The following sections provide information about what is supported
      and what is not in MySQL replication, and about specific issues
      and situations that may occur when replicating certain statements.
    </p><p>
      Statement-based replication depends on compatibility at the SQL
      level between the master and slave. In others, successful SBR
      requires that any SQL features used be supported by both the
      master and the slave servers. For example, if you use a feature on
      the master server that is available only in MySQL 6.0
      (or later), you cannot replicate to a slave that uses MySQL
      5.1 (or earlier).
    </p><p>
      Such incompatibilities also can occur within a release series when
      using pre-production releases of MySQL. For example, the
      <a href="functions.html#function_sleep"><code class="literal">SLEEP()</code></a> function is available
      beginning with MySQL 5.0.12. If you use this function on the
      master, you cannot replicate to a slave that uses MySQL 5.0.11 or
      earlier.
    </p><p>
      For this reason, we recommend that you use Generally Available
      (GA) releases of MySQL for statement-based replication in a
      production setting, since we do not introduce new SQL statements
      or change their behavior within a given release series once that
      series reaches GA release status.
    </p><p>
      If you are planning to use statement-based replication between
      MySQL 6.0 and a previous MySQL release series, it is
      also a good idea to consult the edition of the <em class="citetitle">MySQL
      Reference Manual</em> corresponding to the earlier release
      series for information regarding the replication characteristics
      of that series.
    </p><p>
      With MySQL's classic statement-based replication, there may be
      issues with replicating stored routines or triggers. You can avoid
      these issues by using MySQL's row-based replication instead. For a
      detailed list of issues, see
      <a href="stored-programs-views.html#stored-programs-logging" title="18.6. Binary Logging of Stored Programs">Section 18.6, “Binary Logging of Stored Programs”</a>. For more information
      about row-based replication, see
      <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
    </p><p>
      For additional information specific to replication and
      <code class="literal">InnoDB</code>, see
      <a href="storage-engines.html#innodb-and-mysql-replication" title="13.7.4.5. InnoDB and MySQL Replication">Section 13.7.4.5, “<code class="literal">InnoDB</code> and MySQL Replication”</a>. For information
      relating to replication with MySQL Cluster, see
      <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-replication.html" target="_top">MySQL Cluster Replication</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-auto-increment"></a>16.3.1.1. Replication and <code class="literal">AUTO_INCREMENT</code></h4></div></div></div><a class="indexterm" name="id3560122"></a><a class="indexterm" name="id3560134"></a><a class="indexterm" name="id3560147"></a><a class="indexterm" name="id3560159"></a><a class="indexterm" name="id3560172"></a><a class="indexterm" name="id3560185"></a><p>
        Statement-based replication of
        <code class="literal">AUTO_INCREMENT</code>,
        <a href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a>, and
        <a href="data-types.html#datetime" title="10.3.1. The DATETIME,
        DATE, and
        TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> values is done
        correctly, subject to the following exceptions:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            An insert into an <code class="literal">AUTO_INCREMENT</code> column
            caused by a stored routine or trigger running on a master
            that uses MySQL 5.0.60 or earlier does not replicate
            correctly to a slave running MySQL 5.1.12 through 5.1.23
            (inclusive). (<a href="http://bugs.mysql.com/33029" target="_top">Bug#33029</a>)
          </p></li><li><p>
            Table-level <code class="literal">AUTO_INCREMENT</code> option values
            were not replicated correctly prior to MySQL 6.0.10. (<a href="http://bugs.mysql.com/41986" target="_top">Bug#41986</a>)
          </p></li><li><p>
            Adding an <code class="literal">AUTO_INCREMENT</code> column to a
            table with <a href="sql-syntax.html#alter-table" title="12.1.6. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> might
            not produce the same ordering of the rows on the slave and
            the master. This occurs because the order in which the rows
            are numbered depends on the specific storage engine used for
            the table and the order in which the rows were inserted. If
            it is important to have the same order on the master and
            slave, the rows must be ordered before assigning an
            <code class="literal">AUTO_INCREMENT</code> number. Assuming that you
            want to add an <code class="literal">AUTO_INCREMENT</code> column to
            the table <code class="literal">t1</code>, the following statements
            produce a new table <code class="literal">t2</code> identical to
            <code class="literal">t1</code> but with an
            <code class="literal">AUTO_INCREMENT</code> column:
          </p><pre class="programlisting">CREATE TABLE t2 LIKE t1;
ALTER TABLE t2 ADD id INT AUTO_INCREMENT PRIMARY KEY;
INSERT INTO t2 SELECT * FROM t1 ORDER BY col1, col2;
</pre><p>
            This assumes that the table <code class="literal">t1</code> has
            columns <code class="literal">col1</code> and <code class="literal">col2</code>.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              To guarantee the same ordering on both master and slave,
              <span class="emphasis"><em>all</em></span> columns of <code class="literal">t1</code>
              must be referenced in the <code class="literal">ORDER BY</code>
              clause.
            </p></div><p>
            The instructions just given are subject to the limitations
            of <code class="literal">CREATE TABLE ... LIKE</code>: Foreign key
            definitions are ignored, as are the <code class="literal">DATA
            DIRECTORY</code> and <code class="literal">INDEX DIRECTORY</code>
            table options. If a table definition includes any of those
            characteristics, create <code class="literal">t2</code> using a
            <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement that
            is identical to the one used to create
            <code class="literal">t1</code>, but with the addition of the
            <code class="literal">AUTO_INCREMENT</code> column.
          </p><p>
            Regardless of the method used to create and populate the
            copy having the <code class="literal">AUTO_INCREMENT</code> column,
            the final step is to drop the original table and then rename
            the copy:
          </p><pre class="programlisting">DROP t1;
ALTER TABLE t2 RENAME t1;
</pre><p>
            See also <a href="error-handling.html#alter-table-problems" title="B.1.7.1. Problems with ALTER TABLE">Section B.1.7.1, “Problems with <code class="literal">ALTER TABLE</code>”</a>.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-charset"></a>16.3.1.2. Replication and Character Sets</h4></div></div></div><a class="indexterm" name="id3560482"></a><a class="indexterm" name="id3560494"></a><p>
        The following applies to replication between MySQL servers that
        use different character sets:
      </p><div class="orderedlist"><ol type="1"><li><p>
            If the master uses MySQL 4.1, you must
            <span class="emphasis"><em>always</em></span> use the same
            <span class="emphasis"><em>global</em></span> character set and collation on
            the master and the slave, regardless of the MySQL version
            running on the slave. (These are controlled by the
            <a href="server-administration.html#option_mysqld_character-set-server"><code class="option">--character-set-server</code></a> and
            <a href="server-administration.html#option_mysqld_collation-server"><code class="option">--collation-server</code></a> options.)
            Otherwise, you may get duplicate-key errors on the slave,
            because a key that is unique in the master character set
            might not be unique in the slave character set. Note that
            this is not a cause for concern when master and slave are
            both MySQL 5.0 or later.
          </p></li><li><p>
            If the master is older than MySQL 4.1.3, the character set
            of any client should never be made different from its global
            value because this character set change is not known to the
            slave. In other words, clients should not use <code class="literal">SET
            NAMES</code>, <code class="literal">SET CHARACTER SET</code>, and
            so forth. If both the master and the slave are 4.1.3 or
            newer, clients can freely set session values for character
            set variables because these settings are written to the
            binary log and so are known to the slave. That is, clients
            can use <code class="literal">SET NAMES</code> or <code class="literal">SET
            CHARACTER SET</code> or can set variables such as
            <code class="literal">collation_client</code> or
            <a href="server-administration.html#sysvar_collation_server"><code class="literal">collation_server</code></a>. However,
            clients are prevented from changing the
            <span class="emphasis"><em>global</em></span> value of these variables; as
            stated previously, the master and slave must always have
            identical global character set values. This is true whether
            you are using statement-based or row-based replication.
          </p></li><li><p>
            If you have databases on the master with character sets that
            differ from the global
            <a href="server-administration.html#sysvar_character_set_server"><code class="literal">character_set_server</code></a> value,
            you should design your <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
            TABLE</code></a> statements so that tables in those databases
            do not implicitly rely on the database default character
            set. A good workaround is to state the character set and
            collation explicitly in <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
            TABLE</code></a> statements.
          </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-create-select"></a>16.3.1.3. Replication of <code class="literal">CREATE
        TABLE ... SELECT</code> Statements</h4></div></div></div><a class="indexterm" name="id3560672"></a><a class="indexterm" name="id3560685"></a><p>
        This section discusses the rules that are applied when a
        <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a> statement is replicated.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          SELECT</code></a> always performs an implicit commit
          (<a href="sql-syntax.html#implicit-commit" title="12.4.3. Statements That Cause an Implicit Commit">Section 12.4.3, “Statements That Cause an Implicit Commit”</a>).
        </p></div><p><b>Statement succeeds. </b>
          If the <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE ... SELECT</code></a> statement succeeds on the master,
          then it is replicated as follows:

          </p><div class="itemizedlist"><ul type="disc"><li><p><b><code class="literal">STATEMENT</code> or <code class="literal">MIXED</code> format. </b>
                  The
                  <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
                  TABLE ... SELECT</code></a> statement is itself
                  replicated.
                </p></li><li><p><b><code class="literal">ROW</code> format. </b>
                  The statement is replicated as a
                  <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
                  followed by a series of <code class="literal">binwrite</code>
                  events (that is, binary inserts).
                </p></li></ul></div><p>
        </p><p><b>Statement fails. </b>
          The failure of a
          <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          SELECT</code></a> is handled according to the following
          criteria:

          </p><div class="itemizedlist"><ul type="disc"><li><p><b>No <code class="literal">IF NOT EXISTS</code> option. </b>
                  If the
                  <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
                  TABLE ... SELECT</code></a> does not contain an
                  <code class="literal">IF NOT EXISTS</code> option, then the
                  statement has no effect. However, the implicit commit
                  caused by the statement is logged. This is true
                  regardless of the replication format, storage engine
                  used, and the reason for which the statement failed.
                </p></li><li><p><b>Statement uses <code class="literal">IF NOT EXISTS</code>. </b>
                  If the
                  <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
                  TABLE ... SELECT</code></a> statement includes the
                  <code class="literal">IF NOT EXISTS</code> option and fails, the
                  failure is handled according to the replication
                  format. If the row-based format is in use, the action
                  taken depends additionally on whether or not the table
                  to be created uses a transactional or
                  non-transactional storage engine, and on the reason
                  for the failure:

                  </p><div class="itemizedlist"><ul type="circle"><li><p><b><code class="literal">STATEMENT</code> or <code class="literal">MIXED</code> format. </b>
                          When using statement-based or mixed-format
                          replication, the <code class="literal">CREATE TABLE IF NOT
                          EXISTS ... SELECT</code> is logged with an
                          error.
                        </p></li><li><p><b><code class="literal">ROW</code> format. </b>
                          When row-based replication is used, failure of
                          a
                          <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE
                          TABLE ... SELECT</code></a> that includes
                          <code class="literal">IF NOT EXISTS</code> is handled
                          differently depending on the reason for the
                          failure, as shown in the following diagram:

                          </p><div class="mediaobject"><img src="images/rpl-create-select-failure-rbr.png" width="514" height="241" alt="CREATE TABLE IF
                              NOT EXISTS ... SELECT Failure
                              Handling (RBR)"></div><p>
                        </p></li></ul></div><p>
                </p></li></ul></div><p>
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-differing-tables"></a>16.3.1.4. Replication with Differing Tables on Master and Slave</h4></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-features-more-columns">16.3.1.4.1. Replication with More Columns on Master or Slave</a></span></dt><dt><span class="section"><a href="replication.html#replication-features-different-data-types">16.3.1.4.2. Replication of Columns Having Different Data Types</a></span></dt></dl></div><a class="indexterm" name="id3561041"></a><p>
        Source and target tables for replication do not have to be
        identical. A table on the master can have more or fewer columns
        than the slave's copy of the table. In addition —
        subject to certain conditions — corresponding table
        columns on the master and the slave can use different data
        types.
      </p><p>
        In all cases where the source and target tables do not have
        identical definitions, the following must be true in order for
        replication to work:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              You must be using row-based replication. (Using
              <code class="literal">MIXED</code> for the binary logging format
              does not work.)
            </p></li><li><p>
              The database and table names must be the same on both the
              master and the slave.
            </p></li></ul></div><p>

        Additional conditions are discussed (and examples provided) in
        the following two sections.
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="replication-features-more-columns"></a>16.3.1.4.1. Replication with More Columns on Master or Slave</h5></div></div></div><p>
          You can replicate a table from the master to the slave such
          that the master's copy of the table and the slave's
          copy of the table do not have the same number of columns,
          subject to the following conditions:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                Each “<span class="quote">extra</span>” column in the version of the
                table having more columns must have a default value.
              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  A column's default value is determined by a
                  number of factors, including its type, whether it is
                  defined with a <code class="literal">DEFAULT</code> option,
                  whether it is declared as <code class="literal">NULL</code>, and
                  the server SQL mode in effect at the time of its
                  creation; see <a href="data-types.html#data-type-defaults" title="10.1.4. Data Type Default Values">Section 10.1.4, “Data Type Default Values”</a>),
                  for more information.
                </p></div></li><li><p>
                Matching columns must be defined in the same order on
                both the master and the slave.
              </p></li><li><p>
                Any additional columns must be defined following the
                matching columns.
              </p></li></ul></div><p>

          In addition, when the slave's copy of the table has more
          columns than the master's copy, then each matching column
          must use the same data type.
        </p><p><b>Examples. </b>
            The following examples illustrate some valid and invalid
            table definitions:

            </p><div class="itemizedlist"><ul type="disc"><li><p><b>More columns on the master. </b>
                    The following table definitions are valid:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT, c3 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT);</code></strong>
</pre><p>

                    The following table definitions would raise Error
                    1532
                    (<span class="errorname">ER_BINLOG_ROW_RBR_TO_SBR</span>)
                    because the definitions of the columns common to
                    both versions of the table are in a different order
                    on the slave than they are on the master:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT, c3 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c2 INT, c1 INT);</code></strong>
</pre><p>

                    The following table definitions would also raise
                    Error 1532, because the definition of the extra
                    column on the master appears before the definitions
                    of the columns common to both versions of the table:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c3 INT, c1 INT, c2 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT);</code></strong>
</pre><p>
                  </p></li><li><p><b>More columns on the slave. </b>
                    The following definitions replicate correctly:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT, c3 INT);</code></strong>
                  </pre><p>

                    The following definitions raise Error 1532 because
                    the columns common to both versions of the table are
                    not defined in the same order on both the master and
                    the slave:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c2 INT, c1 INT, c3 INT);</code></strong>
</pre><p>

                    The following table definitions also raise Error
                    1532 because the definition for the extra column in
                    the slave's version of the table appears before
                    the definitions for the columns which are common to
                    both versions of the table:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c3 INT, c1 INT, c2 INT);</code></strong>
</pre><p>

                    The following table definitions fail, because the
                    slave's version of the table has additional
                    columns compared to the master's version, and
                    the two versions of the table define column
                    <code class="literal">c2</code> as a different data type.

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 BIGINT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 INT, c3 INT);</code></strong>
</pre><p>
                  </p></li></ul></div><p>
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="replication-features-different-data-types"></a>16.3.1.4.2. Replication of Columns Having Different Data Types</h5></div></div></div><p>
          Corresponding columns on the master's and the
          slave's copies of the same table should have the same
          type. However, this is not always strictly enforced, as long
          as certain conditions are met. These conditions are listed
          here:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                The slave's copy of the table cannot contain more
                columns than the master's copy.
              </p></li><li><p>
                <a class="indexterm" name="id3561430"></a>

                <a class="indexterm" name="id3561442"></a>

                For columns holding numeric data types, the sizes may
                differ, as long as the size of the slave's version
                of the column is equal or greater to the size of the
                master's version of the column. This is sometimes
                referred to as <em class="firstterm">attribute
                promotion</em>, because the data type of the
                master's version of the column is promoted to a
                type that is the same size or larger on the slave.
              </p><p>
                Data type conversions currently supported by attribute
                promotion are shown in the following table, in which
                <em class="replaceable"><code>X</code></em> and
                <em class="replaceable"><code>N</code></em> both represent positive
                integers.
              </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Original Data Type</th><th>Promoted Data Type(s)</th></tr></thead><tbody><tr><td><code class="literal">CHAR(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">CHAR(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">VARCHAR(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">VARCHAR(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">CHAR(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">VARCHAR(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">BINARY(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">BINARY(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">VARBINARY(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">VARBINARY(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">BINARY(<em class="replaceable"><code>X</code></em>)</code></td><td><code class="literal">VARBINARY(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><code class="literal">BIT(<em class="replaceable"><code>X</code></em>) </code></td><td><code class="literal">BIT(<em class="replaceable"><code>X</code></em>+<em class="replaceable"><code>N</code></em>)</code></td></tr><tr><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">TINYINT</code></a></td><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">SMALLINT</code></a>,
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">MEDIUMINT</code></a>,
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">INT</code></a>, or
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">BIGINT</code></a></td></tr><tr><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">SMALLINT</code></a></td><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">MEDIUMINT</code></a>,
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">INT</code></a>, or
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">BIGINT</code></a></td></tr><tr><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">MEDIUMINT</code></a></td><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">INT</code></a> or
                        <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">BIGINT</code></a></td></tr><tr><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">INT</code></a></td><td><a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">BIGINT</code></a></td></tr></tbody></table></div><p>
                Unsigned integer columns can be promoted to larger
                unsigned types; for example, a column declared as
                <code class="literal">TINYINT UNSIGNED</code> can be restored to a
                column declared as <code class="literal">SMALLINT UNSIGNED</code>,
                <code class="literal">MEDIUMINT UNSIGNED</code>, <code class="literal">INT
                UNSIGNED</code>, or <code class="literal">BIGINT
                UNSIGNED</code>. You cannot promote a signed column
                to an unsigned type, or an unsigned column to a signed
                type.
              </p><p>
                For columns holding numeric data types the sizes may
                differ, as long as the size of the slave's version
                of the column is equal or greater to the size of the
                master's version of the column. For example, the
                following table definitions are allowed:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 TINYINT, c2 INT);</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT,     c2 INT);</code></strong>
</pre><p>

                The slave's versions of both columns
                <code class="literal">c1</code> and <code class="literal">c2</code> are the
                same size as or larger than the master's versions
                of these columns. However, the following definitions
                would fail:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 FLOAT(8,3));</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 FLOAT(7,3));</code></strong>
</pre><p>

                In this case, Error 1532 would be raised because the
                master's copy of column <code class="literal">c2</code> is
                larger than its counterpart on the slave — that
                is, the master's copy of <code class="literal">c2</code> on
                the master can hold more digits than the slave's
                copy of the column.
              </p></li><li><p>
                There is no conversion between integer
                (<a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">TINYINT</code></a>,
                <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">SMALLINT</code></a>,
                <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">MEDIUMINT</code></a>, and so on) and
                non-integer (<a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">FLOAT</code></a>,
                <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">DOUBLE</code></a>,
                <a href="data-types.html#numeric-types" title="10.2. Numeric Types"><code class="literal">DECIMAL</code></a>, and so on)
                numeric data types, and so the following definitions
                would fail with Error 1532:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 FLOAT(8,3));</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 BIGINT);</code></strong>
</pre><p>

                A column using a non-integer numeric data type must
                always have the same definition on both the master and
                the slave.
              </p></li><li><p>
                For columns storing <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">CHAR</code></a>
                and <a href="data-types.html#binary-varbinary" title="10.4.2. The BINARY and
        VARBINARY Types"><code class="literal">BINARY</code></a> data, the size
                of the slave's copy of the column must be equal to
                or greater than the size of the master's copy. For
                example, the following table definitions would replicate
                successfully:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 CHAR(30));</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 CHAR(50));</code></strong>
</pre><p>

                If the size of the master's version of the column
                is greater than that of the slave's version of the
                column, replication fails with Error 1532.
              </p></li><li><p>
                The replication process can convert freely between
                <a href="data-types.html#binary-varbinary" title="10.4.2. The BINARY and
        VARBINARY Types"><code class="literal">BINARY</code></a>,
                <a href="data-types.html#binary-varbinary" title="10.4.2. The BINARY and
        VARBINARY Types"><code class="literal">VARBINARY</code></a>,
                <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">CHAR</code></a> and
                <a href="data-types.html#char" title="10.4.1. The CHAR and
        VARCHAR Types"><code class="literal">VARCHAR</code></a> columns, as long
                as the slave's version of the column is the same
                size as or larger than the master's version. For
                example, the following table definitions can be used
                successfully:

</p><pre class="programlisting">master&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 VARBINARY(30));</code></strong>
slave&gt;  <strong class="userinput"><code>CREATE TABLE t1 (c1 INT, c2 CHAR(30));</code></strong>
</pre><p>
              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  Since replication is currently not supported between
                  different character sets, it is sufficient when
                  comparing sizes of columns containing character data
                  to count the number of characters rather than the
                  number of bytes.
                </p></div></li><li><p>
                Attribute promotion can be used with both
                statement-based and row-based replication, and is not
                dependent on the storage engine used by either the
                master or the slave.
              </p></li></ul></div><p>
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-directory"></a>16.3.1.5. Replication and <code class="literal">DIRECTORY</code> Table Options</h4></div></div></div><a class="indexterm" name="id3562170"></a><a class="indexterm" name="id3562183"></a><a class="indexterm" name="id3562195"></a><a class="indexterm" name="id3562208"></a><a class="indexterm" name="id3562220"></a><p>
        If a <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
        DIRECTORY</code> table option is used in a
        <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement on the
        master server, the table option is also used on the slave. This
        can cause problems if no corresponding directory exists in the
        slave host file system or if it exists but is not accessible to
        the slave server. This can be overridden by using the
        <a href="server-administration.html#sqlmode_no_dir_in_create"><code class="literal">NO_DIR_IN_CREATE</code></a> server SQL
        mode on the slave, which causes the slave to ignore the
        <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
        DIRECTORY</code> table options when replicating
        <a href="sql-syntax.html#create-table" title="12.1.14. CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements. The
        result is that <code class="literal">MyISAM</code> data and index files
        are created in the table's database directory.
      </p><p>
        For more information, see <a href="server-administration.html#server-sql-mode" title="5.1.7. Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-drop-if-exists"></a>16.3.1.6. Replication of <code class="literal">DROP ... IF EXISTS</code> Statements</h4></div></div></div><a class="indexterm" name="id3562326"></a><a class="indexterm" name="id3562339"></a><p>
        The statements
        <a href="sql-syntax.html#drop-database" title="12.1.17. DROP DATABASE Syntax"><code class="literal">DROP DATABASE IF
        EXISTS</code></a>,
        <a href="sql-syntax.html#drop-table" title="12.1.23. DROP TABLE Syntax"><code class="literal">DROP TABLE IF
        EXISTS</code></a>, and
        <a href="sql-syntax.html#drop-view" title="12.1.25. DROP VIEW Syntax"><code class="literal">DROP VIEW IF
        EXISTS</code></a> are always replicated, even if the database,
        table, or view to be dropped does not exist on the master. This
        is to ensure that the object to be dropped no longer exists on
        either the master or the slave, once the slave has caught up
        with the master.
      </p><p>
        Beginning with MySQL 6.0.12, the statements
        <a href="sql-syntax.html#drop-procedure" title="12.1.21. DROP PROCEDURE and
      DROP FUNCTION Syntax"><code class="literal">DROP PROCEDURE
        IF EXISTS</code></a> and
        <a href="sql-syntax.html#drop-function" title="12.1.19. DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION IF
        EXISTS</code></a> are also replicated, even if the procedure or
        function to be dropped does not exist on the master. (<a href="http://bugs.mysql.com/13684" target="_top">Bug#13684</a>)
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-invoked"></a>16.3.1.7. Replication of Invoked Features</h4></div></div></div><a class="indexterm" name="id3562420"></a><a class="indexterm" name="id3562433"></a><a class="indexterm" name="id3562446"></a><a class="indexterm" name="id3562458"></a><a class="indexterm" name="id3562471"></a><a class="indexterm" name="id3562483"></a><a class="indexterm" name="id3562496"></a><p>
        Replication of invoked features such as scheduled events,
        user-defined functions (UDFs), stored routines (including both
        stored procedures and stored functions), and triggers provides
        the following characteristics:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              The effects of the feature are always replicated.
            </p></li><li><p>
              The following statements are replicated using
              statement-based replication:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    <a href="sql-syntax.html#create-event" title="12.1.9. CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#alter-event" title="12.1.2. ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#drop-event" title="12.1.18. DROP EVENT Syntax"><code class="literal">DROP EVENT</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#create-procedure" title="12.1.12. CREATE PROCEDURE and
      CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#drop-procedure" title="12.1.21. DROP PROCEDURE and
      DROP FUNCTION Syntax"><code class="literal">DROP PROCEDURE</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#create-function" title="12.1.10. CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#drop-function" title="12.1.19. DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#create-trigger" title="12.1.15. CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a>
                  </p></li><li><p>
                    <a href="sql-syntax.html#drop-trigger" title="12.1.24. DROP TRIGGER Syntax"><code class="literal">DROP TRIGGER</code></a>
                  </p></li></ul></div><p>
            </p><p>
              However, the <span class="emphasis"><em>effects</em></span> of features
              created, modified, or dropped using these statements are
              replicated using row-based replication.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                Attempting to replicate invoked features using
                statement-based replication produces the warning
                <span class="errortext">Statement is not safe to log in statement
                format</span>. For example, trying to replicate a
                UDF with statement-based replication generates this
                warning because it currently cannot be determined by the
                MySQL server whether the UDF is deterministic. If you
                are absolutely certain that the invoked feature's
                effects are deterministic, you can safely disregard such
                warnings.
              </p><p>
                In a future MySQL release, we may implement ways for
                users to indicate that such features are deterministic,
                so that they can be recognized by the server as
                “<span class="quote">safe</span>” for statement-based replication.
                (<a href="http://bugs.mysql.com/34597" target="_top">Bug#34597</a>)
              </p></div></li><li><p>
              In the case of <a href="sql-syntax.html#create-event" title="12.1.9. CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>
              and <a href="sql-syntax.html#alter-event" title="12.1.2. ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    The status of the event is set to
                    <code class="literal">SLAVESIDE_DISABLED</code> on the slave
                    regardless of the state specified (this does not
                    apply to <a href="sql-syntax.html#drop-event" title="12.1.18. DROP EVENT Syntax"><code class="literal">DROP EVENT</code></a>).
                  </p></li><li><p>
                    The master on which the event was created is
                    identified on the slave by its server ID. The
                    <code class="literal">ORIGINATOR</code> column in
                    <a href="information-schema.html#events-table" title="19.20. The INFORMATION_SCHEMA EVENTS Table"><code class="literal">INFORMATION_SCHEMA.EVENTS</code></a>
                    and the <code class="literal">originator</code> column in
                    <code class="literal">mysql.event</code> store this
                    information. (See <a href="information-schema.html#events-table" title="19.20. The INFORMATION_SCHEMA EVENTS Table">Section 19.20, “The <code class="literal">INFORMATION_SCHEMA EVENTS</code> Table”</a>,
                    and <a href="sql-syntax.html#show-events" title="12.5.6.19. SHOW EVENTS Syntax">Section 12.5.6.19, “<code class="literal">SHOW EVENTS</code> Syntax”</a>.)
                  </p></li></ul></div><p>
            </p></li><li><p>
              The feature implementation resides on the slave in a
              renewable state so that if the master fails, the slave can
              be used as the master without loss of event processing.
            </p></li></ul></div><p>
      </p><p>
        To determine whether there are any scheduled events on a MySQL
        server that were created on a different server (that was acting
        as a replication master), use <a href="sql-syntax.html#show-events" title="12.5.6.19. SHOW EVENTS Syntax"><code class="literal">SHOW
        EVENTS</code></a>, like this:

</p><pre class="programlisting">SHOW EVENTS 
    WHERE STATUS = 'SLAVESIDE_DISABLED';
</pre><p>

        Alternatively, you might wish to query the
        <a href="information-schema.html#events-table" title="19.20. The INFORMATION_SCHEMA EVENTS Table"><code class="literal">INFORMATION_SCHEMA.EVENTS</code></a> table as
        shown here:

</p><pre class="programlisting">SELECT EVENT_SCHEMA, EVENT_NAME, ORIGINATOR
    FROM INFORMATION_SCHEMA.EVENTS
    WHERE STATUS = 'SLAVESIDE_DISABLED';
</pre><p>
      </p><p>
        When promoting a replication slave having such events to a
        replication master, use the following query to enable the
        events:

</p><pre class="programlisting">UPDATE mysql.event 
    SET STATUS = 'ENABLED' 
    WHERE STATUS = 'SLAVESIDE_DISABLED';
</pre><p>

        If more than one master was involved in creating events on this
        slave, and you wish to enable events that were created only on a
        given master having the server ID
        <em class="replaceable"><code>master_id</code></em>, use the following query
        instead:

</p><pre class="programlisting">UPDATE mysql.event 
    SET STATUS = 'ENABLED' 
    WHERE ORIGINATOR = <em class="replaceable"><code>master_id</code></em> 
    AND STATUS = 'SLAVESIDE_DISABLED';
</pre><p>
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Before executing either of the previous two
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements, you should
          disable the Event Scheduler on the slave (using <code class="literal">SET
          GLOBAL EVENT_SCHEDULER = OFF;</code>), run the
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>, restart the server,
          then re-enable the Event Scheduler afterwards (using
          <code class="literal">SET GLOBAL EVENT_SCHEDULER = ON;</code>).
        </p><p>
          If you later demote the new master back to being a replication
          slave, you must disable manually all events enabled by the
          <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statement. You can do
          this by storing in a separate table the event names from the
          <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a> statement shown
          previously, or using an <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>
          statement to rename the events with a common prefix to
          identify them, as shown in this example:

</p><pre class="programlisting">UPDATE mysql.event
    SET name = CONCAT('replicated_', name)
    WHERE status = 'SLAVESIDE_DISABLED';
</pre><p>

          When demoting this server back to being a replication slave,
          you can then rename and disable the events like this:

</p><pre class="programlisting">UPDATE mysql.event
    SET name = REPLACE(name, 'replicated_', ''), 
        status = 'SLAVESIDE_DISABLED'
    WHERE INSTR(name, 'replicated_') = 1;
</pre><p>
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-floatvalues"></a>16.3.1.8. Replication with Floating-Point Values</h4></div></div></div><a class="indexterm" name="id3562979"></a><a class="indexterm" name="id3562991"></a><p>
        With statement-based replication, values are converted from
        decimal to binary. Because conversions between decimal and
        binary representations of them may be approximate, comparisons
        involving floating-point values are inexact. This is true for
        operations that use floating-point values explicitly, or that
        use values that are converted to floating-point implicitly.
        Comparisons of floating-point values might yield different
        results on master and slave servers due to differences in
        computer architecture, the compiler used to build MySQL, and so
        forth. See <a href="functions.html#type-conversion" title="11.2.2. Type Conversion in Expression Evaluation">Section 11.2.2, “Type Conversion in Expression Evaluation”</a>, and
        <a href="error-handling.html#problems-with-float" title="B.1.5.8. Problems with Floating-Point Comparisons">Section B.1.5.8, “Problems with Floating-Point Comparisons”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-flush"></a>16.3.1.9. Replication and <code class="literal">FLUSH</code></h4></div></div></div><a class="indexterm" name="id3563040"></a><a class="indexterm" name="id3563052"></a><p>
        Some forms of the <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH</code></a> statement
        are not logged because they could cause problems if replicated
        to a slave: <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH
        LOGS</code></a>, <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH
        MASTER</code></a>, <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH
        SLAVE</code></a>, and
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
        LOCK</code></a>. For a syntax example, see
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax">Section 12.5.7.3, “<code class="literal">FLUSH</code> Syntax”</a>. The
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>,
        <a href="sql-syntax.html#analyze-table" title="12.5.2.1. ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>,
        <a href="sql-syntax.html#optimize-table" title="12.5.2.4. OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>, and
        <a href="sql-syntax.html#repair-table" title="12.5.2.5. REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> statements are
        written to the binary log and thus replicated to slaves. This is
        not normally a problem because these statements do not modify
        table data.
      </p><p>
        However, this behavior can cause difficulties under certain
        circumstances. If you replicate the privilege tables in the
        <code class="literal">mysql</code> database and update those tables
        directly without using <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a>, you
        must issue a <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH
        PRIVILEGES</code></a> on the slaves to put the new privileges
        into effect. In addition, if you use
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>
        when renaming a <code class="literal">MyISAM</code> table that is part of
        a <code class="literal">MERGE</code> table, you must issue
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>
        manually on the slaves. These statements are written to the
        binary log unless you specify
        <code class="literal">NO_WRITE_TO_BINLOG</code> or its alias
        <code class="literal">LOCAL</code>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-functions"></a>16.3.1.10. Replication and System Functions</h4></div></div></div><a class="indexterm" name="id3563224"></a><a class="indexterm" name="id3563236"></a><p>
        Certain functions do not replicate well under some conditions:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            The <a href="functions.html#function_user"><code class="literal">USER()</code></a>,
            <a href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>,
            <a href="functions.html#function_uuid"><code class="literal">UUID()</code></a>,
            <a href="functions.html#function_version"><code class="literal">VERSION()</code></a>, and
            <a href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a> functions are
            replicated without change and thus do not work reliably on
            the slave unless row-based replication is enabled. This is
            also true for <a href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>.
            (See <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.)
          </p><p>
            Beginning with MySQL 6.0.4,
            <a href="functions.html#function_user"><code class="literal">USER()</code></a>,
            <a href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>, and
            <a href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> are
            automatically replicated using row-based replication when
            using <code class="literal">MIXED</code> mode, and generate a warning
            in <code class="literal">STATEMENT</code> mode. (<a href="http://bugs.mysql.com/28086" target="_top">Bug#28086</a>)
          </p></li><li><p>
            For <a href="functions.html#function_now"><code class="literal">NOW()</code></a>, the binary log
            includes the timestamp and replicates correctly.
          </p><p>
            Unlike <a href="functions.html#function_now"><code class="literal">NOW()</code></a>, the
            <a href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> function is not
            replication-safe because it is not affected by <code class="literal">SET
            TIMESTAMP</code> statements in the binary log and is
            non-deterministic if statement-based logging is used. This
            is not a problem if row-based logging is used. Another
            option is to start the server with the
            <a href="server-administration.html#option_mysqld_sysdate-is-now"><code class="option">--sysdate-is-now</code></a> option to
            cause <a href="functions.html#function_sysdate"><code class="literal">SYSDATE()</code></a> to be an
            alias for <a href="functions.html#function_now"><code class="literal">NOW()</code></a>.
          </p></li><li><p>
            <span class="emphasis"><em>The following restriction applies to
            statement-based replication only, not to row-based
            replication.</em></span> The
            <a href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a>,
            <a href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a>,
            <a href="functions.html#function_is-free-lock"><code class="literal">IS_FREE_LOCK()</code></a>, and
            <a href="functions.html#function_is-used-lock"><code class="literal">IS_USED_LOCK()</code></a> functions that
            handle user-level locks are replicated without the slave
            knowing the concurrency context on master. Therefore, these
            functions should not be used to insert into a master's table
            because the content on the slave would differ. (For example,
            do not issue a statement such as <code class="literal">INSERT INTO
            mytable VALUES(GET_LOCK(...))</code>.)
          </p></li></ul></div><p>
        As a workaround for the preceding limitations when
        statement-based replication is in effect, you can use the
        strategy of saving the problematic function result in a user
        variable and referring to the variable in a later statement. For
        example, the following single-row
        <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> is problematic due to the
        reference to the <a href="functions.html#function_uuid"><code class="literal">UUID()</code></a> function:
      </p><pre class="programlisting">INSERT INTO t VALUES(UUID());
</pre><p>
        To work around the problem, do this instead:
      </p><pre class="programlisting">SET @my_uuid = UUID();
INSERT INTO t VALUES(@my_uuid);
</pre><p>
        That sequence of statements replicates because the value of
        <code class="literal">@my_uuid</code> is stored in the binary log as a
        user-variable event prior to the
        <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statement and is available
        for use in the <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a>.
      </p><p>
        The same idea applies to multiple-row inserts, but is more
        cumbersome to use. For a two-row insert, you can do this:
      </p><pre class="programlisting">SET @my_uuid1 = UUID(); @my_uuid2 = UUID();
INSERT INTO t VALUES(@my_uuid1),(@my_uuid2);
</pre><p>
        However, if the number of rows is large or unknown, the
        workaround is difficult or impracticable. For example, you
        cannot convert the following statement to one in which a given
        individual user variable is associated with each row:
      </p><pre class="programlisting">INSERT INTO t2 SELECT UUID(), * FROM t1;
</pre><p>
        Within a stored function, <a href="functions.html#function_rand"><code class="literal">RAND()</code></a>
        replicates correctly as long as it is invoked only once during
        the execution of the function. (You can consider the function
        execution timestamp and random number seed as implicit inputs
        that are identical on the master and slave.)
      </p><p>
        The <a href="functions.html#function_found-rows"><code class="literal">FOUND_ROWS()</code></a> and
        <a href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> functions are not
        replicated reliably using statement-based replication. A
        workaround is to store the result of the function call in a user
        variable, and then use that in the
        <a href="sql-syntax.html#insert" title="12.2.5. INSERT Syntax"><code class="literal">INSERT</code></a> statement. For example, if
        you wish to store the result in a table named
        <code class="literal">mytable</code>, you might normally do so like this:

</p><pre class="programlisting">SELECT SQL_CALC_FOUND_ROWS FROM mytable LIMIT 1;
INSERT INTO mytable VALUES( FOUND_ROWS() );
</pre><p>

        However, if you are replicating <code class="literal">mytable</code>, then
        you should use <code class="literal">SELECT INTO</code>, and then store
        the variable in the table, like this:

</p><pre class="programlisting">SELECT SQL_CALC_FOUND_ROWS INTO @found_rows FROM mytable LIMIT 1;
INSERT INTO mytable VALUES(@found_rows);
</pre><p>

        In this way, the user variable is replicated as part of the
        context, and applied on the slave correctly.
      </p><p>
        Beginning with MySQL 6.0.4, these functions are automatically
        replicated using row-based replication when using
        <code class="literal">MIXED</code> mode, and generate a warning in
        <code class="literal">STATEMENT</code> mode. (<a href="http://bugs.mysql.com/12092" target="_top">Bug#12092</a>, <a href="http://bugs.mysql.com/30244" target="_top">Bug#30244</a>)
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-limit"></a>16.3.1.11. Replication and <code class="literal">LIMIT</code></h4></div></div></div><a class="indexterm" name="id3563708"></a><a class="indexterm" name="id3563721"></a><p>
        Statement-based replication of <code class="literal">LIMIT</code> clauses
        in <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a>,
        <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
        <a href="sql-syntax.html#insert-select" title="12.2.5.1. INSERT ...
        SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements is unsafe since the order of the
        rows affected is not defined. (Such statements can be replicated
        correctly when using <code class="literal">STATEMENT</code> mode only if
        they also contain an <code class="literal">ORDER BY</code> clause.)
        Beginning with MySQL 6.0.5, when such a statement (without
        <code class="literal">ORDER BY</code>) is encountered:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              When using <code class="literal">STATEMENT</code> mode, a warning
              that the statement is not safe for statement-based
              replication is now issued.
            </p><p>
              Currently, when using <code class="literal">STATEMENT</code> mode,
              warnings are issued for DML statements containing
              <code class="literal">LIMIT</code> even when they also have an
              <code class="literal">ORDER BY</code> clause (and so are made
              deterministic). This is a known issue which we are working
              to resolve in a future MySQL release. (<a href="http://bugs.mysql.com/42851" target="_top">Bug#42851</a>)
            </p></li><li><p>
              When using <code class="literal">MIXED</code> mode, the statement is
              now automatically replicated using row-based mode.
            </p></li></ul></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-load-data"></a>16.3.1.12. Replication and <code class="literal">LOAD DATA</code></h4></div></div></div><a class="indexterm" name="id3563865"></a><a class="indexterm" name="id3563877"></a><p>
        The <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA</code></a> statement is not
        replicated correctly to a slave running MySQL 5.1 or later from
        a master running MySQL 4.0 or earlier.
      </p><p>
        When using statement-based replication, the
        <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> statement's <code class="literal">CONCURRENT</code>
        option is not replicated; that is, <code class="literal">LOAD DATA CONCURRENT
        INFILE</code> is replicated as
        <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
        INFILE</code></a>, and <code class="literal">LOAD DATA CONCURRENT LOCAL
        INFILE</code> is replicated as
        <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA LOCAL
        INFILE</code></a>. The <code class="literal">CONCURRENT</code> option
        <span class="emphasis"><em>is</em></span> replicated when using row-based
        replication. (<a href="http://bugs.mysql.com/34628" target="_top">Bug#34628</a>)
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-logging"></a>16.3.1.13. Replication and the Slow Query Log</h4></div></div></div><a class="indexterm" name="id3563976"></a><a class="indexterm" name="id3563989"></a><p>
        Prior to MySQL 6.0.11, replication slaves did not write
        replicated queries to the slow query log, even if the same
        queries were written to the slow query log on the master. (<a href="http://bugs.mysql.com/23300" target="_top">Bug#23300</a>)
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-mastercrash"></a>16.3.1.14. Replication During a Master Crash</h4></div></div></div><a class="indexterm" name="id3564024"></a><a class="indexterm" name="id3564033"></a><a class="indexterm" name="id3564045"></a><p>
        A crash on the master side can result in the master's binary log
        having a final position less than the most recent position read
        by the slave, due to the master's binary log file not being
        flushed. This can cause the slave not to be able to replicate
        when the master comes back up. Setting
        <code class="literal">sync_binlog=1</code> in the master
        <code class="filename">my.cnf</code> file helps to minimize this problem
        because it causes the master to flush its binary log more
        frequently.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-mastershutdown"></a>16.3.1.15. Replication During a Master Shutdown</h4></div></div></div><a class="indexterm" name="id3564091"></a><p>
        It is safe to shut down a master server and restart it later.
        When a slave loses its connection to the master, the slave tries
        to reconnect immediately and retries periodically if that fails.
        The default is to retry every 60 seconds. This may be changed
        with the <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
        statement. A slave also is able to deal with network
        connectivity outages. However, the slave notices the network
        outage only after receiving no data from the master for
        <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_net_timeout" target="_top"><code class="literal">slave_net_timeout</code></a> seconds. If
        your outages are short, you may want to decrease
        <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_net_timeout" target="_top"><code class="literal">slave_net_timeout</code></a>. See
        <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-memory"></a>16.3.1.16. Replication with <code class="literal">MEMORY</code> Tables</h4></div></div></div><a class="indexterm" name="id3564162"></a><a class="indexterm" name="id3564174"></a><p>
        When a server shuts down and restarts, its
        <code class="literal">MEMORY</code> tables become empty. The master
        replicates this effect to slaves as follows: The first time that
        the master uses each <code class="literal">MEMORY</code> table after
        startup, it logs an event that notifies the slaves that the
        table needs to be emptied by writing a
        <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> statement for that table
        to the binary log. See <a href="storage-engines.html#memory-storage-engine" title="13.10. The MEMORY (HEAP) Storage Engine">Section 13.10, “The <code class="literal">MEMORY</code> (<code class="literal">HEAP</code>) Storage Engine”</a>,
        for more information about <code class="literal">MEMORY</code> tables.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-mysqldb"></a>16.3.1.17. Replication of the System <code class="literal">mysql</code> Database</h4></div></div></div><a class="indexterm" name="id3564243"></a><a class="indexterm" name="id3564255"></a><a class="indexterm" name="id3564268"></a><a class="indexterm" name="id3564280"></a><p>
        Data modification statements made to tables in the
        <code class="literal">mysql</code> database are replicated according to
        the value of <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a>; if
        this value is <code class="literal">MIXED</code>, then these statement are
        replicated using the row-based format. However, statements that
        would normally update this information indirectly — such
        <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a>,
        <a href="sql-syntax.html#revoke" title="12.5.1.5. REVOKE Syntax"><code class="literal">REVOKE</code></a>, and statements
        manipulating triggers, stored routines, and views — are
        replicated to slaves using statement-based replication.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-optimizer"></a>16.3.1.18. Replication and the Query Optimizer</h4></div></div></div><a class="indexterm" name="id3564353"></a><a class="indexterm" name="id3564365"></a><p>
        It is possible for the data on the master and slave to become
        different if a statement is designed in such a way that the data
        modification is non-deterministic; that is, left up the query
        optimizer. (This is in general not a good practice, even outside
        of replication.) Examples of non-deterministic statements
        include <a href="sql-syntax.html#delete" title="12.2.2. DELETE Syntax"><code class="literal">DELETE</code></a> or
        <a href="sql-syntax.html#update" title="12.2.12. UPDATE Syntax"><code class="literal">UPDATE</code></a> statements that use
        <code class="literal">LIMIT</code> with no <code class="literal">ORDER BY</code>
        clause; see <a href="replication.html#replication-features-limit" title="16.3.1.11. Replication and LIMIT">Section 16.3.1.11, “Replication and <code class="literal">LIMIT</code>”</a>, for a
        detailed discussion of these.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-reserved-words"></a>16.3.1.19. Replication and Reserved Words</h4></div></div></div><a class="indexterm" name="id3564430"></a><a class="indexterm" name="id3564442"></a><p>
        You can encounter problems when you are attempting to replicate
        from an older master to a newer slave and you make use of
        identifiers on the master that are reserved words in the newer
        MySQL version running on the slave. An example of this is using
        a table column named <code class="literal">current_user</code> on a 4.0
        master that is replicating to a 4.1 or higher slave, because
        <code class="literal">CURRENT_USER</code> is a reserved word beginning in
        MySQL 4.1. Replication can fail in such cases with Error 1064
        <span class="errortext">You have an error in your SQL syntax...</span>,
        <span class="emphasis"><em>even if a database or table named using the reserved
        word or a table having a column named using the reserved word is
        excluded from replication</em></span>. This is due to the fact
        that each SQL statement must be parsed by the slave prior to
        execution, so that the slave knows which database object or
        objects would be effected by the statement; only after the
        statement is parsed can the slave apply any filtering rules
        defined by <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>,
        <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>,
        <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>, and
        <a href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>.
      </p><p>
        To work around the problem of database, table, or column names
        on the master which would be regarded as reserved words by the
        slave, do one of the following:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              Use one or more <a href="sql-syntax.html#alter-table" title="12.1.6. ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
              statements on the master to change the names of any
              database objects where these names would be considered
              reserved words on the slave, and change any SQL statements
              that use the old names to use the new names instead.
            </p></li><li><p>
              In any SQL statements using these database object names,
              set the names off using backtick characters
              (<code class="literal">`</code>).
            </p></li></ul></div><p>

        For listings of reserved words by MySQL version, see
        <a href="http://dev.mysql.com/doc/mysqld-version-reference/en/mysqld-version-reference-optvar.html" target="_top">Reserved
        Words</a>, in the <em class="citetitle">MySQL Server Version
        Reference</em>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-slaveerrors"></a>16.3.1.20. Slave Errors during Replication</h4></div></div></div><a class="indexterm" name="id3564592"></a><a class="indexterm" name="id3564604"></a><p>
        If a statement on a slave produces an error, the slave SQL
        thread terminates, and the slave writes a message to its error
        log. You should then connect to the slave manually and determine
        the cause of the problem. (<a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE
        STATUS</code></a> is useful for this.) Then fix the problem (for
        example, you might need to create a non-existent table) and run
        <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a>.
      </p><p class="mnmas"><b>MySQL Enterprise</b>
          For instant notification when a slave thread terminates
          subscribe to the MySQL Enterprise Monitor. For more
          information, see
          <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-slaveshutdown"></a>16.3.1.21. Replication during a Slave Shutdown</h4></div></div></div><a class="indexterm" name="id3564671"></a><p>
        Shutting down the slave (cleanly) is also safe because it keeps
        track of where it left off. Unclean shutdowns might produce
        problems, especially if the disk cache was not flushed to disk
        before the system went down. Your system fault tolerance is
        greatly increased if you have a good uninterruptible power
        supply. Unclean shutdowns of the master may cause
        inconsistencies between the content of tables and the binary log
        in master.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-temptables"></a>16.3.1.22. Replication and Temporary Tables</h4></div></div></div><a class="indexterm" name="id3564705"></a><a class="indexterm" name="id3564718"></a><a class="indexterm" name="id3564731"></a><p>
        This item does not apply when row-based replication is in use
        because in that case temporary tables are not replicated (see
        <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>).
      </p><p><b>Safe shutdown of slaves when using temporary tables. </b>
          Temporary tables are replicated except in the case where you
          shut down the slave server (not just the slave threads) and
          you have replicated temporary tables that are used in updates
          that have not yet been executed on the slave. If you shut down
          the slave server, the temporary tables needed by those updates
          are no longer available when the slave is restarted. To avoid
          this problem, do not shut down the slave while it has
          temporary tables open. Instead, use the following procedure:
        </p><div class="orderedlist"><ol type="1"><li><p>
            Issue a <code class="literal">STOP SLAVE SQL_THREAD</code> statement.
          </p></li><li><p>
            Use <a href="sql-syntax.html#show-status" title="12.5.6.35. SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> to check the
            value of the
            <a href="server-administration.html#statvar_Slave_open_temp_tables"><code class="literal">Slave_open_temp_tables</code></a>
            variable.
          </p></li><li><p>
            If the value is 0, issue a <a href="programs.html#mysqladmin" title="4.5.2. mysqladmin — Client for Administering a MySQL Server"><span><strong class="command">mysqladmin
            shutdown</strong></span></a> command to stop the slave.
          </p></li><li><p>
            If the value is not 0, restart the slave SQL thread with
            <code class="literal">START SLAVE SQL_THREAD</code>.
          </p></li><li><p>
            Repeat the procedure later until the
            <a href="server-administration.html#statvar_Slave_open_temp_tables"><code class="literal">Slave_open_temp_tables</code></a>
            variable is 0 and you can stop the slave.
          </p></li></ol></div><p><b>Temporary tables and replication options. </b>
          By default, all temporary tables are replicated; this happens
          whether or not there are any matching
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>,
          <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>, or
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>
          options in effect. However, the
          <a href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a> and
          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
          options are honored for temporary tables.
        </p><p>
        A recommended practice when using statement-based or
        mixed-format replication is to designate a prefix for exclusive
        use in naming temporary tables that you do not want replicated,
        then employ a matching
        <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
        option. For example, you might give all such tables names
        beginning with <code class="literal">norep_</code> (such as
        <code class="literal">norep_tablea</code>,
        <code class="literal">norep_tableb</code>, and so on), then use
        <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table=norep_</code></a>
        to prevent the replication of these tables.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-timeout"></a>16.3.1.23. Replication Retries and Timeouts</h4></div></div></div><a class="indexterm" name="id3564982"></a><a class="indexterm" name="id3564994"></a><a class="indexterm" name="id3565007"></a><a class="indexterm" name="id3565016"></a><p>
        The global system variable
        <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_transaction_retries" target="_top"><code class="literal">slave_transaction_retries</code></a>
        affects replication as follows: If the replication slave SQL
        thread fails to execute a transaction because of an
        <code class="literal">InnoDB</code> deadlock or because it exceeded the
        <code class="literal">InnoDB</code>
        <a href="storage-engines.html#sysvar_innodb_lock_wait_timeout"><code class="literal">innodb_lock_wait_timeout</code></a> value,
        the transaction is automatically retried
        <a href="http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html#sysvar_slave_transaction_retries" target="_top"><code class="literal">slave_transaction_retries</code></a> times
        before stopping with an error. The default value is 10. The
        total retry count can be seen in the output of
        <a href="sql-syntax.html#show-status" title="12.5.6.35. SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>; see
        <a href="server-administration.html#server-status-variables" title="5.1.6. Server Status Variables">Section 5.1.6, “Server Status Variables”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-timezone"></a>16.3.1.24. Replication and Time Zones</h4></div></div></div><a class="indexterm" name="id3565097"></a><a class="indexterm" name="id3565110"></a><p>
        If the master uses MySQL 4.1, the same system time zone should
        be set for both master and slave. Otherwise some statements will
        not be replicated properly, such as statements that use the
        <a href="functions.html#function_now"><code class="literal">NOW()</code></a> or
        <a href="functions.html#function_from-unixtime"><code class="literal">FROM_UNIXTIME()</code></a> functions. You
        can set the time zone in which MySQL server runs by using the
        <a href="programs.html#option_mysqld_safe_timezone"><code class="option">--timezone=<em class="replaceable"><code>timezone_name</code></em></code></a>
        option of the <code class="filename">mysqld_safe</code> script or by
        setting the <code class="literal">TZ</code> environment variable. Both
        master and slave should also have the same default connection
        time zone setting; that is, the
        <a href="server-administration.html#option_mysqld_default-time-zone"><code class="option">--default-time-zone</code></a> parameter
        should have the same value for both master and slave. Note that
        this is not necessary when the master is MySQL 5.0 or later.
      </p><p>
        <a href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ(...,...,@@session.time_zone)</code></a>
        is properly replicated only if both master and slave are running
        MySQL 5.0.4 or newer.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-transactions"></a>16.3.1.25. Replication and Transactions</h4></div></div></div><a class="indexterm" name="id3565203"></a><a class="indexterm" name="id3565215"></a><a class="indexterm" name="id3565228"></a><p>
        It is possible to replicate transactional tables on the master
        using non-transactional tables on the slave. For example, you
        can replicate an <code class="literal">InnoDB</code> master table as a
        <code class="literal">MyISAM</code> slave table. However, if you do this,
        there are problems if the slave is stopped in the middle of a
        <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">BEGIN</code></a>/<a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">COMMIT</code></a>
        block because the slave restarts at the beginning of the
        <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">BEGIN</code></a> block.
      </p><p>
        Beginning with MySQL 6.0.10, it is also safe to replicate
        transactions from <code class="literal">MyISAM</code> tables on
        the master to transactional tables — such as tables that
        use the <code class="literal">InnoDB</code> storage engine
        — on the slave. In such cases (beginning with MySQL
        6.0.10), an <code class="literal">AUTOCOMMIT=1</code> statement issued on
        the master is replicated, thus enforcing
        <code class="literal">AUTOCOMMIT</code> mode on the slave.
      </p><p><b>Mixing transactional and non-transactional statements within the same
          transaction. </b>
          The semantics of mixing non-transactional and transactional
          tables in a transaction in the first statement of a
          transaction changed in MySQL 6.0.10. Previously, if the first
          statement in a transaction contained non-transactional
          changes, the statement was written directly to the binary log,
          in an attempt to mimic the non-transactional behavior of the
          statement. Beginning with MySQL 6.0.10, any statement
          appearing after a
          <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">BEGIN</code></a> is
          always considered part of the transaction and cached. This
          means that non-transactional changes do not propagate to the
          slave until the transaction is committed and thus written to
          the binary log. In addition (also beginning with MySQL
          5.1.31), if <code class="literal">AUTOMCOMMIT</code> is set to 0, any
          statement appearing immediately following a
          <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">COMMIT</code></a> is handled in the same
          way.
        </p><p>
        Previously, a statement was considered non-transactional if it
        changed a non-transactional table. This behavior had the
        following subtle but non-trivial consequences:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            A statement containing only non-transactional changes was
            written immediately to the binary log (sometime referred to
            as “<span class="quote">write-ahead</span>”).
          </p></li><li><p>
            A statement containing only transactional changes was always
            cached while waiting for the transaction to be committed.
          </p></li><li><p>
            A statement containing a mix of transactional and
            non-transactional changes (that is, a statement updating
            both transaction and non-transactional tables) could lead to
            mismatched tables on the master and the slave.
          </p></li></ul></div><p>
        In situations where transactions mix updates to transactional
        and non-transactional tables, the order of statements in the
        binary log is correct, and all needed statements are written to
        the binary log even in case of a
        <a href="sql-syntax.html#commit" title="12.4.1. START TRANSACTION,
      COMMIT, and
      ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>.
        However, when a second connection updates the non-transactional
        table before the first connection's transaction is complete,
        statements can be logged out of order, because the second
        connection's update is written immediately after it is
        performed, regardless of the state of the transaction being
        performed by the first connection.
      </p><p>
        Due to the non-transactional nature of <code class="literal">MyISAM</code>
        tables, it is possible to have a statement that only partially
        updates a table and returns an error code. This can happen, for
        example, on a multiple-row insert that has one row violating a
        key constraint, or if a long update statement is killed after
        updating some of the rows. If that happens on the master, the
        slave thread exits and waits for the database administrator to
        decide what to do about it unless the error code is legitimate
        and execution of the statement results in the same error code on
        the slave. If this error code validation behavior is not
        desirable, some or all errors can be masked out (ignored) with
        the <a href="replication.html#option_mysqld_slave-skip-errors"><code class="option">--slave-skip-errors</code></a> option.
      </p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Caution</h3><p>
          You should avoid transactions that update both transactional
          and non-transactional tables in a replication environment.
        </p></div><p>
        When the storage engine type of the slave is non-transactional,
        transactions on the master that mix updates of transactional and
        non-transactional tables should be avoided because they can
        cause inconsistency of the data between the master's
        transactional table and the slave's non-transactional table.
        That is, such transactions can lead to master storage
        engine-specific behavior with the possible effect of replication
        going out of synchrony. MySQL does not issue a warning about
        this currently, so extra care should be taken when replicating
        transactional tables from the master to non-transactional ones
        on the slaves.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-triggers"></a>16.3.1.26. Replication and Triggers</h4></div></div></div><a class="indexterm" name="id3565511"></a><a class="indexterm" name="id3565523"></a><p>
        Triggers are not executed on the slave under row-based
        replication. However they are are executed on the slave under
        statement-based replication. Instead, when using row-based
        replication, the changes caused by executing the trigger on the
        master are applied on the slave.
      </p><p>
        This behavior is by design. The reason for this is that, if both
        the master and the slave applied the changes from the master
        and, in addition, the trigger causing these changes were applied
        on the slave, the changes would in effect be applied twice on
        the slave, leading to different data on the master and the
        slave.
      </p><p>
        If you wish for triggers to execute on both the master and the
        slave — perhaps because you have different triggers on the
        master and slave — then you must use statement-based
        replication. However, it is not necessary to use statement-based
        replication exclusively if you want to enable slave-side
        triggers; it is sufficient in such cases to switch to
        statement-based replication only for those statements where you
        want this effect, and to use row-based replication the rest of
        the time.
      </p><p>
        Before MySQL 6.0.10, a trigger that was defined on a
        transactional table but that updated a non-transactional tables
        could cause updates on the transactional table to be replicated
        before they were actually committed on the master, and not be
        rolled back correctly on the slave if they were rolled back on
        the master. (<a href="http://bugs.mysql.com/40116" target="_top">Bug#40116</a>) See also
        <a href="replication.html#replication-features-transactions" title="16.3.1.25. Replication and Transactions">Section 16.3.1.25, “Replication and Transactions”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-truncate"></a>16.3.1.27. Replication and <code class="literal">TRUNCATE</code></h4></div></div></div><a class="indexterm" name="id3565603"></a><a class="indexterm" name="id3565616"></a><p>
        <a href="sql-syntax.html#truncate" title="12.2.11. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> is normally regarded as
        a DML statement, and so would be expected to be logged and
        replicated using row-based format when the binary logging mode
        is <code class="literal">ROW</code> or <code class="literal">MIXED</code>. However
        this caused issues when logging or replicating, in
        <code class="literal">STATEMENT</code> or <code class="literal">MIXED</code> mode,
        tables that used transactional storage engines such as
        <code class="literal">InnoDB</code> when the transaction
        isolation level was <code class="literal">READ COMMITTED</code> or
        <code class="literal">READ UNCOMMITTED</code>, which precludes
        statement-based logging.
      </p><p>
        Beginning with MySQL 6.0.10,
        <a href="sql-syntax.html#truncate" title="12.2.11. TRUNCATE Syntax"><code class="literal">TRUNCATE</code></a> is treated for purposes
        of logging and replication as DDL rather than DML so that it can
        be logged and replicated as a statement. However, the effects of
        the statement as applicable to
        <code class="literal">InnoDB</code> and other transactional
        tables on replication slaves still follow the rules described in
        <a href="sql-syntax.html#truncate" title="12.2.11. TRUNCATE Syntax">Section 12.2.11, “<code class="literal">TRUNCATE</code> Syntax”</a> governing such tables. (<a href="http://bugs.mysql.com/36763" target="_top">Bug#36763</a>)
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-variables"></a>16.3.1.28. Replication and Variables</h4></div></div></div><a class="indexterm" name="id3565734"></a><a class="indexterm" name="id3565747"></a><a class="indexterm" name="id3565759"></a><a class="indexterm" name="id3565772"></a><a class="indexterm" name="id3565785"></a><p>
        The <a href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a>,
        <a href="server-administration.html#sysvar_unique_checks"><code class="literal">unique_checks</code></a>, and
        <a href="server-administration.html#sysvar_sql_auto_is_null"><code class="literal">sql_auto_is_null</code></a> variables are
        all replicated.
      </p><p>
        <a href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> is also replicated
        except for the
        <a href="server-administration.html#sqlmode_no_dir_in_create"><code class="literal">NO_DIR_IN_CREATE</code></a> mode.
        However, when <a href="programs.html#mysqlbinlog" title="4.6.8. mysqlbinlog — Utility for Processing Binary Log Files"><span><strong class="command">mysqlbinlog</strong></span></a> parses a
        <code class="literal">SET @@sql_mode =
        <em class="replaceable"><code>value</code></em></code> statement, the full
        <em class="replaceable"><code>value</code></em>, including
        <a href="server-administration.html#sqlmode_no_dir_in_create"><code class="literal">NO_DIR_IN_CREATE</code></a>, is passed to
        the receiving server.
      </p><p>
        The <a href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a> system
        variable is not replicated, which is a good thing for
        replication between different storage engines.
      </p><p>
        Session variables are not replicated properly when used in
        statements that update tables. For example, <code class="literal">SET
        MAX_JOIN_SIZE=1000</code> followed by <code class="literal">INSERT INTO
        mytable VALUES(@@MAX_JOIN_SIZE)</code> will not insert the
        same data on the master and the slave. This does not apply to
        the common sequence of <code class="literal">SET TIME_ZONE=...</code>
        followed by <code class="literal">INSERT INTO mytable
        VALUES(CONVERT_TZ(...,...,@@time_zone))</code>.
      </p><p>
        Replication of session variables is not a problem when row-based
        replication is being used. See
        <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="replication-features-views"></a>16.3.1.29. Replication and Views</h4></div></div></div><a class="indexterm" name="id3565938"></a><a class="indexterm" name="id3565950"></a><p>
        Views are always replicated to slaves. Views are filtered by
        their own name, not by the tables they refer to. This means that
        a view can be replicated to the slave even if the view contains
        a table that would normally be filtered out by
        <code class="option">replication-ignore-table</code> rules. Care should
        therefore be taken to ensure that views do not replicate table
        data that would normally be filtered for security reasons.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-compatibility"></a>16.3.2. Replication Compatibility Between MySQL Versions</h3></div></div></div><p>
      MySQL supports replication from one major version to the next
      higher major version. For example, you can replicate from a master
      running MySQL 4.1 to a slave running MySQL 5.0, from a master
      running MySQL 5.0 to a slave running MySQL 5.1, from a master
      running MySQL 5.1 to a slave running MySQL 6.0, and so on.
    </p><p>
      In some cases, it is also possible to replicate between a master
      and a slave that is more than one major version newer than the
      master. However, there are known issues with trying to replicate
      from a master running MySQL 4.1 or earlier to a slave running
      MySQL 5.1 or later. To work around such problems, you can insert
      one or more MySQL servers running intermediate versions between
      the two; for example, rather than replicating directly from a
      MySQL 4.1 master to a MySQL 6.0 slave, it is possible to replicate
      from a MySQL 4.1 server to a MySQL 5.0 server, and then from the
      MySQL 5.0 server to a MySQL 5.1 server, and finally from the MySQL
      5.1 server to a MySQL 6.0 server.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        We strongly recommend using the most recent release available
        within a given MySQL major version because replication (and
        other) capabilities are continually being improved. We also
        recommend upgrading masters and slaves that use alpha or beta
        releases of a major version of MySQL to GA (production) releases
        when these become available for that major version.
      </p></div><p>
      Replication from newer masters to older slaves may be possible,
      but is generally not supported. This is due to a number of
      factors:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Binary log format changes. </b>
            The binary log format can change between major releases.
            While we attempt to maintain backward compatibility, this is
            not always possible. For example, the binary log format
            implemented in MySQL 5.0 changed considerably from that used
            in previous versions, especially with regard to handling of
            character sets,
            <a href="sql-syntax.html#load-data" title="12.2.6. LOAD DATA INFILE
      Syntax"><code class="literal">LOAD DATA
            INFILE</code></a>, and time zones. This means that
            replication from a MySQL 5.0 (or later) master to a MySQL
            4.1 (or earlier) slave is generally not supported.
          </p><p>
          This also has significant implications for upgrading
          replication servers; see
          <a href="replication.html#replication-upgrade" title="16.3.3. Upgrading a Replication Setup">Section 16.3.3, “Upgrading a Replication Setup”</a>, for more information.
        </p></li><li><p><b>Use of row-based replication. </b>
            You cannot replicate using row-based replication from any
            MySQL 6.0 or later master to a slave running MySQL 5.1.4 or
            earlier, since MySQL versions prior to 5.1.5 do not support
            RBR.
          </p><p>
          For more information about row-based replication, see
          <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
        </p></li><li><p><b>SQL incompatiblities. </b>
            You cannot replicate from a newer master to an older slave
            using statement-based replication if the statements to be
            replicated use SQL features available on the master but not
            on the slave.
          </p><p>
          However, if both the master and the slave support row-based
          replication, and there are no data definition statements to be
          replicated that depend on SQL features found on the master but
          not on the slave, then you can use row-based replication to
          replicate the effects of data modification statements even if
          the DDL run on the master is not supported on the slave.
        </p></li></ul></div><p>
      For more information on potential replication issues, see
      <a href="replication.html#replication-features" title="16.3.1. Replication Features and Issues">Section 16.3.1, “Replication Features and Issues”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-upgrade"></a>16.3.3. Upgrading a Replication Setup</h3></div></div></div><p>
      When you upgrade servers that participate in a replication setup,
      the procedure for upgrading depends on the current server versions
      and the version to which you are upgrading.
    </p><p>
      This section applies to upgrading replication from MySQL 3.23,
      4.0, or 4.1 to MySQL 6.0. A 4.0 server should be
      4.0.3 or newer.
    </p><p>
      When you upgrade a master to 6.0 from an earlier
      MySQL release series, you should first ensure that all the slaves
      of this master are using the same 6.0.x release. If
      this is not the case, you should first upgrade the slaves. To
      upgrade each slave, shut it down, upgrade it to the appropriate
      6.0.x version, restart it, and restart replication.
      The 6.0 slave is able to read the old relay logs
      written prior to the upgrade and to execute the statements they
      contain. Relay logs created by the slave after the upgrade are in
      6.0 format.
    </p><p>
      After the slaves have been upgraded, shut down the master, upgrade
      it to the same 6.0.x release as the slaves, and
      restart it. The 6.0 master is able to read the old
      binary logs written prior to the upgrade and to send them to the
      6.0 slaves. The slaves recognize the old format and
      handle it properly. Binary logs created by the master following
      the upgrade are in 6.0 format. These too are
      recognized by the 6.0 slaves.
    </p><p>
      In other words, there are no measures to take when upgrading to
      MySQL 6.0, except that the slaves must be MySQL
      6.0 before you can upgrade the master to
      6.0. Note that downgrading from 6.0 to
      older versions does not work so simply: You must ensure that any
      6.0 binary logs or relay logs have been fully
      processed, so that you can remove them before proceeding with the
      downgrade.
    </p><p>
      Downgrading a replication setup to a previous version cannot be
      done once you have switched from statement-based to row-based
      replication, and after the first row-based statement has been
      written to the binlog. See <a href="replication.html#replication-formats" title="16.1.2. Replication Formats">Section 16.1.2, “Replication Formats”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-faq"></a>16.3.4. Replication FAQ</h3></div></div></div><p class="mnmas"><b>MySQL Enterprise</b>
        For expert advice on replication subscribe to the MySQL
        Enterprise Monitor. For more information, see
        <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
      </p><p><span class="bold"><strong>Questions</strong></span></p><div class="itemizedlist"><ul type="disc"><li><p><a href="replication.html#qandaitem-16-3-4-1-1">16.3.4.1: </a>
            Does the slave need to be connected to the master all the
            time?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-2">16.3.4.2: </a>
            Do I have to enable networking on my master to enable
            replication?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-3">16.3.4.3: </a>
            How do I know how late a slave is compared to the master? In
            other words, how do I know the date of the last statement
            replicated by the slave?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-4">16.3.4.4: </a>
            How do I force the master to block updates until the slave
            catches up?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-5">16.3.4.5: </a>
            What issues should I be aware of when setting up two-way
            replication?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-6">16.3.4.6: </a><a class="indexterm" name="id3566305"></a><a class="indexterm" name="id3566316"></a>
            How can I use replication to improve performance of my
            system?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-7">16.3.4.7: </a>
            What should I do to prepare client code in my own
            applications to use performance-enhancing replication?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-8">16.3.4.8: </a>
            When and how much can MySQL replication improve the
            performance of my system?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-9">16.3.4.9: </a>
            How can I use replication to provide redundancy or high
            availability?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-10">16.3.4.10: </a>
            How do I tell whether a master server is using
            statement-based or row-based binary logging format?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-11">16.3.4.11: </a>
            How do I tell a slave to use row-based replication?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-12">16.3.4.12: </a>
            How do I prevent <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a> and
            <a href="sql-syntax.html#revoke" title="12.5.1.5. REVOKE Syntax"><code class="literal">REVOKE</code></a> statements from
            replicating to slave machines?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-13">16.3.4.13: </a>
            Does replication work on mixed operating systems (for
            example, the master runs on Linux while slaves run on Mac OS
            X and Windows)?
          </p></li><li><p><a href="replication.html#qandaitem-16-3-4-1-14">16.3.4.14: </a>
            Does replication work on mixed hardware architectures (for
            example, the master runs on a 64-bit machine while slaves
            run on 32-bit machines)?
          </p></li></ul></div><p><span class="bold"><strong>Questions and Answers</strong></span></p><p><a name="qandaitem-16-3-4-1-1"></a><span class="bold"><strong>16.3.4.1: </strong></span><span class="bold"><strong>
            Does the slave need to be connected to the master all the
            time?
          </strong></span></p><p>
            No, it does not. The slave can go down or stay disconnected
            for hours or even days, and then reconnect and catch up on
            updates. For example, you can set up a master/slave
            relationship over a dial-up link where the link is up only
            sporadically and for short periods of time. The implication
            of this is that, at any given time, the slave is not
            guaranteed to be in sync with the master unless you take
            some special measures.
          </p><p>
            To ensure that this is the case, you must not remove binary
            logs from the master, where the information has not been
            replicated to the slaves. Asynchronous replication can only
            work if the slave is able to read the binary log from the
            last point in the binary logs where it had read the
            replication statements.
          </p><p><a name="qandaitem-16-3-4-1-2"></a><span class="bold"><strong>16.3.4.2: </strong></span><span class="bold"><strong>
            Do I have to enable networking on my master to enable
            replication?
          </strong></span></p><p>
            Networking must be enabled on the master. If networking is
            not enabled, then the slave is unable to connect to the
            master and transfer the binary log. Check that the
            <code class="literal">skip-networking</code> option has not been
            enabled in your configuration file.
          </p><p><a name="qandaitem-16-3-4-1-3"></a><span class="bold"><strong>16.3.4.3: </strong></span><span class="bold"><strong>
            How do I know how late a slave is compared to the master? In
            other words, how do I know the date of the last statement
            replicated by the slave?
          </strong></span></p><p>
            You can read the <code class="literal">Seconds_Behind_Master</code>
            column in <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
            See <a href="replication.html#replication-implementation-details" title="16.4.1. Replication Implementation Details">Section 16.4.1, “Replication Implementation Details”</a>.
          </p><p>
            When the slave SQL thread executes an event read from the
            master, it modifies its own time to the event timestamp.
            (This is why <a href="data-types.html#datetime" title="10.3.1. The DATETIME,
        DATE, and
        TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> is
            well replicated.) In the <code class="literal">Time</code> column in
            the output of <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
            PROCESSLIST</code></a>, the number of seconds displayed for
            the slave SQL thread is the number of seconds between the
            timestamp of the last replicated event and the real time of
            the slave machine. You can use this to determine the date of
            the last replicated event. Note that if your slave has been
            disconnected from the master for one hour, and then
            reconnects, you may immediately see <code class="literal">Time</code>
            values like 3600 for the slave SQL thread in
            <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>. This is
            because the slave is executing statements that are one hour
            old.
          </p><p><a name="qandaitem-16-3-4-1-4"></a><span class="bold"><strong>16.3.4.4: </strong></span><span class="bold"><strong>
            How do I force the master to block updates until the slave
            catches up?
          </strong></span></p><p>
            Use the following procedure:
          </p><div class="orderedlist"><ol type="1"><li><p>
                On the master, execute these statements:
              </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>FLUSH TABLES WITH READ LOCK;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW MASTER STATUS;</code></strong>
</pre><p>
                Record the replication coordinates (the log file name
                and offset) from the output of the
                <a href="sql-syntax.html#show" title="12.5.6. SHOW Syntax"><code class="literal">SHOW</code></a> statement.
              </p></li><li><p>
                On the slave, issue the following statement, where the
                arguments to the
                <a href="functions.html#function_master-pos-wait"><code class="literal">MASTER_POS_WAIT()</code></a>
                function are the replication coordinate values obtained
                in the previous step:
              </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT MASTER_POS_WAIT('<em class="replaceable"><code>log_name</code></em>', <em class="replaceable"><code>log_offset</code></em>);</code></strong>
</pre><p>
                The <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a> statement
                blocks until the slave reaches the specified log file
                and offset. At that point, the slave is in synchrony
                with the master and the statement returns.
              </p></li><li><p>
                On the master, issue the following statement to allow
                the master to begin processing updates again:
              </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>UNLOCK TABLES;</code></strong>
</pre></li></ol></div><p><a name="qandaitem-16-3-4-1-5"></a><span class="bold"><strong>16.3.4.5: </strong></span><span class="bold"><strong>
            What issues should I be aware of when setting up two-way
            replication?
          </strong></span></p><p>
            MySQL replication currently does not support any locking
            protocol between master and slave to guarantee the atomicity
            of a distributed (cross-server) update. In other words, it
            is possible for client A to make an update to co-master 1,
            and in the meantime, before it propagates to co-master 2,
            client B could make an update to co-master 2 that makes the
            update of client A work differently than it did on co-master
            1. Thus, when the update of client A makes it to co-master
            2, it produces tables that are different from what you have
            on co-master 1, even after all the updates from co-master 2
            have also propagated. This means that you should not chain
            two servers together in a two-way replication relationship
            unless you are sure that your updates can safely happen in
            any order, or unless you take care of mis-ordered updates
            somehow in the client code.
          </p><p>
            You should also realize that two-way replication actually
            does not improve performance very much (if at all) as far as
            updates are concerned. Each server must do the same number
            of updates, just as you would have a single server do. The
            only difference is that there is a little less lock
            contention, because the updates originating on another
            server are serialized in one slave thread. Even this benefit
            might be offset by network delays.
          </p><p><a name="qandaitem-16-3-4-1-6"></a><span class="bold"><strong>16.3.4.6: </strong></span><span class="bold"><strong><a class="indexterm" name="id3566792"></a></strong></span><span class="bold"><strong><a class="indexterm" name="id3566806"></a></strong></span><span class="bold"><strong>
            How can I use replication to improve performance of my
            system?
          </strong></span></p><p>
            You should set up one server as the master and direct all
            writes to it. Then configure as many slaves as you have the
            budget and rackspace for, and distribute the reads among the
            master and the slaves. You can also start the slaves with
            the <a href="server-administration.html#option_mysqld_skip-innodb"><code class="option">--skip-innodb</code></a>,
            <a href="server-administration.html#option_mysqld_low-priority-updates"><code class="option">--low-priority-updates</code></a>, and
            <a href="server-administration.html#option_mysqld_delay-key-write"><code class="option">--delay-key-write=ALL</code></a> options
            to get speed improvements on the slave end. In this case,
            the slave uses non-transactional <code class="literal">MyISAM</code>
            tables instead of <code class="literal">InnoDB</code> tables to get
            more speed by eliminating transactional overhead.
          </p><p><a name="qandaitem-16-3-4-1-7"></a><span class="bold"><strong>16.3.4.7: </strong></span><span class="bold"><strong>
            What should I do to prepare client code in my own
            applications to use performance-enhancing replication?
          </strong></span></p><p>
            See the guide to using replication as a scale-out solution,
            <a href="replication.html#replication-solutions-scaleout" title="16.2.3. Using Replication for Scale-Out">Section 16.2.3, “Using Replication for Scale-Out”</a>.
          </p><p><a name="qandaitem-16-3-4-1-8"></a><span class="bold"><strong>16.3.4.8: </strong></span><span class="bold"><strong>
            When and how much can MySQL replication improve the
            performance of my system?
          </strong></span></p><p>
            MySQL replication is most beneficial for a system that
            processes frequent reads and infrequent writes. In theory,
            by using a single-master/multiple-slave setup, you can scale
            the system by adding more slaves until you either run out of
            network bandwidth, or your update load grows to the point
            that the master cannot handle it.
          </p><p>
            To determine how many slaves you can use before the added
            benefits begin to level out, and how much you can improve
            performance of your site, you need to know your query
            patterns, and to determine empirically by benchmarking the
            relationship between the throughput for reads (reads per
            second, or <code class="literal">reads</code>) and for writes
            (<code class="literal">writes</code>) on a typical master and a
            typical slave. The example here shows a rather simplified
            calculation of what you can get with replication for a
            hypothetical system.
          </p><p>
            Let's say that system load consists of 10% writes and 90%
            reads, and we have determined by benchmarking that
            <code class="literal">reads</code> is 1200 – 2 ×
            <code class="literal">writes</code>. In other words, the system can do
            1,200 reads per second with no writes, the average write is
            twice as slow as the average read, and the relationship is
            linear. Let us suppose that the master and each slave have
            the same capacity, and that we have one master and
            <em class="replaceable"><code>N</code></em> slaves. Then we have for each
            server (master or slave):
          </p><p>
            <code class="literal">reads = 1200 – 2 × writes</code>
          </p><p>
            <code class="literal">reads = 9 × writes /
            (<em class="replaceable"><code>N</code></em> + 1)</code> (reads are
            split, but writes go to all servers)
          </p><p>
            <code class="literal">9 × writes / (<em class="replaceable"><code>N</code></em> +
            1) + 2 × writes = 1200</code>
          </p><p>
            <code class="literal">writes = 1200 / (2 +
            9/(<em class="replaceable"><code>N</code></em>+1))</code>
          </p><p>
            The last equation indicates the maximum number of writes for
            <em class="replaceable"><code>N</code></em> slaves, given a maximum
            possible read rate of 1,200 per minute and a ratio of nine
            reads per write.
          </p><p>
            This analysis yields the following conclusions:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                If <em class="replaceable"><code>N</code></em> = 0 (which means we have
                no replication), our system can handle about 1200/11 =
                109 writes per second.
              </p></li><li><p>
                If <em class="replaceable"><code>N</code></em> = 1, we get up to 184
                writes per second.
              </p></li><li><p>
                If <em class="replaceable"><code>N</code></em> = 8, we get up to 400
                writes per second.
              </p></li><li><p>
                If <em class="replaceable"><code>N</code></em> = 17, we get up to 480
                writes per second.
              </p></li><li><p>
                Eventually, as <em class="replaceable"><code>N</code></em> approaches
                infinity (and our budget negative infinity), we can get
                very close to 600 writes per second, increasing system
                throughput about 5.5 times. However, with only eight
                servers, we increase it nearly four times.
              </p></li></ul></div><p>
            Note that these computations assume infinite network
            bandwidth and neglect several other factors that could be
            significant on your system. In many cases, you may not be
            able to perform a computation similar to the one just shown
            that accurately predicts what will happen on your system if
            you add <em class="replaceable"><code>N</code></em> replication slaves.
            However, answering the following questions should help you
            decide whether and by how much replication will improve the
            performance of your system:
          </p><div class="itemizedlist"><ul type="disc"><li><p>
                What is the read/write ratio on your system?
              </p></li><li><p>
                How much more write load can one server handle if you
                reduce the reads?
              </p></li><li><p>
                For how many slaves do you have bandwidth available on
                your network?
              </p></li></ul></div><p><a name="qandaitem-16-3-4-1-9"></a><span class="bold"><strong>16.3.4.9: </strong></span><span class="bold"><strong>
            How can I use replication to provide redundancy or high
            availability?
          </strong></span></p><p>
            How you implement redundancy is entirely dependent on your
            application and circumstances. High-availability solutions
            (with automatic failover) require active monitoring and
            either custom scripts or third party tools to provide the
            failover support from the original MySQL server to the
            slave.
          </p><p>
            To handle the process manually, you should be able to switch
            from a failed master to a pre-configured slave by altering
            your application to talk to the new server or by adjusting
            the DNS for the MySQL server from the failed server to the
            new server.
          </p><p>
            For more information and some example solutions, see
            <a href="replication.html#replication-solutions-switch" title="16.2.6. Switching Masters During Failover">Section 16.2.6, “Switching Masters During Failover”</a>.
          </p><p><a name="qandaitem-16-3-4-1-10"></a><span class="bold"><strong>16.3.4.10: </strong></span><span class="bold"><strong>
            How do I tell whether a master server is using
            statement-based or row-based binary logging format?
          </strong></span></p><p>
            Check the value of the
            <a href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> system
            variable:
          </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'binlog_format';</code></strong>
</pre><p>
            The value shown is one of <code class="literal">STATEMENT</code>,
            <code class="literal">ROW</code>, or <code class="literal">MIXED</code>. When
            <code class="literal">MIXED</code> mode is in use, row-based
            replication is preferred but replication switches
            automatically to statement-based format under certain
            conditions; see <a href="server-administration.html#binary-log-mixed" title="5.2.4.3. Mixed Binary Logging Format">Section 5.2.4.3, “Mixed Binary Logging Format”</a>, for
            information about when this may occur.
          </p><p><a name="qandaitem-16-3-4-1-11"></a><span class="bold"><strong>16.3.4.11: </strong></span><span class="bold"><strong>
            How do I tell a slave to use row-based replication?
          </strong></span></p><p>
            Slaves automatically know which format to use.
          </p><p><a name="qandaitem-16-3-4-1-12"></a><span class="bold"><strong>16.3.4.12: </strong></span><span class="bold"><strong>
            How do I prevent <a href="sql-syntax.html#grant" title="12.5.1.3. GRANT Syntax"><code class="literal">GRANT</code></a> and
            <a href="sql-syntax.html#revoke" title="12.5.1.5. REVOKE Syntax"><code class="literal">REVOKE</code></a> statements from
            replicating to slave machines?
          </strong></span></p><p>
            Start the server with the
            <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table=mysql.%</code></a>
            option.
          </p><p><a name="qandaitem-16-3-4-1-13"></a><span class="bold"><strong>16.3.4.13: </strong></span><span class="bold"><strong>
            Does replication work on mixed operating systems (for
            example, the master runs on Linux while slaves run on Mac OS
            X and Windows)?
          </strong></span></p><p>
            Yes.
          </p><p><a name="qandaitem-16-3-4-1-14"></a><span class="bold"><strong>16.3.4.14: </strong></span><span class="bold"><strong>
            Does replication work on mixed hardware architectures (for
            example, the master runs on a 64-bit machine while slaves
            run on 32-bit machines)?
          </strong></span></p><p>
            Yes.
          </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-problems"></a>16.3.5. Troubleshooting Replication</h3></div></div></div><p>
      If you have followed the instructions, and your replication setup
      is not working, the first thing to do is <span class="emphasis"><em>check the error
      log for messages</em></span>. Many users have lost time by not
      doing this soon enough after encountering problems.
    </p><p>
      If you cannot tell from the error log what the problem was, try
      the following techniques:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Verify that the master has binary logging enabled by issuing a
          <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a> statement.
          If logging is enabled, <code class="literal">Position</code> is
          non-zero. If binary logging is not enabled, verify that you
          are running the master with the
          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> and
          <a href="replication.html#option_mysqld_server-id"><code class="option">--server-id</code></a> options.
        </p></li><li><p>
          Verify that the slave is running. Use
          <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> to check
          whether the <code class="literal">Slave_IO_Running</code> and
          <code class="literal">Slave_SQL_Running</code> values are both
          <code class="literal">Yes</code>. If not, verify the options that were
          used when starting the slave server. For example,
          <a href="replication.html#option_mysqld_skip-slave-start"><code class="option">--skip-slave-start</code></a> prevents the
          slave threads from starting until you issue a
          <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement.
        </p></li><li><p>
          If the slave is running, check whether it established a
          connection to the master. Use <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
          PROCESSLIST</code></a>, find the I/O and SQL threads and check
          their <code class="literal">State</code> column to see what they
          display. See
          <a href="replication.html#replication-implementation-details" title="16.4.1. Replication Implementation Details">Section 16.4.1, “Replication Implementation Details”</a>. If the
          I/O thread state says <code class="literal">Connecting to master</code>,
          check the following:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              Verify the privileges for the user being used for
              replication on the master.
            </p></li><li><p>
              Check that the host name of the master is correct and that
              you are using the correct port to connect to the master.
              The port used for replication is the same as used for
              client network communication (the default is
              <code class="literal">3306</code>). For the host name, ensure that
              the name resolves to the correct IP address.
            </p></li><li><p>
              Check that networking on the master has not been disabled.
              Look for the <code class="literal">skip-networking</code> option in
              the configuration file. It should either be commented out
              or deleted entirely.
            </p></li><li><p>
              If the master has a firewall or IP filtering
              configuration, ensure that the network port being used for
              MySQL is not being filtered.
            </p></li><li><p>
              Check that you can reach the master by using
              <code class="literal">ping</code> or
              <code class="literal">traceroute</code>/<code class="literal">tracert</code>
              to reach the host.
            </p></li></ul></div></li><li><p>
          If the slave was running previously but has stopped, the
          reason usually is that some statement that succeeded on the
          master failed on the slave. This should never happen if you
          have taken a proper snapshot of the master, and never modified
          the data on the slave outside of the slave thread. If the
          slave stops unexpectedly, it is a bug or you have encountered
          one of the known replication limitations described in
          <a href="replication.html#replication-features" title="16.3.1. Replication Features and Issues">Section 16.3.1, “Replication Features and Issues”</a>. If it is a bug, see
          <a href="replication.html#replication-bugs" title="16.3.6. How to Report Replication Bugs or Problems">Section 16.3.6, “How to Report Replication Bugs or Problems”</a>, for instructions on how to
          report it.
        </p></li><li><p>
          If a statement that succeeded on the master refuses to run on
          the slave, try the following procedure if it is not feasible
          to do a full database resynchronization by deleting the
          slave's databases and copying a new snapshot from the master:
        </p><div class="orderedlist"><ol type="1"><li><p>
              Determine whether the affected table on the slave is
              different from the master table. Try to understand how
              this happened. Then make the slave's table identical to
              the master's and run <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START
              SLAVE</code></a>.
            </p></li><li><p>
              If the preceding step does not work or does not apply, try
              to understand whether it would be safe to make the update
              manually (if needed) and then ignore the next statement
              from the master.
            </p></li><li><p>
              If you decide that you can skip the next statement from
              the master, issue the following statements:
            </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET GLOBAL SQL_SLAVE_SKIP_COUNTER = <em class="replaceable"><code>N</code></em>;</code></strong>
mysql&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre><p>
              The value of <em class="replaceable"><code>N</code></em> should be 1 if
              the next statement from the master does not use
              <code class="literal">AUTO_INCREMENT</code> or
              <a href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a>.
              Otherwise, the value should be 2. The reason for using a
              value of 2 for statements that use
              <code class="literal">AUTO_INCREMENT</code> or
              <a href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> is that
              they take two events in the binary log of the master.
            </p><p>
              See also
              <a href="sql-syntax.html#set-global-sql-slave-skip-counter" title="12.6.2.4. SET GLOBAL SQL_SLAVE_SKIP_COUNTER Syntax">Section 12.6.2.4, “<code class="literal">SET GLOBAL SQL_SLAVE_SKIP_COUNTER</code> Syntax”</a>.
            </p></li><li><p>
              If you are sure that the slave started out perfectly
              synchronized with the master, and that no one has updated
              the tables involved outside of the slave thread, then
              presumably the discrepancy is the result of a bug. If you
              are running the most recent version of MySQL, please
              report the problem. If you are running an older version,
              try upgrading to the latest production release to
              determine whether the problem persists.
            </p></li></ol></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-bugs"></a>16.3.6. How to Report Replication Bugs or Problems</h3></div></div></div><p>
      When you have determined that there is no user error involved, and
      replication still either does not work at all or is unstable, it
      is time to send us a bug report. We need to obtain as much
      information as possible from you to be able to track down the bug.
      Please spend some time and effort in preparing a good bug report.
    </p><p>
      If you have a repeatable test case that demonstrates the bug,
      please enter it into our bugs database using the instructions
      given in <a href="introduction.html#bug-reports" title="1.6. How to Report Bugs or Problems">Section 1.6, “How to Report Bugs or Problems”</a>. If you have a
      “<span class="quote">phantom</span>” problem (one that you cannot duplicate at
      will), use the following procedure:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Verify that no user error is involved. For example, if you
          update the slave outside of the slave thread, the data goes
          out of synchrony, and you can have unique key violations on
          updates. In this case, the slave thread stops and waits for
          you to clean up the tables manually to bring them into
          synchrony. <span class="emphasis"><em>This is not a replication problem. It is
          a problem of outside interference causing replication to
          fail.</em></span>
        </p></li><li><p>
          Run the slave with the
          <a href="replication.html#option_mysqld_log-slave-updates"><code class="option">--log-slave-updates</code></a> and
          <a href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> options. These
          options cause the slave to log the updates that it receives
          from the master into its own binary logs.
        </p></li><li><p>
          Save all evidence before resetting the replication state. If
          we have no information or only sketchy information, it becomes
          difficult or impossible for us to track down the problem. The
          evidence you should collect is:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              All binary logs from the master
            </p></li><li><p>
              All binary logs from the slave
            </p></li><li><p>
              The output of <a href="sql-syntax.html#show-master-status" title="12.5.6.24. SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER
              STATUS</code></a> from the master at the time you
              discovered the problem
            </p></li><li><p>
              The output of <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE
              STATUS</code></a> from the slave at the time you discovered
              the problem
            </p></li><li><p>
              Error logs from the master and the slave
            </p></li></ul></div></li><li><p>
          Use <a href="programs.html#mysqlbinlog" title="4.6.8. mysqlbinlog — Utility for Processing Binary Log Files"><span><strong class="command">mysqlbinlog</strong></span></a> to examine the binary logs.
          The following should be helpful to find the problem statement.
          <em class="replaceable"><code>log_pos</code></em> and
          <em class="replaceable"><code>log_file</code></em> are the
          <code class="literal">Master_Log_File</code> and
          <code class="literal">Read_Master_Log_Pos</code> values from
          <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqlbinlog --start-position=<em class="replaceable"><code>log_pos</code></em> <em class="replaceable"><code>log_file</code></em> | head</code></strong>
</pre></li></ol></div><p>
      After you have collected the evidence for the problem, try to
      isolate it as a separate test case first. Then enter the problem
      with as much information as possible into our bugs database using
      the instructions at <a href="introduction.html#bug-reports" title="1.6. How to Report Bugs or Problems">Section 1.6, “How to Report Bugs or Problems”</a>.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="replication-implementation"></a>16.4. Replication Implementation</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#replication-implementation-details">16.4.1. Replication Implementation Details</a></span></dt><dt><span class="section"><a href="replication.html#slave-logs">16.4.2. Replication Relay and Status Files</a></span></dt><dt><span class="section"><a href="replication.html#replication-rules">16.4.3. How Servers Evaluate Replication Rules</a></span></dt></dl></div><a class="indexterm" name="id3568032"></a><p>
    The basic mechanics of replication is based on the master server
    keeping track of all changes to your databases (updates, deletes,
    and so on) in its binary logs. The binary log serves as a written
    record of each to the database from the moment the database was
    started. The binary log contains records of all the statements which
    edit or modify either the database structure or the data that the
    structure contains. Typically <a href="sql-syntax.html#select" title="12.2.9. SELECT Syntax"><code class="literal">SELECT</code></a>
    statements are not recorded, as they do not modify the database data
    or structure.
  </p><p>
    Each slave that connects to the master receives a copy of the binary
    log, and executes the events within the binary log. This has the
    effect of repeating the original statements and changes just as they
    were made on the master. Tables are created or their structure
    modified, and data is inserted, deleted and updated according to the
    statements that were originally executed on the master.
  </p><p>
    Because each slave is independent, the replaying of the statements
    in the masters binary log can occur on each slave that is connected
    to the master. In addition, because each slave only receives a copy
    of the binary log by requesting it from the master (it pulls the
    data from the master, rather than the master pushing the data to the
    slave), the slave is able to read and update the copy of the
    database at its own pace and rate and can start and stop the
    replication process at will without affecting the master or the
    slaves ability to update to the latest database status.
  </p><p>
    For more information on the specifics of the replication
    implementation, see
    <a href="replication.html#replication-implementation-details" title="16.4.1. Replication Implementation Details">Section 16.4.1, “Replication Implementation Details”</a>.
  </p><p>
    Slaves and masters report their status in respect of the replication
    process regularly so that you can monitor the situation. For
    information on slave states, see
    <a href="optimization.html#slave-io-thread-states" title="7.5.6.5. Replication Slave I/O Thread States">Section 7.5.6.5, “Replication Slave I/O Thread States”</a>, and
    <a href="optimization.html#slave-sql-thread-states" title="7.5.6.6. Replication Slave SQL Thread States">Section 7.5.6.6, “Replication Slave SQL Thread States”</a>. For master states, see
    <a href="optimization.html#master-thread-states" title="7.5.6.4. Replication Master Thread States">Section 7.5.6.4, “Replication Master Thread States”</a>.
  </p><p>
    The master binary log is written to a local relay log on the slave
    before it is processed. The slave also records information about the
    current position with the master's binary log and the local relayed
    log. See <a href="replication.html#slave-logs" title="16.4.2. Replication Relay and Status Files">Section 16.4.2, “Replication Relay and Status Files”</a>.
  </p><p>
    Databases and tables are updated on the slave according to a set of
    rules that are applied according to the various configuration
    options and variables that control statement evaluation. For details
    on how these rules are applied, see
    <a href="replication.html#replication-rules" title="16.4.3. How Servers Evaluate Replication Rules">Section 16.4.3, “How Servers Evaluate Replication Rules”</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-implementation-details"></a>16.4.1. Replication Implementation Details</h3></div></div></div><p>
      MySQL replication capabilities are implemented using three threads
      (one on the master server and two on the slave):
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Slave I/O thread. </b>
            When a <a href="sql-syntax.html#start-slave" title="12.6.2.5. START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement
            is issued on a slave server, the slave creates an
            <em class="firstterm">I/O thread</em>, which connects to the
            master and asks it to send the updates recorded in its
            binary logs.
          </p><p>
          The slave I/O thread reads the updates that the master'
          <code class="literal">Binlog Dump</code> thread sends (see next item)
          and copies them to local files — known as
          <em class="firstterm">relay logs</em> ‐ in the slave's
          data directory.
        </p><p>
          The state of this thread is shown as
          <code class="literal">Slave_IO_running</code> in the output of
          <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> or as
          <a href="server-administration.html#statvar_Slave_running"><code class="literal">Slave_running</code></a> in the output
          of <a href="sql-syntax.html#show-status" title="12.5.6.35. SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>.
        </p></li><li><p><b>Binlog dump thread. </b>
            The master creates a thread to send the binary log contents
            to the slave. This thread can be identified in the output of
            <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> on the
            master as the <code class="literal">Binlog Dump</code> thread.
          </p><p>
          The binlog dump thread acquires a lock on the master's
          binary log for reading each event that is to be sent to the
          slave. As soon as the event has been read, the lock is
          released, even before the event is sent to the slave.
        </p></li><li><p><b>Slave SQL thread. </b>
            The slave creates this thread to read the relay logs that
            were written by the slave I/O thread. The <em class="firstterm">slave
            SQL thread</em> is also used to execute the updates
            contained in the relay logs.
          </p></li></ul></div><p class="mnmas"><b>MySQL Enterprise</b>
        For constant monitoring of the status of slaves subscribe to the
        MySQL Enterprise Monitor. For more information, see
        <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
      </p><p>
      In the preceding description, there are three threads per
      master/slave connection. A master that has multiple slaves creates
      one binlog dump thread for each currently-connected slave, and
      each slave has its own I/O and SQL threads.
    </p><p>
      The slave uses two threads so that reading updates from the master
      and executing them can be separated into two independent tasks.
      Thus, the task of reading statements is not slowed down if
      statement execution is slow. For example, if the slave server has
      not been running for a while, its I/O thread can quickly fetch all
      the binary log contents from the master when the slave starts,
      even if the SQL thread lags far behind. If the slave stops before
      the SQL thread has executed all the fetched statements, the I/O
      thread has at least fetched everything so that a safe copy of the
      statements is stored locally in the slave's relay logs, ready for
      execution the next time that the slave starts. This enables the
      master server to purge its binary logs sooner because it no longer
      needs to wait for the slave to fetch their contents.
    </p><p>
      The <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> statement
      provides information that tells you what is happening on the
      master and on the slave regarding replication. See
      <a href="optimization.html#thread-information" title="7.5.6. Examining Thread Information">Section 7.5.6, “Examining Thread Information”</a>, for descriptions of all
      replicated-related states.
    </p><p>
      The following example illustrates how the three threads show up in
      the output from <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>.
    </p><p>
      On the master server, the output from <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a> looks like this:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW PROCESSLIST\G</code></strong>
*************************** 1. row ***************************
     Id: 2
   User: root
   Host: localhost:32931
     db: NULL
Command: Binlog Dump
   Time: 94
  State: Has sent all binlog to slave; waiting for binlog to
         be updated
   Info: NULL
</pre><p>
      Here, thread 2 is a <code class="literal">Binlog Dump</code> replication
      thread for a connected slave. The <code class="literal">State</code>
      information indicates that all outstanding updates have been sent
      to the slave and that the master is waiting for more updates to
      occur. If you see no <code class="literal">Binlog Dump</code> threads on a
      master server, this means that replication is not running —
      that is, that no slaves are currently connected.
    </p><p>
      On the slave server, the output from <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a> looks like this:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW PROCESSLIST\G</code></strong>
*************************** 1. row ***************************
     Id: 10
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 11
  State: Waiting for master to send event
   Info: NULL
*************************** 2. row ***************************
     Id: 11
   User: system user
   Host:
     db: NULL
Command: Connect
   Time: 11
  State: Has read all relay log; waiting for the slave I/O
         thread to update it
   Info: NULL
</pre><p>
      This information indicates that thread 10 is the I/O thread that
      is communicating with the master server, and thread 11 is the SQL
      thread that is processing the updates stored in the relay logs. At
      the time that the <a href="sql-syntax.html#show-processlist" title="12.5.6.30. SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>
      was run, both threads were idle, waiting for further updates.
    </p><p>
      The value in the <code class="literal">Time</code> column can show how late
      the slave is compared to the master. See
      <a href="replication.html#replication-faq" title="16.3.4. Replication FAQ">Section 16.3.4, “Replication FAQ”</a>. The amount of time that the
      slave lags behind the master that is required before the master
      determines that the slave is no longer connected — as with
      any other client connection — is dependent on the values of
      <code class="option">net_write_timeout</code> and
      <code class="option">net_retry_count</code>; for more information about
      these, see <a href="server-administration.html#server-system-variables" title="5.1.3. Server System Variables">Section 5.1.3, “Server System Variables”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="slave-logs"></a>16.4.2. Replication Relay and Status Files</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="replication.html#slave-logs-relaylog">16.4.2.1. The Slave Relay Log</a></span></dt><dt><span class="section"><a href="replication.html#slave-logs-status">16.4.2.2. The Slave Status Files</a></span></dt></dl></div><p>
      During replication the MySQL server creates a number of files that
      are used to hold the relayed binary log from the master, and
      record information about the current status and location within
      the relayed log. There are three file types used in the process:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The <span class="emphasis"><em>relay log</em></span> consists of the events read
          from the binary log of the master. Events in this binary log
          are executed on the slave as part of the replication thread.
        </p></li><li><p>
          The <span class="emphasis"><em>master.info</em></span> file contains the status
          and current configuration information for the slave's
          connectivity to the master. The file holds information on the
          master host name, login credentials, and the current position
          within the master's binary log.
        </p></li><li><p>
          The <span class="emphasis"><em>relay-log.info</em></span> file holds the status
          information about the execution point within the slave's relay
          log files.
        </p></li></ul></div><p>
      The relationship between the three files and the replication
      process is as follows. The <code class="filename">master.info</code> file
      retains the point within the master binary log that has been read
      from the master. These read events are written to the relay log.
      The <code class="filename">relay-log.info</code> file records the position
      within the relay log of the statements that have been executed.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="slave-logs-relaylog"></a>16.4.2.1. The Slave Relay Log</h4></div></div></div><p>
        By default, relay log file names have the form
        <code class="filename"><em class="replaceable"><code>host_name</code></em>-relay-bin.<em class="replaceable"><code>nnnnnn</code></em></code>,
        where <em class="replaceable"><code>host_name</code></em> is the name of the
        slave server host and <em class="replaceable"><code>nnnnnn</code></em> is a
        sequence number. Successive relay log files are created using
        successive sequence numbers, beginning with
        <code class="literal">000001</code>. The slave uses an index file to track
        the relay log files currently in use. The default relay log
        index file name is
        <code class="filename"><em class="replaceable"><code>host_name</code></em>-relay-bin.index</code>.
        By default, the slave server creates relay log files in its data
        directory.
      </p><p>
        The default file names for relay logs and relay log index files
        can be overridden with, respectively, the
        <a href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log</code></a> and
        <a href="replication.html#option_mysqld_relay-log-index"><code class="option">--relay-log-index</code></a> server options
        (see <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>). For this reason,
        changing a replication slave's host name can cause
        replication to fail with the errors <span class="errortext">Failed to open
        the relay log</span> and <span class="errortext">Could not find target
        log during relay log initialization</span>. This is a known
        issue which we intend to fix in a future MySQL release (see <a href="http://bugs.mysql.com/2122" target="_top">Bug#2122</a>). If you anticipate that a slave's host name may
        change in the future (for example, if networking is set up on
        the slave such that its host name can be modified via DHCP),
        then you can use these options to prevent this problem from
        occurring. However, if you encounter this issue, one way to work
        around it is to stop the slave server, prepend the contents of
        the old relay log index file to the new one, then restart the
        slave. On a Unix system, this can be done as shown here, where
        <em class="replaceable"><code>new_host_name</code></em> is the new host name
        and <em class="replaceable"><code>old_host_name</code></em> is the old one:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cat <em class="replaceable"><code>new_host_name</code></em>-relay-bin.index &gt;&gt; <em class="replaceable"><code>old_host_name</code></em>-relay-bin.index</code></strong>

shell&gt; <strong class="userinput"><code>mv <em class="replaceable"><code>old_host_name</code></em>-relay-bin.index <em class="replaceable"><code>new_host_name</code></em>-relay-bin.index</code></strong>
</pre><p>
      </p><p>
        Relay logs have the same format as binary logs and can be read
        using <a href="programs.html#mysqlbinlog" title="4.6.8. mysqlbinlog — Utility for Processing Binary Log Files"><span><strong class="command">mysqlbinlog</strong></span></a>. The SQL thread
        automatically deletes each relay log file as soon as it has
        executed all events in the file and no longer needs it. There is
        no explicit mechanism for deleting relay logs because the SQL
        thread takes care of doing so. However,
        <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH LOGS</code></a>
        rotates relay logs, which influences when the SQL thread deletes
        them.
      </p><p>
        A slave server creates a new relay log file under the following
        conditions:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Each time the I/O thread starts.
          </p></li><li><p>
            When the logs are flushed; for example, with
            <a href="sql-syntax.html#flush" title="12.5.7.3. FLUSH Syntax"><code class="literal">FLUSH LOGS</code></a>
            or <a href="programs.html#mysqladmin" title="4.5.2. mysqladmin — Client for Administering a MySQL Server"><span><strong class="command">mysqladmin flush-logs</strong></span></a>.
          </p></li><li><p>
            When the size of the current relay log file becomes too
            large. The meaning of “<span class="quote">too large</span>” is determined
            as follows:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                If the value of
                <a href="server-administration.html#sysvar_max_relay_log_size"><code class="literal">max_relay_log_size</code></a> is
                greater than 0, that is the maximum relay log file size.
              </p></li><li><p>
                If the value of
                <a href="server-administration.html#sysvar_max_relay_log_size"><code class="literal">max_relay_log_size</code></a> is
                0, <a href="replication.html#sysvar_max_binlog_size"><code class="literal">max_binlog_size</code></a>
                determines the maximum relay log file size.
              </p></li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="slave-logs-status"></a>16.4.2.2. The Slave Status Files</h4></div></div></div><p>
        A slave replication server creates two small files in the data
        directory. These <span class="emphasis"><em>status files</em></span> are named
        <code class="filename">master.info</code> and
        <code class="filename">relay-log.info</code> by default. Their names can
        be changed by using the
        <a href="replication.html#option_mysqld_master-info-file"><code class="option">--master-info-file</code></a> and
        <a href="replication.html#option_mysqld_relay-log-info-file"><code class="option">--relay-log-info-file</code></a> options.
        See <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.
      </p><p>
        The two status files contain information like that shown in the
        output of the <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>
        statement, which is discussed in
        <a href="sql-syntax.html#replication-slave-sql" title="12.6.2. SQL Statements for Controlling Slave Servers">Section 12.6.2, “SQL Statements for Controlling Slave Servers”</a>. Because the status
        files are stored on disk, they survive a slave server's
        shutdown. The next time the slave starts up, it reads the two
        files to determine how far it has proceeded in reading binary
        logs from the master and in processing its own relay logs.
      </p><p>
        The I/O thread updates the <code class="filename">master.info</code>
        file. The following table shows the correspondence between the
        lines in the file and the columns displayed by
        <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Line</strong></span></td><td><span class="bold"><strong>Status Column</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>1</td><td> </td><td>Number of lines in the file</td></tr><tr><td>2</td><td><code class="literal">Master_Log_File</code></td><td>The name of the master binary log currently being read from the master.</td></tr><tr><td>3</td><td><code class="literal">Read_Master_Log_Pos</code></td><td>The current position within the master binary log that have been read
                from the master.</td></tr><tr><td>4</td><td><code class="literal">Master_Host</code></td><td>The host name of the master.</td></tr><tr><td>5</td><td><code class="literal">Master_User</code></td><td>The user name used to connect to the master.</td></tr><tr><td>6</td><td>Password (not shown by <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>)</td><td>The password used to connect to the master.</td></tr><tr><td>7</td><td><code class="literal">Master_Port</code></td><td>The network port used to connect to the master.</td></tr><tr><td>8</td><td><code class="literal">Connect_Retry</code></td><td>The period (in seconds) that the slave will wait before trying to
                reconnect to the master.</td></tr><tr><td>9</td><td><code class="literal">Master_SSL_Allowed</code></td><td>Indicates whether the server supports SSL connections.</td></tr><tr><td>10</td><td><code class="literal">Master_SSL_CA_File</code></td><td>The file used for the Certificate Authority (CA) certificate.</td></tr><tr><td>11</td><td><code class="literal">Master_SSL_CA_Path</code></td><td>The path to the Certificate Authority (CA) certificates.</td></tr><tr><td>12</td><td><code class="literal">Master_SSL_Cert</code></td><td>The name of the SSL certificate file.</td></tr><tr><td>13</td><td><code class="literal">Master_SSL_Cipher</code></td><td>The name of the cipher in use for the SSL connection.</td></tr><tr><td>14</td><td><code class="literal">Master_SSL_Key</code></td><td>The name of the SSL key file.</td></tr><tr><td>15</td><td><code class="literal">Master_SSL_Verify_Server_Cert</code></td><td>Whether to verify the server certificate.</td></tr><tr><td>17</td><td><code class="literal">Replicate_Ignore_Server_Ids</code></td><td>The number of server IDs to be ignored, followed by the actual server
                IDs. Added in MySQL 6.0.10.</td></tr></tbody></table></div><p>
        The SQL thread updates the <code class="filename">relay-log.info</code>
        file. The following table shows the correspondence between the
        lines in the file and the columns displayed by
        <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Line</strong></span></td><td><span class="bold"><strong>Status Column</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>1</td><td><code class="literal">Relay_Log_File</code></td><td>The name of the current relay log file.</td></tr><tr><td>2</td><td><code class="literal">Relay_Log_Pos</code></td><td>The current position within the relay log file. Events up to this
                position have been executed on the slave database.</td></tr><tr><td>3</td><td><code class="literal">Relay_Master_Log_File</code></td><td>The name of the master binary log file from which the events in the
                relay log file were read.</td></tr><tr><td>4</td><td><code class="literal">Exec_Master_Log_Pos</code></td><td>The equivalent position within the master's binary log file of events
                that have already been executed.</td></tr></tbody></table></div><p>
        The contents of the <code class="filename">relay-log.info</code> file and
        the states shown by the <code class="literal">SHOW SLAVE STATES</code>
        command may not match if the <code class="filename">relay-log.info</code>
        file has not been flushed to disk. Ideally, you should only view
        <code class="filename">relay-log.info</code> on a slave that is offline
        (i.e. <code class="literal">mysqld</code> is not running). For a running
        system, <a href="sql-syntax.html#show-slave-status" title="12.5.6.34. SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> should
        be used.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="replication-rules"></a>16.4.3. How Servers Evaluate Replication Rules</h3></div></div></div><p>
      If a master server does not write a statement to its binary log,
      the statement is not replicated. If the server does log the
      statement, the statement is sent to all slaves and each slave
      determines whether to execute it or ignore it.
    </p><p>
      On the master you can control which databases write events to the
      binary log using the <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a>
      and <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a> options to
      control binary logging. For a description of the rules that
      servers use in evaluating these options, see
      <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>. You should not use these options to
      control the databases and tables that are replicated, instead, use
      filtering on the slave to control the events that are executed on
      the slave.
    </p><p>
      On the slave side, decisions about whether to execute or ignore
      statements received from the master are made according to the
      <code class="option">--replicate-*</code> options that the slave was started
      with. (See <a href="replication.html#replication-options" title="16.1.3. Replication and Binary Logging Options and Variables">Section 16.1.3, “Replication and Binary Logging Options and Variables”</a>.) The slave
      evaluates these options using the following procedure, which first
      checks the database-level options and then the table-level
      options.
    </p><p>
      In the simplest case, when there are no
      <code class="option">--replicate-*</code> options, the procedure yields the
      result that the slave executes all statements that it receives
      from the master. Otherwise, the result depends on the particular
      options given. In general, to make it easier to determine what
      effect an option set will have, it is recommended that you avoid
      mixing “<span class="quote">do</span>” and “<span class="quote">ignore</span>” options, or
      wildcard and non-wildcard options.
    </p><p>
      <span class="bold"><strong>Stage 1. Check the database
      options.</strong></span>
    </p><p>
      At this stage, the slave checks whether there are any
      <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> or
      <a href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a> options that
      specify database-specific conditions:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <span class="emphasis"><em>No</em></span>: Permit the statement and proceed to
          the table-checking stage.
        </p></li><li><p>
          <span class="emphasis"><em>Yes</em></span>: Test the options using the same
          rules as for the <a href="replication.html#option_mysqld_binlog-do-db"><code class="option">--binlog-do-db</code></a>
          and <a href="replication.html#option_mysqld_binlog-ignore-db"><code class="option">--binlog-ignore-db</code></a> options
          to determine whether to permit or ignore the statement. What
          is the result of the test?
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              <span class="emphasis"><em>Permit</em></span>: Do not execute the statement
              immediately. Defer the decision and proceed to the
              table-checking stage.
            </p></li><li><p>
              <span class="emphasis"><em>Ignore</em></span>: Ignore the statement and
              exit.
            </p></li></ul></div></li></ul></div><p>
      This stage can permit a statement for further option-checking, or
      cause it to be ignored. However, statements that are permitted at
      this stage are not actually executed yet. Instead, they pass to
      the following stage that checks the table options.
    </p><p>
      <span class="bold"><strong>Stage 2. Check the table options.</strong></span>
    </p><p>
      First, as a preliminary condition, the slave checks whether
      statement-based replication is enabled. If so and the statement
      occurs within a stored function, execute the statement and exit.
      (If row-based replication is enabled, the slave does not know
      whether a statement occurred within a stored function on the
      master, so this condition does not apply.)
    </p><p>
      Next, the slave checks for table options and evaluates them. If
      the server reaches this point, it executes all statements if there
      are no table options. If there are “<span class="quote">do</span>” table
      options, the statement must match one of them if it is to be
      executed; otherwise, it is ignored. If there are any
      “<span class="quote">ignore</span>” options, all statements are executed except
      those that match any “<span class="quote">ignore</span>” option. The following
      steps describe how this evaluation occurs in more detail.
    </p><div class="orderedlist"><ol type="1"><li><p>
          Are there any <code class="option">--replicate-*-table</code> options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: There are no table restrictions,
              so all statements match. Execute the statement and exit.
            </p></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: There are table restrictions.
              Evaluate the tables to be updated against them. There
              might be multiple tables to update, so loop through the
              following steps for each table looking for a matching
              option. In this case, the behavior depends on whether
              statement-based replication or row-based replication is
              enabled:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>Statement-based replication</em></span>:
                  Proceed to the next step and begin evaluating the
                  table options in the order shown (first the non-wild
                  options, and then the wild options). Only tables that
                  are to be updated are compared to the options. For
                  example, if the statement is <code class="literal">INSERT INTO
                  sales SELECT * FROM prices</code>, only
                  <code class="literal">sales</code> is compared to the options).
                  If several tables are to be updated (multiple-table
                  statement), the first table that matches
                  “<span class="quote">do</span>” or “<span class="quote">ignore</span>” wins. That
                  is, the server checks the first table against the
                  options. If no decision could be made, it checks the
                  second table against the options, and so on.
                </p></li><li><p>
                  <span class="emphasis"><em>Row-based replication</em></span>: All table
                  row changes are filtered individually. For
                  multiple-table updates, each table is filtered
                  separately according to the options. Some updates may
                  be executed and some not, depending on the options and
                  the changes to be made. Row-based replication
                  correctly handles cases that would not replicate
                  correctly with statement-based replication, as in this
                  example which assumes that tables in the
                  <code class="literal">foo</code> database should be replicated:
                </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE bar;</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO foo.sometable VALUES (1);</code></strong>
</pre></li></ul></div></li></ul></div></li><li><p>
          Are there any
          <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a> options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: Proceed to the next step.
            </p></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: Does the table match any of
              them?
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>No</em></span>: Proceed to the next step.
                </p></li><li><p>
                  <span class="emphasis"><em>Yes</em></span>: Execute the statement and
                  exit.
                </p></li></ul></div></li></ul></div></li><li><p>
          Are there any
          <a href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>
          options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: Proceed to the next step.
            </p></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: Does the table match any of
              them?
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>No</em></span>: Proceed to the next step.
                </p></li><li><p>
                  <span class="emphasis"><em>Yes</em></span>: Ignore the statement and
                  exit.
                </p></li></ul></div></li></ul></div></li><li><p>
          Are there any
          <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>
          options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: Proceed to the next step.
            </p></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: Does the table match any of
              them?
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>No</em></span>: Proceed to the next step.
                </p></li><li><p>
                  <span class="emphasis"><em>Yes</em></span>: Execute the statement and
                  exit.
                </p></li></ul></div></li></ul></div></li><li><p>
          Are there any
          <a href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
          options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: Proceed to the next step.
            </p></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: Does the table match any of
              them?
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>No</em></span>: Proceed to the next step.
                </p></li><li><p>
                  <span class="emphasis"><em>Yes</em></span>: Ignore the statement and
                  exit.
                </p></li></ul></div></li></ul></div></li><li><p>
          No <code class="option">--replicate-*-table</code> option was matched. Is
          there another table to test against these options?
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <span class="emphasis"><em>No</em></span>: We have now tested all tables to
              be updated and could not match any option. Are there
              <a href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a> or
              <a href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>
              options?
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="emphasis"><em>No</em></span>: There were no
                  “<span class="quote">do</span>” table options, so no explicit
                  “<span class="quote">do</span>” match is required. Execute the
                  statement and exit.
                </p></li><li><p>
                  <span class="emphasis"><em>Yes</em></span>: There were “<span class="quote">do</span>”
                  table options, so the statement is executed only with
                  an explicit match to one of them. Ignore the statement
                  and exit.
                </p></li></ul></div></li><li><p>
              <span class="emphasis"><em>Yes</em></span>: Loop.
            </p></li></ul></div></li></ol></div><p>
      Examples:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          No <code class="option">--replicate-*</code> options at all
        </p><p>
          The slave executes all statements that it receives from the
          master.
        </p></li><li><p>
          <code class="option">--replicate-*-db</code> options, but no table
          options
        </p><p>
          The slave permits or ignores statements using the database
          options. Then it executes all statements permitted by those
          options because there are no table restrictions.
        </p></li><li><p>
          <code class="option">--replicate-*-table</code> options, but no database
          options
        </p><p>
          All statements are permitted at the database-checking stage
          because there are no database conditions. The slave executes
          or ignores statements based on the table options.
        </p></li><li><p>
          A mix of database and table options
        </p><p>
          The slave permits or ignores statements using the database
          options. Then it evaluates all statements permitted by those
          options according to the table options. In some cases, this
          process can yield what might seem a counterintuitive result.
          Consider the following set of options:
        </p><pre class="programlisting">[mysqld]
replicate-do-db    = db1
replicate-do-table = db2.mytbl2
</pre><p>
          Suppose that <code class="literal">db1</code> is the default database
          and the slave receives this statement:
        </p><pre class="programlisting">INSERT INTO mytbl1 VALUES(1,2,3);
</pre><p>
          The database is <code class="literal">db1</code>, which matches the
          <a href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> option at the
          database-checking stage. The algorithm then proceeds to the
          table-checking stage. If there were no table options, the
          statement would be executed. However, because the options
          include a “<span class="quote">do</span>” table option, the statement must
          match if it is to be executed. The statement does not match,
          so it is ignored. (The same would happen for any table in
          <code class="literal">db1</code>.)
        </p></li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mem-introduction.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="partitioning.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 15. MySQL Enterprise Monitor </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 17. Partitioning</td></tr></table></div></body></html>
