<html>
<head>
<title>Silent Installation</title>
<meta name="collection" content="reference">

<script language="JavaScript" type="text/JavaScript">
<!--
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}
//-->
</script>
<link href="../css/styles1.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF">

<table summary="layout" width="100%" border="0">
<tr>
<td width="1%">
<img src="../../../../images/javalogo52x88.gif" width="52" height="88">
</td>

<td>
<h1 align="center">Silent Installation<br>
</h1>
</td>

<td width="52">
</td>
</tr>
</table>
 
<p>This section discussess    silent installation of 
the Java Runtime Environment (JRE) on  Windows 32-bit platform. It  is  intended for: </p>
<ul>
  <li> System Administrators  deploying Java Plug-in and the 
    JRE on multiple PCs in  Intranet  without user interaction</li>
  <li>Companies having products requiring the JRE. The JRE can be silently 
    installed with their product.</li>
</ul>
<p>The Silent Installation section has the following topics:</p>
<ul>
  <li><a href="#intro">Introduction</a> </li>
  <li><a href="#running">Installation in Silent Mode</a></li>
  <li><a href="#uninstalling">Uninstallation in Silent Mode</a></li>
  <li><a href="#creating">Creating a Log File</a></li>
</ul>
<h2><a name="intro"></a>Introduction</h2>
<p>Java<font size="-2"><sup>TM</sup></font> SE Runtime Environment (JRE) installations are built using Microsoft Window Installer (MSI) 2.0  technology. MSI contains built-in support for silent or unattended installations. This document tells how to silently install the JRE using the .exe that launches the MSI installation.
<h2><a name="running"></a>Installation in Silent Mode</h2>
<p>In Java SE 6 The Windows offline installation command has  the same syntax as  the Windows Installation.  The command is as follows:

<pre> &lt;jre&gt;.exe   [/lang=&lt;language ID&gt;] /s [ADDLOCAL=jrecore[,extra][,other_US] | ALL] <br>      		[IEXPLORER=1] [MOZILLA=1] [INSTALLDIR=&lt;drive&gt;:\&lt;install_path&gt;] <br>             [REBOOT=Suppress] </pre>
<p>where 
<ul>
  <li><code>&lt;jre&gt;.exe</code> is the single executable installer for the Java 
    Runtime Environment (JRE)</li>
  <li> <code>/lang=&lt;language ID&gt;</code>, if used, sets 
    the localized language for the installer (see <a href="javascript:;" onClick="MM_openBrWindow('language.html','languageIDs','scrollbars=yes,resizable=yes,width=700,height=800')">language 
      IDs</a>)</li>
  <li> <code>ADDLOCAL</code>, if used, is either <code>jrecore[,extra][,other_US]</code> or <code>ALL</code></li>
  <li><code>IEXPLORER=1</code>, if used, indicates that the Plug-in 
    should be registered with the Internet Explorer browser</li>
  <li> <code>MOZILLA=1</code> indicates that the Plug-in should be 
    registered with Mozilla 1.1 and later and Netscape browsers </li>
  <li> <code>INSTALLDIR</code>, if 
    used, specifies the drive and path of the installation</li>
  <li> <code>REBOOT=Suppress</code>, 
    if used, indicates that if locked files are encountered the computer should 
    not be rebooted</li>
  <li>If <code>ADDLOCAL=ALL</code> is used, then all the features will be installed.</li>
  <li>If <code>ADDLOCAL=jrecore[,extra][,other_US]</code>can specify the following options: 
    <ul>
      <li><code>jrecore</code> indicates the core of the JRE is installed</li>
      <li><code>extra</code> (optional) indicates additional Fonts, Colors, and Soundbank 
        is installed</li>
      <li><code>other</code> (optional) indicates locale-specific <code>.jar</code> files will be installed.</li>
    </ul>
  </li>
  <li>If <code>ADDLOCAL</code> is not used, then only the following configuration is installed: 
    <ul>
      <li><code>jrecore</code> will be installed</li>
      <li><code>extra</code> will 
        not be installed</li>
      <li><code>other</code> will be installed only if  localization support, 
        other than English, is installed. </li>
    </ul>
  </li>
  <li>If <code>INSTALLDIR</code> is not specified, the installation will go into <code>C:\Program Files\java\jre1.6.0</code> (default location). </li>
</ul>
<table width="90%" border="1" cellpadding="5" align="center" bgcolor="#FFFFCC" cellspacing="0">
  <tr> 
    <td> 
      <p><b><font size="+1"><u>Note</u></font></b></p>
      <p>The command is case sensitive and there must be no spaces in the features 
        listed with <code>ADDLOCAL</code>.</p>
    </td>
  </tr>
</table>
<h3>Installation Configurations</h3>
<h4>Example 1 </h4>
<p>Suppose the JRE installer is <code>jre-6-rc-windows-i586.exe and </code> 
  you want to install the following configuration:

<ul>
  <li>Perform a Windows Installation</li>
  <li>Install the JRE core, additional fonts, colors, and Soundbank</li>
  <li>Register the Plug-in with Netscape 7 and Mozilla 1.3</li>
</ul>
<p>The 
  command to install the above mentioned configuration is as follows: </p>
<blockquote>
  <p><code>jre-6-rc-windows-i586.exe /s ADDLOCAL=jrecore,extra 
    MOZILLA=1</code></p>
</blockquote>
<h4>Example 2 </h4>
<p>Suppose the JRE installer is <code>jre-6-rc-windows-i586.exe and </code> you want to install the following configuration:
<ul>
  <li>Perform a  Windows Offline Installation and install  the JRE on  <code>D</code> drive at <code>java\jre</code></li>
  <li>Have all features of the JRE  installed
  </li>
  <li>Register 
    the Plug-in with Internet Explorer </li>
</ul>
<p> The command to install the above mentioned configuration is as follows: 

<blockquote>
  <p><code>jre-6-rc-windows-i586.exe /s ADDLOCAL=ALL 
    IEXPLORER=1 INSTALLDIR=D:\java\jre&quot;</code> </p>
</blockquote>
<table width="90%" border="1" align="center" cellpadding="5" cellspacing="0" bgcolor="#FFFFCC">
  <tr>
    <td><p><b><font size="+1"><u>Note</u></font></b></p>
        <p>To keep the MS-DOS window  open, until the installation of JRE is complete  use the <code>start /w</code> command as follows: </p>
        <p><code>start /w jre-6-rc-windows-i586.exe /s ADDLOCAL=jrecore,extra 
          MOZILLA=1</code></p>
    </td>
  </tr>
</table>
<h2><a name="uninstalling"></a>Uninstallation in Silent Mode</h2>
<p>This is the command line for uninstalling in silent mode for <code>Implementation-Version</code> 
  <code>n<SUB>1</SUB>.n<SUB>2</SUB>.n<SUB>3</SUB>_n<SUB>4</SUB>n<SUB>5</SUB></code>:</p>
<blockquote> 
  <p><code>msiexec.exe /qn /x {3248F0A8-6813-11D6-A77B-00B0D0n<SUB>1</SUB>n<SUB>2</SUB>n<SUB>3</SUB>n<SUB>4</SUB>n<SUB>5</SUB>0}</code></p>
</blockquote>
<table width="90%" border="1" cellpadding="5" align="center" bgcolor="#FFFFCC" cellspacing="0">
  <tr> 
    <td> <p><b><font size="+1"><u>Notes</u></font></b></p>
      <ol>
        <li>This command can be run from anywhere. </li>
        <li>The <code>msiexec.exe</code> executable is located in the
            windows system directory.</li>
        <li>The <code>REBOOT=Suppress</code> option, mentioned above under installation, 
          may also be used with the uninstall command.</li>
        <li>For more information on version formats, see <a href="version-format.html">Appendix 2:
          Sun-Supported <code>Specification-Version</code> and <code>Implementation-Version</code> 
          Formats</a>.</li>
      </ol></td>
  </tr>
</table>
<h4>Example for version 1.6.0</h4>
<blockquote>
  <p><code>msiexec.exe /qn /x {3248F0A8-6813-11D6-A77B-00B0D0160000}</code></p>
</blockquote>
<h4>Example for version 1.6.0_02</h4>
<blockquote> 
  <p><code>msiexec.exe /qn /x {3248F0A8-6813-11D6-A77B-00B0D0160020}</code></p>
</blockquote>
<h2><a name="creating"></a>Creating a Log File</h2>
<p>Log file can be used to verify if a installation or uninstallation succeeded. To create a log file describing the installation or uninstallation append <code>/L C:\&lt;path&gt;setup.log</code> to the install or uninstall 
  command and   scroll to the 
  end of the log file to verify. 

<h4>Installation Example</h4>
<p>The following is an example for installation: </p>
<blockquote> 
  <p><code>jre-6-rc-windows-i586.exe /s /L 
    C:\&lt;path&gt;setup.log</code></p>
</blockquote>
<p>The above command causes the log  to be written to the <code>setup.log</code> file. 
<h4>Uninstallation Example</h4>
<p>The following is an example for uninstalling:

<blockquote>
  <p><code>msiexec.exe /qn /x {3248F0A8-6813-11D6-A77B-00B0D0160000} /L C:\&lt;path&gt;setup.log</code></p>
</blockquote>
<hr>
</body>
</html>
