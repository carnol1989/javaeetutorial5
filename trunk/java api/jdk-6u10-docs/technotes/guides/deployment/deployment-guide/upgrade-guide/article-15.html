<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Signed applet upgraded from .cab to .jar files ...</title>
<meta name="collection" content="reference">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<LINK REL=STYLESHEET TYPE="text/css" HREF="styles/style1.css">
</head>

<body>
<style>
p, li {font-family: arial; font-size: 10pt;}
</style>
<blockquote>
  <h2>Signed Applet Upgraded From <code>.cab</code> to <code>.jar</code> 
    File Throws a Security Exception When Run in Microsoft Virtual Machine (VM)</h2>
  <h3><font ><br>
  Symptoms</font></h3>
  <blockquote>
  <p> After you upgrade a signed applet from <code>.cab</code> to <code>.jar</code> 
    files, the applet no longer works in the Microsoft VM. The applet runs without any error
    in the Sun Java<sup><font size="1">TM</font></sup> Runtime Environment (JRE<sup><font size="1">TM</font></sup>) implementation.</p>
  </blockquote>
  <h3> <font >Cause</font></h3>
  <blockquote>
  <p>Microsoft VM does not support signed <code>.jar</code> files. Microsoft VM supports unsigned <code>.jar</code>   
     files through the <code>archive</code> attribute of the <code>&lt;APPLET&gt;</code> 
     tag. However Microsoft VM treats classes and resources within the signed <code>.jar</code> files
     as untrusted.</p>
  <p> As a result, the applet is treated as untrusted by the Microsoft VM. Any 
    action which the applet performs ,that requires access outside the applet sandbox, results in a security exception.</p>
   </blockquote>
  <h3> <font >Resolution</font></h3>
  <blockquote>
  <p> The only applet signing scheme recognized by the Microsoft VM is Authenticode technology which is 
    used with the <code>.cab</code> files.</p>
  <p> Specify the upgraded <code>.jar</code> files through the <code>archive</code> attribute for the Sun JRE, and continue to specify the <code>.cab</code> files through <code>cabbase</code> for the Microsoft VM.
  For example, assume that you have the following code: </p>
  <blockquote>
    <p><code>&lt;APPLET code=&quot;MyApplet&quot; width=100 height=100&gt;<br>
      &lt;PARAM name=&quot;cabbase&quot; value=&quot;package1.cab, package2.cab&quot;&gt;<br>
      &lt;/APPLET&gt;</code></p>
  </blockquote>
  <p>Change the above code as shown in the following code:</p>
  <blockquote> 
    <p><code>&lt;APPLET code=&quot;MyApplet&quot; archive=&quot;package1.jar, 
      package2.jar&quot;<br>
      width=100 height=100&gt;<br>
      &lt;PARAM name=&quot;cabbase&quot; value=&quot;package1.cab, package2.cab&quot;&gt;<br>
      &lt;/APPLET&gt;</code></p>
  </blockquote>
  </blockquote>
  <h3> <font >Related Information</font></h3>
	<blockquote>
	  <p>None.<br>
    	  <br>
  	  </p>
	</blockquote>
</blockquote>
</body>
</html>
